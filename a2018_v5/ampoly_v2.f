      module ampoly

c***
c Modified to remove the SPECS common block used to interfacing
c with POLY. The parameters are now passed as subroutine arguments.
c
c Modified to remove the STORE common block, now declared at the
c head of the module and interfaced with a USE statement.
c
c Modified to remove the GAMMA common block, now declared at the
c head of the module and interfaced with a USE statement.
c
c Modified to remove the EQUIVALENCE statement between F0 (now f0_gam)
c and F(1).
c***

c***
c
cccc  COMMON/STORE/STR0(280),STR1(280),STR2(280),STR3(280),STR4(280),
cccc 1STR5(280),STR6(280),STR7(280),STR8(280),STR9(280),STR10(280),
cccc 2STR11(280),STR12(280)
      real*8, save :: STR0(280),STR1(280),STR2(280),STR3(280),
     . STR4(280),STR5(280),STR6(280),STR7(280),STR8(280),STR9(280),
     . STR10(280),STR11(280),STR12(280)
c
cccc  COMMON /GAMMA/ F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12
      real*8, save :: f_gam(13)
c***

      contains

c----------------------------------------------------------------
cccc  SUBROUTINE CPYCMI(NBFNS,NINMAX)
      subroutine cpycmi(NBFNS,NINMAX,ICNT,JCNT,KCNT,LCNT,ITYP,
     .       JTYP,KTYP,LTYP,IS,JS,KS,LS,IF,JF,KF,LF,M,I,J,K,L)
C     THIS SUBROUTINE IS CALLED BY THE POLYINTS PROGRAM IF ICON(1)>2
C     IT IS USED TO COPY PREVIOUSLY CALCULATED TWO-ELECTRON INTEGRALS
C     AND TO BEGIN LISTING THEM ON THE OUTPUT TAPE AFTER THE
C     ONE-ELECTRON INTEGRALS HAVE BEEN DONE.  THE NEW TWO-ELECTRON
C     INTEGRALS ARE THEN WRITTEN.  IF ICON(1)=3  THE TWO-ELECTRON
C     INTEGRALS ARE RECOPIED AND NO NEW INTEGRALS ARE CALCULATED.
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION VALINT(500),VIN(500),VJ(500),VK(500)
      INTEGER*2 NIJ(1275)
      INTEGER*2 II(500),JJ(500),KK(500),LL(500),MUU(500),IGG(500)
      INTEGER*2 IOUTA(500),IOUTB(500),IOUTC(500),IOUTD(500),IOUTE(500),
     2 IOUTF(500)
      COMMON /NAMTAP/ NITAPE,LSTNAM,NOTAPE,INTNAM,NCTAPE
cccc  COMMON /SPECS/ ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
      COMMON/IOIND /  ICON(10)
      COMMON VALINT,VIN,II,JJ,KK,LL,MUU,IGG,IOUTA,IOUTB,IOUTC,IOUTD,
     2 IOUTE,IOUTF
      EQUIVALENCE(VJ(1),VALINT(1)),(VK(1),VIN(1)),(NIJ(1),VALINT(1))
      EQUIVALENCE (ICON1,ICON(1)),(ICON2,ICON(2))
      IF(ICON1.LT.4) GO TO 90
      DO 10 I=1,5
10    READ(NCTAPE)
      DO 30 I=1,3
      READ(NCTAPE)
20    READ(NCTAPE) NINTS,LTEST
      IF(LTEST) 30,20,30
30    CONTINUE
      READ(NCTAPE)
      IF(ICON1.EQ.5) GO TO 500
90    IF(ICON2.LT.3) GO TO 200
100   READ(NCTAPE) LTEST,VJ,VK
      WRITE(NOTAPE)LTEST,VJ,VK
      IF(LTEST) 110,100,110
110   MXIJ=NBFNS*(NBFNS+1)/2
      READ(NCTAPE) (NIJ(I),I=1,MXIJ)
      WRITE(NOTAPE) (NIJ(I),I=1,MXIJ)
      NTOT=0
      DO 120 I=1,MXIJ
120   NTOT=NTOT+NIJ(I)
      WRITE(6,910) NTOT
910   FORMAT(9X,I7,' 2-ELECTRON INTEGRALS COPIED IN POLYPAIR FORMAT'//)
      IF(ICON2.NE.4) RETURN
200   NTOT=0
210   READ(NCTAPE) NINTS,LTEST,II,JJ,KK,LL,MUU,IGG,VALINT
      LAST=LTEST
      IF(ICON1.EQ.4) LAST=0
      WRITE(NOTAPE) NINTS,LAST,II,JJ,KK,LL,MUU,IGG,VALINT
      NTOT=NTOT+NINTS
      IF(LTEST) 220,210,220
220   WRITE(6,920) NTOT
920   FORMAT(9X,I7,' 2-ELECTRON INTEGRALS COPIED IN POLYATOM/IJLK FORMAT
     2'//)
      RETURN
500   NTOT=0
      LASTRC=0
      NLBL=NINMAX
      ILAST=0
      IREC=0
      IBACK=1
      I=NINMAX
      GO TO 515
510   ILAST=I
      IBACK=IREC
515   READ(NCTAPE,END=650) NINTS,LTEST,IOUTA,IOUTB,IOUTC,IOUTD,
     2 IOUTE,IOUTF,VALINT
      IF(NINTS.LE.0.OR.NINTS.GT.NINMAX) GO TO 710
      IF(LTEST.NE.0.AND.LTEST.NE.1) GO TO 710
      DO 550 J=1,NINTS
520   I=I+1
      IF(I.LE.NLBL) GO TO 540
      IF(LASTRC)730,530,730
530   IREC=IREC+1
      READ(NITAPE,END=730) NLBL,LASTRC,II,JJ,KK,LL,MUU,IGG
      I=1
540   IF(IOUTA(J).LE.0.OR.IOUTA(J).GT.NBFNS) GO TO 730
      IF(IOUTB(J).LE.0.OR.IOUTB(J).GT.NBFNS) GO TO 730
      IF(IOUTC(J).LE.0.OR.IOUTC(J).GT.NBFNS) GO TO 730
      IF(IOUTD(J).LE.0.OR.IOUTD(J).GT.NBFNS) GO TO 730
      IF(II(I).NE.IOUTA(J)) GO TO 520
      IF(JJ(I).NE.IOUTB(J)) GO TO 520
      IF(KK(I).NE.IOUTC(J)) GO TO 520
      IF(LL(I).NE.IOUTD(J)) GO TO 520
      IF(MUU(I).NE.IOUTE(J)) GO TO 730
      IF(IGG(I).NE.IOUTF(J)) GO TO 730
550   CONTINUE
      WRITE(NOTAPE) NINTS,LTEST,IOUTA,IOUTB,IOUTC,IOUTD,IOUTE,IOUTF,
     2 VALINT
      NTOT=NTOT+NINTS
      IF(LTEST) 560,510,560
650   WRITE(6,830)
830   FORMAT(9X,'END OF FILE ENCOUNTERED ON POLYATOM TAPE'//)
      GO TO 750
710   WRITE(6,720) NINTS,LTEST
720   FORMAT(' INVALID CONTROL INFORMATION',5X,'NINTS =',I5,5X,'LTEST ='
     2,I5//)
      GO TO 750
730   K=NTOT+J
      WRITE(6,740) K,IOUTA(J),IOUTB(J),IOUTC(J),IOUTD(J),IOUTE(J),
     2 IOUTF(J),VALINT(J)
740   FORMAT(9X,'NON-MATCHING LABELS INFORMATION FOR INTEGRAL',I7//9X,
     2 'I =',I5,'     J =',I5,'     K =',I5,'     L =',I5,'     MUU =',
     3 I5,'     IGG =',I5,'     VALUE =',1PD16.8//)
750   ILAST=ILAST+1
      IF(ILAST.LE.NLBL) GO TO 760
      ILAST=1
      IBACK=IBACK+1
760   WRITE(6,770) IBACK,ILAST
770   FORMAT(9X,'POSITIONING LABELS AT RECORD',I5,', LABEL',I5//)
      IBACK=IREC-IBACK+1
      IF(IBACK.LE.0) GO TO 795
      DO 790 IBK=1,IBACK
790   BACKSPACE NITAPE
795   READ(NITAPE) NLBL,LASTRC,II,JJ,KK,LL,MUU,IGG
800   WRITE(6,810) NTOT
810   FORMAT(9X,I7,' 2-ELECTRON INTEGRALS COPIED FROM PARTIAL POLYATOM T
     2APE'//)
      I=ILAST
      J=NLBL
      K=LASTRC
      RETURN
560   WRITE(6,820) NTOT
820   FORMAT(9X,I7,' 2-ELECTRON INTEGRALS COPIED FROM COMPLETE POLYATOM
     2TAPE'//)
      I=0
      RETURN
ccc   END
      end subroutine cpycmi
c----------------------------------------------------------------

c----------------------------------------------------------------
      DOUBLE PRECISION FUNCTION OVLAP (L,M,A,B,T)
      IMPLICIT REAL*8(A-H,O-Z)
      LL=L+1
      MM=M+1
      GO TO (100,101,102,103,104,105),LL
  100 GO TO (110,111,112,113,200,200),MM
  101 GO TO (120,121,122,123,200,200),MM
  102 GO TO (130,131,132,133,200,200),MM
  103 GO TO (140,141,142,143,200,200),MM
  104 GO TO (150,151,152,153,200,200),MM
  105 GO TO (160,161,162,163,200,200),MM
  200 WRITE (6,201) L,M,A,B,T
  201 FORMAT (//2I5,3F17.7,15H ERROR IN OVLAP  )
      STOP
C......00
  110 OVLAP=1.D0
      GO TO 300
C......01
  111 OVLAP=B
      GO TO 300
C......02
  112 OVLAP=B*B+0.5D0*T
      GO TO 300
C.....03
  113 OVLAP=B*(B*B+1.5D0*T)
      GO TO 300
C......10
  120 OVLAP=A
      GO TO 300
C......11
  121 OVLAP=A*B+0.5D0*T
      GO TO 300
C......12
  122 OVLAP=A*B*B+T*(B+0.5D0*A)
      GO TO 300
C.....13
  123 OVLAP=B*(B*(B*A+1.5D0*T)+1.5D0*A*T)+0.75D0*T*T
      GO TO 300
C......20
  130 OVLAP=A*A+0.5D0*T
      GO TO 300
C......21
  131 OVLAP=A*A*B+T*(A+0.5D0*B)
      GO TO 300
C......22
  132 OVLAP=A*A*B*B+T*(0.5D0*(A*A+B*B)+2.D0*A*B+0.75D0*T)
      GO TO 300
C.....23
  133 AA=A*A
      TT=T*T
      OVLAP=B*(B*(B*(AA+0.5D0*T)+3.D0*A*T)+1.5D0*AA*T+2.25D0*TT)+1.5D0*A
     X*TT
      GO TO 300
C......30
  140 OVLAP=A*(A*A+1.5D0*T)
      GO TO 300
C......31
  141 OVLAP=A*(A*(A*B+1.5D0*T)+1.5D0*B*T)+0.75D0*T*T
      GO TO 300
C......32
  142 BB=B*B
      TT=T*T
      OVLAP=A*(A*(A*(BB+0.5D0*T)+3.D0*B*T)+1.5D0*BB*T+2.25D0*TT)+1.5D0*B
     X*TT
      GO TO 300
C.....33
  143 AB=A*B
      ABAB=A*A+3.D0*AB+B*B
      OVLAP=AB*(AB*AB+1.5D0*T*ABAB)+T*T*(2.25D0*ABAB+1.875D0*T)
      GO TO 300
C......40
  150 OVLAP=A*A*(A*A+3.D0*T)+0.75D0*T*T
      GO TO 300
C......41
  151 OVLAP=A*(A*(A*(A*B+2.D0*T)+3.D0*B*T)+3.D0*T*T)+0.75D0*B*T*T
      GO TO 300
C......42
  152 BB=B*B
      TT=T*T
      OVLAP=A*(A*(A*(A*(BB+0.5D0*T)+4.D0*B*T)+3.D0*BB*T+4.5D0*TT)+6.D0*B
     X*TT)+     TT*(0.75D0*BB+1.875D0*T)
      GO TO 300
C.....43
  153 T2=T*T
      B2=B*B
      OVLAP=A*(A*(A*(A*(B*(B2+1.5D0*T))+3.D0*T*(2.D0*B2+T))+3.D0*B*T*(B2
     X+4.5D0*T))+T2*(9.D0*B2+7.5D0*T))+B*T2*(0.75D0*B2+5.625D0*T)
      GO TO 300
C.....50
  160 A2=A*A
      OVLAP=A*(5.D0*T*(0.75D0*T+A2)+A2*A2)
      GO TO 300
C.....51
  161 T2=T*T
      OVLAP=A*(A*(A*(A*(A*B+2.5D0*T)+5.D0*B*T)+7.5D0*T2)+3.75D0*B*T2)+1.
     X875D0*T*T2
      GO TO 300
C.....52
  162 T2=T*T
      B2=B*B
      OVLAP=A*(A*(A*(A*(A*(0.5D0*T+B2)+5.D0*B*T)+5.D0*B2*T+7.5D0*T2)+
     X        15.D0*B*T2)+T2*(3.75D0*B2+9.375D0*T))+3.75D0*B*T*T2
      GO TO 300
C.....53
  163 U=T/2.D0
      U2=U*U
      A2=A*A
      A4=A2*A2
      B2=B*B
      AB=A*B
      OVLAP=AB*A4*B2+U*(3.D0*AB*A4+15.D0*A4*B2+10.D0*A2*B2*AB)+3.D0*U2*(
     X        5.D0*A4+30.D0*A2*AB+30.D0*A2*B2+5.D0*AB*B2)+15.D0*U*U2*(10
     X.D0*A2+15.D0*AB+      3.D0*B2)+105.D0*U2*U2
  300 CONTINUE
      RETURN
ccc   END
      end function ovlap
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE DAWTAB
c***
c     IMPLICIT REAL*8 (A-H,O-Z)
C     DAWSON FUNCTION GENERATION
      COMMON/DAWSON/DAW(1000)
C     ERRFUN GENERATION
C     Y0=ERR(X), Y1=EXP(-X**2),Y2=-2*X*Y1, YN+2=-2*X*YN+1-2*N*YN
      COMMON/ERRFUN/ERR(550)
      COMMON/DAWSF/        AOI(50)
      A=0.0D0
      DO 5 I=1,50
      A=A+1.0D0
    5 AOI(I)=1.0D0/A
      DAW(1) = 0.0D0
      H=0.01D0
      NX=999
      H2HM=-H*H*2.0D0
      X2HM=-H2HM
      DO 100 I=1,NX
      X2HM=X2HM+H2HM
      A0=DAW(I)
      A1=H+X2HM*A0
      A2=(H2HM*A0+X2HM*A1)*0.5D0
      A3=(H2HM*A1+X2HM*A2)*0.3333333333333D0
      A4=(H2HM*A2+X2HM*A3)*0.25D0
      A5=(H2HM*A3+X2HM*A4)*0.2D0
  100 DAW(I+1) = A0+A1+A2+A3+A4+A5
      H=0.01D0
      X=-0.01D0
      NX=549
      ERR(1) = 0.0D0
      H1O2 = H*0.5D0
      H1O3 = H*0.33333333333333D0
      H1O4 = H*0.25D0
      H1O5 = H*0.20D0
      H1O6 = H/6.0D0
      H1O7 = H/7.0D0
      DO 200 I=1,NX
      X=X+H
      X2=2.0D0*X
ccc   EX2=DEXP(-X*X)
      EX2=exp(-X*X)
      X2M=-X2
      Y0=ERR(I)
      Y1=EX2
      Y2=X2M*Y1
      Y3=X2M*Y2-2.0D0*Y1
      Y4=X2M*Y3-4.0D0*Y2
      Y5=X2M*Y4-6.0D0*Y3
  200 ERR(I+1) =                 (Y0+H*(Y1+H1O2*(Y2+H1O3*(Y3+H1O4*(Y4+
     # H1O5*Y5)))))
      RETURN
ccc   END
      end subroutine dawtab
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE GFUNCT (L,M,A,B,P,T,G,N)
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION G(7,3)
      LL=L+1
      MM=M+1
      GO TO (100,101,102,103),LL
  100 GO TO (110,111,112,113),MM
  101 GO TO (120,121,122,123),MM
  102 GO TO (130,131,132,133),MM
  103 GO TO (140,141,142,143),MM
C......00
  110 G(1,N)=1.D0
      GO TO 300
C......01
  111 G(1,N)=B
      G(2,N)=-P
      GO TO 300
C......02
  112 G(1,N)=B*B+0.5D0*T
      G(2,N)=-2.D0*B*P-0.5D0*T
      G(3,N)=P*P
      GO TO 300
C......03
  113 TEMP=A
      A=B
      B=TEMP
      GO TO 140
C......10
  120 G(1,N)=A
      G(2,N)=-P
      GO TO 300
C......11
  121 G(1,N)=A*B+0.5D0*T
      G(2,N)=-P*(A+B)-0.5D0*T
      G(3,N)=P*P
      GO TO 300
C......12
  122 G(1,N)=B*B*A+0.5D0*T*(A+2.D0*B)
      G(2,N)=-P*B*(2.D0*A+B)-0.5D0*T*((A+2.D0*B)+3.D0*P)
      G(3,N)=P*(P*(A+2.D0*B)+1.5D0*T)
      G(4,N)=-P*P*P
      GO TO 300
C......13
  123 TEMP=A
      A=B
      B=TEMP
      GO TO 141
C......20
  130 G(1,N)=A*A+0.5D0*T
      G(2,N)=-2.D0*A*P-0.5D0*T
      G(3,N)=P*P
      GO TO 300
C......21
  131 G(1,N)=A*A*B+0.5D0*T*(2.D0*A+B)
      G(2,N)=-P*A*(A+2.D0*B)-0.5D0*T*((2.D0*A+B)+3.D0*P)
      G(3,N)=P*(P*(2.D0*A+B)+1.5D0*T)
      G(4,N)=-P*P*P
      GO TO 300
C......22
  132 AA=A*A
      BB=B*B
      PP=P*P
      AB=4.D0*A*B
      G(1,N)=AA*BB+T*(0.5D0*(AA+AB+BB)+0.75D0*T)
      G(2,N)=-(2.D0*P*(AA*B+A*BB)+T*(0.5D0*(AA+AB+BB)+3.D0*(A+B)*P  +1.5
     XD0*T))
      G(3,N)=PP*((AA+AB+BB)+3.D0*T)+T*(3.D0*P*(A+B)+0.75D0*T)
      G(4,N)=-(PP*(2.D0*P*(A+B)+3.D0*T))
      G(5,N)=PP*PP
      GO TO 300
C......23
  133 TEMP=A
      A=B
      B=TEMP
      GO TO 142
C......30
  140 G(1,N)=A*(A*A+1.5D0*T)
      G(2,N)=-3.D0*(A*(A*P+0.5D0*T)+0.5D0*P*T)
      G(3,N)=3.D0*P*(A*P+0.5D0*T)
      G(4,N)=-P*P*P
      GO TO 300
C......31
  141 P2=P*P
      T2=T*T
      A2=A*A
      AB=A*B
      F0=A2*AB
      F1=A2*(A+3.D0*B)
      F2=3.D0*A*(A+B)
      F3=3.D0*A+B
      G(1,N)=F0+.5D0*T*F2+.75D0*T2
      G(2,N)=-(P*F1+.5D0*T*F2+1.5D0*P*T*F3+1.5D0*T2)
      G(3,N)=P2*F2+1.5D0*P*T*F3+3.D0*T*P2+.75D0*T2
      G(4,N)=-(P*P2*F3+3.D0*T*P2)
      GO TO 300
C......32
  142 P2=P*P
      A2=A*A
      B2=B*B
      AB=A*B
      T2=T*T
      A3=3.D0*A2+6.D0*AB+B2
      A1=A2+6.D0*AB+3.D0*B2
      G(1,N)=A*A2*B2+0.5D0*T*A1*A+0.75D0*T2*(3.D0*A+2.D0*B)
      G(2,N)=-(AB*P*(2.D0*A2+3.D0*AB)+0.5D0*T*A*A1+1.5D0*T*A3*P+1.5D0*T2
     X*(3.D0*A+2.D0*B)+3.75D0*P*T2)
      G(3,N)=P2*A*A1+1.5D0*P*T*A3+3.D0*(3.D0*A+2.D0*B)*(T*P2+.25D0*T2)+7
     X.5D0*P*T2
      G(4,N)=-(P2*(P*A3+T*( 9.D0*A+ 6.D0*B)+5.D0*P*T)+3.75D0*P*T2)
      G(5,N)=P*P2*(P*(3.D0*A+2.D0*B)+5.D0*T)
      G(6,N)=-P*P2*P2
      GO TO 300
C......33
  143 P2=P*P
      A2=A*A
      B2=B*B
      T2=T*T
      AB=A*B
      F0=A2*B2*AB
      F1=3.D0*A2*B2*(A+B)
      F2=3.D0*AB*(A2+3.D0*AB+B2)
      F3=A2*(A+9.D0*B)+B2*(B+9.D0*A)
      F4=3.D0*(A2+3.D0*AB+B2)
      F5=3.D0*(A+B)
      G(1,N)=F0+.5D0*T*F2+.75D0*T2*F4+1.875D0*T*T2
      G(2,N)=-(P*F1+.5D0*T*F2+1.5D0*T*P*F3+1.5D0*T2*F4+3.75D0*P*T2*F5+5.
     X625D0*T*  T2)
      G(3,N)=P2*F2+1.5D0*P*T*F3+3.D0*F4*(T*P2+.25D0*T2)+7.5D0*P*T2*F5+11
     X.25D0*T2* (.5D0*T+P2)
      G(4,N)=-(P2*(P*F3+3.D0*T*F4)+5.D0*F5*P*T*(P2+.75D0*T)+T2*(22.50D0*
     XP2+1.875D0*T))
      G(5,N)=P2*(F4*P2+5.D0*P*T*F5+7.5D0*P2*T+11.25D0*T2)
      G(6,N)=-(P2*P2*(P*F5+7.5D0*T))
      G(7,N)=P2*P2*P2
  300 CONTINUE
      RETURN
ccc   END
      end subroutine gfunct
c----------------------------------------------------------------

c----------------------------------------------------------------
      DOUBLE PRECISION FUNCTION FMCH( M,X,Y)
      IMPLICIT REAL*8(A-H,O-Z)
C        THIS SUBROUTINE EVALUATES THE INTEGRAL FROM 0 TO 1 OF
C                       (U**(2*M)) * EXPF(-X*(U**2))
      IF (X-10.D0) 10,10,20
   10  A=M
       A=A+0.5D0
       TERM=1.0D0/A
       PTLSUM=TERM
       DO 11 I=2,50
       A=A+1.0D0
       TERM=TERM*X/A
       PTLSUM=PTLSUM+TERM
       IF (TERM/PTLSUM-0.00000001D0) 12, 11, 11
   11  CONTINUE
      WRITE (6,999) M,X
      STOP
   12 FMCH=0.5D0*PTLSUM*Y
      GO TO 150
   20  A=M
      B=A+0.5D0
       A=A-0.5D0
      XD=1.D0/X
      APPROX=0.88622692D0*(DSQRT(XD)*XD**M)
       IF (M) 21, 23, 21
   21  DO 22 I=1,M
       B=B-1.0D0
   22  APPROX=APPROX*B
   23 FIMULT=0.5D0*Y*XD
      PTLSUM=0.D0
      IF (FIMULT) 421,25,421
  421 CONTINUE
       FIPROP=FIMULT/APPROX
       TERM=1.0D0
       PTLSUM=TERM
       NOTRMS=X
       NOTRMS=NOTRMS+M
       DO 24 I=2,NOTRMS
       TERM=TERM*A*XD
       PTLSUM=PTLSUM+TERM
      IF (DABS(TERM*FIPROP/PTLSUM)-0.00000001D0)  25, 25, 24
   24  A=A-1.0D0
      WRITE (6,999) M,X
      STOP
   25  FMCH=APPROX-FIMULT*PTLSUM
  150 RETURN
  999  FORMAT (24H NO CONVERGENCE FOR FMCH, I6, E16.9)
ccc   END
      end function fmch
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VBCA
C
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/BFCOM/XCAB,ITYP,JTYP,ZET1,ZET2,KC,IDUM,CAA(3),CA,
     #  BAA(3)     ,BA,DAA(3)     ,DASQ,PHASE
      COMMON/INT2/NLP(200),CLP(200),ZLP(200),LSTR1(20),LSTR2(20),
     #  LSTR3(20),LSTP1(20),LSTP2(20),LSTP3(20)
     #  ,LDSR1(20),LDSR2(20),LDSP1(20),LDSP2(20),DSMX(20),DPMX(20),
     #  XMX(20),LMAX(20)
      COMMON/CNL1L2/C000,C011,C101,C110,C200,C211,C301,C310,C400,C411,
     #  XIJ,AHT,BHT,D,INTTYP,LDSTR,LDSTP
      COMMON/AAACOM/ZETA
C     DATA FOURPI/12.56637060D0/   DELETED
C     DATA SRPI4/0.4431134627265D0/  DELETED
C     DATA SRPI/1.77245385090D0/    DELETED
C
      XCAB=0.0D0
      XIJ=ZET1+ZET2
      LM=LMAX(KC)+1
      GO TO (5,6,7),LM
    5  LSTRLM=LSTR1(KC)
       LSTPLM=LSTP1(KC)
      GO TO 8
    6  LSTRLM=LSTR2(KC)
       LSTPLM=LSTP2(KC)
      GO TO 8
    7  LSTRLM=LSTR3(KC)
       LSTPLM=LSTP3(KC)
    8 CONTINUE
    3 VALUE=0.0D0
      AHT=CA*ZET1
      BHT=BA*ZET2
      X1=AHT*2.0D0
      X2=BHT*2.0D0
      D=-0.5D0*(X1*CA+X2*BA)
C
      GO TO (11,12,13,14,15,16,17,18,19,20),JTYP
      GO TO 4
   11 INTTYP=1
      GO TO 100
   12 IA=1
      GO TO 21
   13 IA=2
      GO TO 21
   14 IA=3
      GO TO 21
   15 IA=1
      JA=1
      DELIJ=0.3333333333333D0
      GO TO 27
   16 IA=2
      JA=2
      DELIJ=0.3333333333333D0
      GO TO 27
   17 IA=3
      JA=3
      DELIJ=0.3333333333333D0
      GO TO 27
   18 IA=1
      JA=2
      DELIJ=0.0D0
      GO TO 27
   19 IA=1
      JA=3
      DELIJ=0.0D0
      GO TO 27
   20 IA=2
      JA=3
      DELIJ=0.0D0
      GO TO 27
   21 GO TO (22,23,24,25),ITYP
   22 AI=BAA(IA)
      INTTYP=2
      GO TO 100
   23 JA=1
      GO TO 26
   24 JA=2
      GO TO 26
   25 JA=3
      GO TO 26
   26 AI=BAA(IA)
      AJ=CAA(JA)
      INTTYP=3
      AIJ=AI*AJ
      DELIJ=0.0D0
      IF(IA.EQ.JA) DELIJ=0.3333333333333D0
      GO TO 100
   27 GO TO (31,32,33,34,35,36,37,38,39,40),ITYP
   28 AI=BAA(IA)
      AJ=BAA(JA)
      AK=CAA(KA)
      AIJ=AI*AJ
      AIJK=AIJ*AK
      INTTYP=5
      DELIK=0.0D0
      DELJK=0.0D0
      IF(IA.EQ.KA) DELIK=0.3333333333333D0
      IF(JA.EQ.KA) DELJK=0.3333333333333D0
      C2T=(AI*DELJK+AJ*DELIK+AK*DELIJ)
      GO TO 100
   29 AI=BAA(IA)
      AJ=BAA(JA)
      AK=CAA(KA)
      AL=CAA(LA)
      INTTYP=6
      AIJ=AI*AJ
      AIK=AI*AK
      AIL=AI*AL
      AJK=AJ*AK
      AJL=AJ*AL
      AKL=AK*AL
      AIJKL=AIJ*AKL
      DELIK=0.0D0
      DELIL=0.0D0
      DELJK=0.0D0
      DELJL=0.0D0
      IF(IA.EQ.KA) DELIK=0.3333333333333D0
      IF(IA.EQ.LA) DELIL=0.3333333333333D0
      IF(JA.EQ.KA) DELJK=0.3333333333333D0
      IF(JA.EQ.LA) DELJL=0.3333333333333D0
      DELS=DELIJ*DELKL+DELIK*DELJL+DELIL*DELJK
      C2T=            AIK*DELJL+AIL*DELJK+AJK*DELIL+AJL*DELIK
      GO TO 100
   31 AI=BAA(IA)
      AJ=BAA(JA)
      AIJ=AI*AJ
      INTTYP=4
      GO TO 100
   32 KA=1
      GO TO 28
   33 KA=2
      GO TO 28
   34 KA=3
      GO TO 28
   35 KA=1
      LA=1
      DELKL=0.3333333333333D0
      GO TO 29
   36 KA=2
      LA=2
      DELKL=0.3333333333333D0
      GO TO 29
   37 KA=3
      LA=3
      DELKL=0.3333333333333D0
      GO TO 29
   38 KA=1
      LA=2
      DELKL=0.0D0
      GO TO 29
   39 KA=1
      LA=3
      DELKL=0.0D0
      GO TO 29
   40 KA=2
      LA=3
      DELKL=0.0D0
      GO TO 29
C
  100 IF (DASQ.GT.1.0D-16) GO TO 200
      GO TO (101,102,103,103,105,106),INTTYP
  101 C0=1.0D0
      GO TO 160
  102 C0=-AI
      GO TO 160
  103 C0=AIJ
      C2=DELIJ
      GO TO 170
  105 C0=-AIJK
      C2=-C2T
      GO TO 170
C
C
  160 IF(C0.EQ.0) GO TO 400
      VC0=0.0D0
      DO 163 K=LSTRLM,LSTPLM
      ZETA=XIJ+ZLP(K)
      CK=CLP(K)
      N=NLP(K)
      VC0=VC0+FA(N)*CK
  163 CONTINUE
      XCAB=PHASE*C0*VC0
      GO TO 400
C
  170 IF(C0.EQ.0.0D0.AND.C2.EQ.0.0D0) GO TO 400
      VC0=0.0D0
      VC2=0.0D0
      DO 173 K=LSTRLM,LSTPLM
      ZETA=XIJ+ZLP(K)
      CK=CLP(K)
      N=NLP(K)
      IF(C2.EQ.0.0D0) GO TO 172
      VC2=VC2+FA(N+2)*CK
  172 IF(C0.EQ.0.0D0) GO TO 173
      VC0=VC0+FA(N)*CK
  173 CONTINUE
      XCAB=PHASE*(C2*VC2+C0*VC0)
      GO TO 400
C
C
  106 C0=AIJKL
      C2  =(AIJ*DELKL+C2T                                    +AKL*DELIJ)
      C4=DELS*0.6D0
      VC0=0.0D0
      VC2=0.0D0
      VC4=0.0D0
      DO 183 K=LSTRLM,LSTPLM
      ZETA=XIJ+ZLP(K)
      CK=CLP(K)
      N=NLP(K)
      VC4=VC4+FA(N+4)*CK
      IF(C2.EQ.0.0D0) GO TO 182
      VC2=VC2+FA(N+2)*CK
  182 IF(C0.EQ.0.0D0) GO TO 183
      VC0=VC0+FA(N)*CK
  183 CONTINUE
      XCAB=PHASE*(C2*VC2+C0*VC0+C4*VC4)
      GO TO 400
C
C
  200 DA=DSQRT(DASQ)
      B=DA*XIJ
      A=B*2.0D0
      AI1=1.0D0/A
      D1=B*DA
      GO TO (210,220,230,230,240,250),INTTYP
C  SC---SB
  210 C00=1.0D0
  211 VC00=0.0D0
      DO 212 K=LSTRLM,LSTPLM
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      EXA=DEXP(-D1*(1.0D0-XIJ/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(0,N,X,VM,V)
  212 VC00 =VC00+CK*VM
      XCAB=PHASE*VC00
      GO TO 400
C  SC---PB
  220 C00=-AI
      C11=DAA(IA)/DA
  221 IF(C00.EQ.0.0D0.AND.C11.EQ.0.0D0) GO TO 400
      VC00=0.0D0
      VC11=0.0D0
      DO 222 K=LSTRLM,LSTPLM
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D1*(1.0D0-XIJ/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
      VC00=VC00+CK*VM
      IF(C11) 223,222,223
  223 CK=CK*SRZI
      VC11=VC11+CK*V
  222 CONTINUE
      XCAB=PHASE*(C00*VC00+C11*VC11)
      GO TO 400
C  PC---PB OR SC---DB
  230 DI=DAA(IA)/DA
      DJ=DAA(JA)/DA
      C20=DELIJ
      VALUE=0.0D0
      C00=AIJ
      C11=-(DI*AJ+DJ*AI)
      C22=DI*DJ-C20
      C20=C20+C22
      C11=C11-3.0D0*C22*AI1
      IF(C00.EQ.0.0D0.AND.C20.EQ.0.0D0.AND.C11.EQ.0.0D0) GO TO 400
      DO 232 K=LSTRLM,LSTPLM
      N=NLP(K)
      ZETA=XIJ+ZLP(K)
      N1=N+1
      N2=N+2
      EXA=DEXP(-D1*(1.0D0-XIJ/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
  232 VALUE=VALUE+((C00+C20*N1*0.5D0/ZETA)*VM   +(C11+C20*X*SRZI)*
     #  SRZI*V    )*CK
      XCAB=PHASE*VALUE
      GO TO 400
C  PC---DB
  240 DI=DAA(IA)/DA
      DJ=DAA(JA)/DA
      DK=DAA(KA)/DA
      C00=-AIJK
      C20=-C2T
      C31=(DK*DELIJ+DJ*DELIK+DI*DELJK)*0.6D0
      C33=DI*DJ*DK-C31
      C22=-(AJ*DI*DK+AI*DJ*DK+AK*DI*DJ +C20)
      C11=AI*AJ*DK+AK*AJ*DI+AK*AI*DJ
      C31=C31+C33
      C22=C22-5.0D0*C33*AI1
      C20=C20+C22
      C11=C11-3.0D0*C22*AI1
      VALUE=0.0D0
      DO 242 K=LSTRLM,LSTPLM
      N=NLP(K)
      ZETA=XIJ+ZLP(K)
      N1=N+1
      EXA=DEXP(-D1*(1.0D0-XIJ/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
      C31Z=C31/ZETA
      C20Z=C20*SRZI
      C11Z=(C11+C20Z*X+C31Z*(X*X+N*0.5D0))*SRZI
      C00Z=C00+(C20Z+C31Z*X)*N1*0.5D0*SRZI
  242 VALUE=VALUE+(C00Z*VM   +C11Z*V    )*CK
      XCAB=PHASE*VALUE
      GO TO 400
C  DC---DB
  250 DAI=1.0D0/DA
      DI=DAA(IA)*DAI
      DJ=DAA(JA)*DAI
      DK=DAA(KA)*DAI
      DL=DAA(LA)*DAI
      DIJ=DI*DJ
      DIK=DI*DK
      DIL=DI*DL
      DJK=DJ*DK
      DJL=DJ*DL
      DKL=DK*DL
      ADIJ=AI*DJ
      ADKL=AK*DL
      DAIJ=DI*AJ
      DAKL=DK*AL
      ADDAIJ=ADIJ+DAIJ
      ADDAKL=ADKL+DAKL
      C00=AIJKL
      C11=-(AIJ*ADDAKL+AKL*ADDAIJ)
      C20 =(AIJ*DELKL+C2T                                    +AKL*DELIJ)
      C22T=AIJ*DKL+AIK*DJL+AIL*DJK+AJK*DIL+AJL*DIK+AKL*DIJ
      C22=C22T-C20
      C31=-(DELIJ*ADDAKL+DELKL*ADDAIJ+DELIK*(AJ*DL+AL*DJ)+DELIL*(AJ*DK+
     #  AK*DJ)+DELJK*(AI*DL+AL*DI)+DELJL*(AI*DK+AK*DI))*0.6D0
      C33=-(DIJ*ADDAKL+DKL*ADDAIJ+C31)
      C40=DELS*0.6D0
      C42T=(DELIJ*DKL+DELIK*DJL+DELIL*DJK+DELJK*DIL+DELJL*DIK+DELKL*DIJ)
      C42=(C42T-DELS*2.0D0)*0.4285714285714D0
      C44=DIJ*DKL+(DELS*0.6D0-C42T)*0.4285714285714D0
      C42=C42+C44
      C33=C33-7.0D0*C44*AI1
      C40=C40+C42
      C31=C31+C33-3.0D0*C42*AI1
      C22=C22-5.0D0*C33*AI1
      C20=C20+C22
      C11=C11-3.0D0*C22*AI1
      VALUE=0.0D0
      DO 352 K=LSTRLM,LSTPLM
      N=NLP(K)
      ZETA=XIJ+ZLP(K)
      N1=N+1
      EXA=DEXP(-D1*(1.0D0-XIJ/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
      C40Z=C40*SRZI
      C31Z=(C31+C40Z*X)/ZETA
      C20Z=(C20+C40Z*SRZI*(N1+2)*0.5D0)*SRZI
      C11Z=(C11+C20Z*X+C31Z*(X*X+N*0.5D0))*SRZI
      C00Z=C00+(C20Z+C31Z*X)*N1*0.5D0*SRZI
  352 VALUE=VALUE+(C00Z*VM   +C11Z*V    )*CK
      XCAB=PHASE*VALUE
      GO TO 400
C
  400 IF(LMAX(KC).LT.1) RETURN
      IF(DSMX(KC)+D) 700,700,401
  401 CONTINUE
      LDSTR =LDSR1(KC)
      LDSTP =LDSP1(KC)
      GO TO (410,402,430,404,405,406),INTTYP
  402 C00B=-AI
      GO TO 420
  404 C00B=AIJ
      C20B=C00B/(BA*BA)
      C11B=-2.0D0*C00B/BA-3.0D0*(C20B-DELIJ)/X2
      IF(C00B.EQ.0.0D0.AND.C11B.EQ.0.0D0) GO TO 700
      GO TO 435
  405 C00B=AIJ
      C20B=C00B/(BA*BA)
      C11B=-2.0D0*C00B/BA-3.0D0*(C20B-DELIJ)/X2
      IF(C00B.EQ.0.0D0.AND.C11B.EQ.0.0D0) GO TO 700
      GO TO 440
  406 C00B=AIJ
      C20B=C00B/(BA*BA)
      C11B=-2.0D0*C00B/BA-3.0D0*(C20B-DELIJ)/X2
      IF(C00B.EQ.0.0D0.AND.C11B.EQ.0.0D0) GO TO 700
      GO TO 450
C  SC--S--SB
  410 C000=1.0D0
      GO TO 500
C  SC--S--PB
  420  C000=C00B
      IF(C00B) 423,700,423
  423 C101=-C00B/BA
      GO TO 500
C  PC--S--PB
  430 C000=AIJ
  431 IF(C000) 433,700,433
  433 C101=-C000/BA
      C110=-C000/CA
      C211=-C101/CA
      GO TO 500
C  SC--S--DB
  435 C000=C00B
      C200=C20B
      C101=C11B
      GO TO 500
C  PC--S--DB
  440 C00C=-AK
      IF(C00C.EQ.0.0D0) GO TO 700
      C000=C00C*C00B
      C101=C00C*C11B
      C200=C00C*C20B
      C110=-C000/CA
      C211=-C101/CA
      C310=-C200/CA
      GO TO 500
C  DC--S--DB
  450 C00C=AKL
      C20C=C00C/(CA*CA)
      C11C=-2.0D0*C00C/CA-3.0D0*(C20C-DELKL)/X1
      IF(C00C.EQ.0.0D0.AND.C11C.EQ.0.0D0) GO TO 700
      C000=C00C*C00B
      C200=C00C*C20B+C20C*C00B
      C301=C20C*C11B
      C310=C11C*C20B
      C101=C00C*C11B
      C110=C11C*C00B
      C400=C20C*C20B
      C211=C11C*C11B
      GO TO 500
C
  500 CALL VBCAS(XCAB)
C
  700 IF(LMAX(KC).LT.2) RETURN
      IF(DPMX(KC)+D*(CA+BA)**2) 950,950,701
  701 LDSTR =LDSR2(KC)
      LDSTP =LDSP2(KC)
      CBA=CA*BA
      CBD=(CAA(1)*BAA(1)+CAA(2)*BAA(2)+CAA(3)*BAA(3))/CBA
      GO TO (710,720,730,740,750,760),INTTYP
C
C  SC--P--SB
  710 C011=CBD
  711 IF(C011) 713,950,713
  713 VC011=0.0D0
      GO TO 800
C  SC--P--PB
  720 C011=-AI*CBD
      C110=-C011/BA
      C011=C011-3.0D0*(C110-CAA(IA)*0.3333333333333D0/CA)/X2
      IF(C011.EQ.0.0D0.AND.C110.EQ.0.0D0) GO TO 950
      GO TO 800
C  PC--P--PB
  730 C200=DELIJ*0.3333333333333D0
      BAA2=BAA(JA)*AI
      CAA2=CAA(IA)*AJ
      C101=-BAA2/(3.0D0*BA*BA)
      C110=- CAA2/(3.0D0*CA*CA)
      CC200=AIJ*CBD/CBA
      IF(C200) 729,728,729
  728 IF(C101.EQ.0.0D0.AND.C110.EQ.0.0D0.AND.CC200.EQ.0.0D0) GO TO 950
  729 CONTINUE
      D110=3.0D0*(CC200+C101)/X1
      D101=3.0D0*(CC200+C110)/X2
       C011=CBA*CC200+D110*BA+D101*CA+9.0D0*(CC200+C200+C110+C101)/(X1*
     #  X2)
       C110=-CA*CC200-D110
       C101=-BA*CC200-D101
      C200=CC200
      GO TO 800
C  SC--P--DB
  740 C011=AIJ*CBD
      C110=-(CAA(IA)*AJ+CAA(JA)*AI)/(3.0D0*CA)
      C211=-0.6D0*(C110/BA-DELIJ*CBD)
      C112=-2.0D0*C011/BA-C110
      C213=C011/(BA*BA)-C211
      C211=C211+C213
      C112=C112-5.0D0*C213/X2
      C110=C110+C112
      C011=C011-3.0D0*C112/X2
      GO TO 800
C  PC--P--DB
  750 C011=-AIJK*CBD
      C101T=BAA(KA)/(3.0D0*BA)
      C101=C101T*AIJ
      C110= AK*(CAA(JA)*AI+CAA(IA)*AJ)/(3.0D0*CA)
      C200=-0.3333333333333D0*(AI*DELJK+AJ*DELIK)
      C301=-0.6D0*(C200/BA-DELIJ*C101T)
      C121=-C011/CA-C101
      C112=-2.0D0*C011/BA-C110
      C202=-2.0D0*C101/BA-C200
      C303=C101/(BA*BA)-C301
      C211=-0.6D0*(C110/BA+DELIJ*AK*CBD)
      C213=C011/(BA*BA)-C211
      C220=-C110/CA-C200
      C321=-C211/CA-C301
      C222=-C112/CA-C202
      C323=-C213/CA-C303
      C222=C222-5.0D0*C323/X2
      C321=C321+C323
      C202=C202-5.0D0*C303/X2
      C202=C202+C222
      C112=C112-3.0D0*C222/X1
      C112=C112-5.0D0*C213/X2
      C301=C301+C303+C321
      C211=C211-3.0D0*C321/X1
      C211=C211+C213
      C200=C202+C220+C200
      C101=C101-3.0D0*C202/X2
      C101=C101+C121
      C110=C110-3.0D0*C220/X1
      C110=C110+C112
      C011=C011-3.0D0*C112/X2-3.0D0*C121/X1
      GO TO 800
C  DC--P--DB
  760 C011=AIJKL*CBD
      C110T=AI*CAA(JA)+AJ*CAA(IA)
      C110=-AKL*C110T/(3.0D0*CA)
      C101T=AK*BAA(LA)+AL*BAA(KA)
      C101=-AIJ*C101T/(3.0D0*BA)
      C112=-2.0D0*C011/BA-C110
      C121=-2.0D0*C011/CA-C101
      C211A=-0.6D0*(C110/BA-AKL*DELIJ*CBD)
      C211B=-0.6D0*(C101/CA-AIJ*DELKL*CBD)
      C211=C211A+C211B
      C213=C011/(BA*BA)-C211A
      C231=C011/(CA*CA)-C211B
      C200=C2T*0.3333333333333D0
      C220=-2.0D0*C110/CA-C200
      C202=-2.0D0*C101/BA-C200
      C310=-(3.0D0*C200+DELKL*C110T)/(5.0D0*CA)
      C301=-(3.0D0*C200+DELIJ*C101T)/(5.0D0*BA)
      C330=C110/(CA*CA)-C310
      C303=C101/(BA*BA)-C301
      C222=-2.0D0*C112/CA-C202
      C321=-2.0D0*C211A/CA-C301
      C312=-2.0D0*C211B/BA-C310
      C323=-2.0D0*C213/CA-C303
      C332=-2.0D0*C231/BA-C330
      C411=-0.6D0*(C301/CA+C310/BA)-0.36D0*(C200/CBA-DELIJ*DELKL*CBD)
      C431=C211A/(CA*CA)-C411
      C413=C211B/(BA*BA)-C411
      C433=C231/(BA*BA)-C431
      C431=C431+C433
      C332=C332-5.0D0*C433/X2
      C411=C411+C413+C431
      C312=C312-5.0D0*C413/X2
      C312=C312+C332
      C321=C321-5.0D0*C431/X1
      C222=C222-5.0D0*C332/X1
      C220=C220-5.0D0*C330/X1
      C222=C222-5.0D0*C323/X2
      C321=C321+C323
      C202=C202-5.0D0*C303/X2
      C202=C202+C222
      C112=C112-3.0D0*C222/X1
      C112=C112-5.0D0*C213/X2
      C121=C121-5.0D0*C231/X1
      C310=C310+C312+C330
      C301=C301+C303+C321
      C211=C211-3.0D0*C312/X2
      C211=C211-3.0D0*C321/X1
      C211=C211+C213+C231
      C200=C202+C220+C200
      C101=C101-3.0D0*C202/X2
      C101=C101+C121
      C110=C110-3.0D0*C220/X1
      C110=C110+C112
      C011=C011-3.0D0*C112/X2-3.0D0*C121/X1
      GO TO 800
C
  800 CALL VBCAP(XCAB)
C
  950 RETURN
    4 WRITE(6,1000) INDEX
 1000 FORMAT(1H1,' *** INDEX =',I3)
      STOP
ccc    END
       end subroutine vbca
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VVMVAL(ITYPE,N,X,VM,V)
      IMPLICIT REAL*8(A-H,O-Z)
      DATA SRPI/1.77245385090D0/
      GO TO (1,2,3,4),N
      IF(N.NE.0) GO TO 100
C
C     N=0
      CALL DAWV(DAWS,DAWS3,X)
      VM=2.0D0*DAWS*SRPI
      IF(ITYPE.EQ.0) RETURN
      IF(X.LT.0.3D0) GO TO 11
      V=       SRPI-VM/(2.0D0*X)
      RETURN
   11 V=-SRPI*DAWS3
      RETURN
C
C     N=1
    1 CALL ERRV(ERRF,ERRF3,X,EX2,Z)
      VM=2.0D0*ERRF
      IF(ITYPE.EQ.0) RETURN
      IF(X.LT.0.3D0) GO TO 21
      X2=X*X
      V   =(X-0.5D0/X)*VM   +DEXP(-X2)
      RETURN
   21 V=EX2*(Z+(Z-1.0D0)*ERRF3)
      RETURN
C
C     N=2
    2 VM   =SRPI*X
      IF(ITYPE.EQ.0) RETURN
      V   =X*VM
      RETURN
C
C     N=3
    3 CALL ERRV(ERRF,ERRF3,X,EX2,Z)
      VM1=2.0D0*ERRF
      IF(X.LT.0.3D0) GO TO 31
      X2=X*X
      V2=(X-0.5D0/X)*VM1+DEXP(-X2)
      GO TO 32
   31 V2=EX2*(Z+(Z-1.0D0)*ERRF3)
   32 CONTINUE
      VM=  X*V2+VM1
      V=(X2+0.5D0)*V2+X*VM1
      RETURN
C
C     N=4
    4 X2=X*X
      VM   =SRPI*X*(X2+1.5D0)
      IF(ITYPE.EQ.0) RETURN
      V   =SRPI*X2*(X2+2.5D0)
      RETURN
C
  100 WRITE(6,101) ITYPE,N
  101 FORMAT(1H1,' *** ITYPE =',I3,'   N =',I3,' FOR VVAL')
      STOP
ccc   END
      end subroutine vvmval
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VBCAS(XCAB)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/CNL1L2/C000,C011,C101,C110,C200,C211,C301,C310,C400,C411,
     #  XIJ,AHT,BHT,D,INTTYP,LDSTR,LDSTP
      COMMON/INT2/NLP(200),CLP(200),ZLP(200)
      COMMON/FJCOM/FJ000,FJ011,FJ101,FJ110,FJ200,FJ211,FJ310,FJ301,FJ400
     #  ,SH ,CH
      DATA SRPI8/0.22155673136325D0/
      DO 100 K=LDSTR,LDSTP
      ZET3=ZLP(K)+XIJ
      N=NLP(K)
      N1=N+1
      SRZ=DSQRT(ZET3)
      SRZI=1.0D0/SRZ
      AH=AHT*SRZI
      BH=BHT*SRZI
      Z=2.0D0*AH*BH
      AB2=AH*AH+BH*BH
      CK=CLP(K)*(SRZI**N1)*SRPI8*DEXP(D+AB2)
      IF(N.EQ.2) GO TO 40
      GO TO (11,12,13,14,15,16), INTTYP
   11 CALL FJSVAL(0,AH,BH,Z)
      XCAB=XCAB+FJ000*CK
      GO TO 100
   12 CALL FJSVAL(1,AH,BH,Z)
      XCAB=XCAB+(FJ000*C000+FJ101*C101*SRZI)*CK
      GO TO 100
   13 CALL FJSVAL(3,AH,BH,Z)
      XCAB=XCAB+CK*(FJ000*C000+SRZI*(FJ101*C101+FJ110*C110+SRZI*FJ211*
     #   C211))
      GO TO 100
   14 CALL FJSVAL(2,AH,BH,Z)
      XCAB=XCAB+CK*(FJ000*C000+SRZI*(FJ101*C101+SRZI*FJ200*C200))
      GO TO 100
   15 CALL FJSVAL(4,AH,BH,Z)
      XCAB=XCAB+CK*(FJ000*C000+SRZI*(FJ101*C101+FJ110*C110+SRZI*(
     #  FJ200*C200+FJ211*C211+SRZI*(FJ310*C310))))
      GO TO 100
   16 CALL FJSVAL(5,AH,BH,Z)
      XCAB=XCAB+CK*(FJ000*C000+SRZI*(FJ101*C101+FJ110*C110+SRZI*(
     #  FJ200*C200+FJ211*C211+SRZI*(FJ310*C310+C301*FJ301+SRZI*FJ400*
     #  C400))))
      GO TO 100
   40 IF(INTTYP.GT.1) GO TO 50
      SH=DSINH(Z)
      XCAB=XCAB+CK*SH*2.0D0/Z
      GO TO 100
   50 CK=CK*DCOSH(Z)*2.0D0
      BD=BH-0.5D0/BH
      C101Z=C101*SRZI
      IF(INTTYP.GT.2) GO TO 60
      IF(Z.LT.0.3D0) GO TO 55
      XCAB=XCAB+CK*((C000+C101Z*BD)*DTANH(Z)+C101Z*AH)/Z
      GO TO 100
   55 XCAB=XCAB+CK*((C000+C101Z*BH)+(C000+C101Z*BD)*TANH3(Z))
      GO TO 100
   60 SRZI2=SRZI*SRZI
      IF(INTTYP.NE.4) GO TO 70
      C200Z=C200*SRZI2
      IF(Z.LT.0.3D0) GO TO 65
      XCAB=XCAB+CK*((C000+C101Z*BD+C200Z*(AB2+0.5D0))*DTANH(Z)
     # +(C101Z*AH+C200Z*Z))/Z
      GO TO 100
   65 XCAB=XCAB+CK*((C000+C101Z*BD+C200Z*(AB2+0.5D0))*TANH3(Z)
     #+(C000+C101Z*BH+C200Z*(AB2+1.5D0)))
      GO TO 100
   70 AD=AH-0.5D0/AH
      X2H=AB2-0.5D0
      C110Z=C110*SRZI
      C211Z=C211*SRZI2
      IF(INTTYP.GT.4) GO TO 80
      IF(Z.LT.0.3D0) GO TO 75
      XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z          )+C101Z*BD+C110Z*AD)
     # *DTANH(Z)+(C101Z*AH+C110Z*BH+C211Z*X2H))/Z
      GO TO 100
   75 XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z          )+C101Z*BD+C110Z*AD)
     # *TANH3(Z)+(C000+C101Z*BH+C110Z*AH+C211Z*Z))
      GO TO 100
   80 SRZI3=SRZI2*SRZI
      X2PH=AB2+0.5D0
      C310Z=C310*SRZI3
      C200Z=C200*SRZI2
      IF(INTTYP.GT.5) GO TO 90
      IF(Z.LT.0.3D0) GO TO 85
      XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z)+C101Z*BD+C110Z*AD+C200Z*X2PH
     #+ C310Z*(AD*X2PH+Z*BH+AH))*DTANH(Z)+
     # (C101Z*AH+C110Z*BH+C211Z*X2H+C310Z*(BH*X2PH+Z*AH)+C200Z*Z))/Z
      GO TO 100
   85 XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z)+C101Z*BD+C110Z*AD+C200Z*X2PH
     #+ C310Z*(AD*X2PH+Z*BH+AH))*TANH3(Z)+
     # (C000+C101Z*BH+C110Z*AH+C211Z*Z+C200Z*(X2PH+1.0D0)+C310Z*((AB2+
     #  2.5D0)*AH+Z*BH)))
      GO TO 100
   90 C400Z=C400*SRZI3*SRZI
      C310Z=C310Z+AH*C400Z
      C301Z=C301*SRZI3
      C301Z=C301Z+BH*C400Z
      C200Z=C200Z+2.5D0*C400Z
      IF(Z.LT.0.3D0) GO TO 95
      XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z)+C101Z*BD+C110Z*AD+C200Z*X2PH
     #+ C310Z*(AD*X2PH+Z*BH+AH)+C301Z*(X2PH*BD+Z*AH+BH))*DTANH(Z)+
     # (C101Z*AH+C110Z*BH+C211Z*X2H+C310Z*(BH*X2PH+Z*AH)+C200Z*Z
     # +C301Z*(AH*X2PH+Z*BH)))/Z
      GO TO 100
   95 XCAB=XCAB+CK*((C000+C211Z*(Z-X2H/Z)+C101Z*BD+C110Z*AD+C200Z*X2PH
     #+ C310Z*(AD*X2PH+Z*BH+AH)+C301Z*(X2PH*BD+Z*AH+BH))*TANH3(Z)+
     # (C000+C101Z*BH+C110Z*AH+C211Z*Z+C200Z*(X2PH+1.0D0)+C310Z*((AB2+
     #  2.5D0)*AH+Z*BH)+C301Z*((AB2+2.5D0)*BH+AH*Z)))
  100 CONTINUE
      RETURN
ccc   END
      end subroutine vbcas
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VBCAP(XCAB)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/CNL1L2/C000,C011,C101,C110,C200,C211,C301,C310,C400,C411,
     #  XIJ,AHT,BHT,D,INTTYP,LDSTR,LDSTP
      COMMON/INT2/NLP(200),CLP(200),ZLP(200)
      COMMON/FJCOM/FJ000,FJ011,FJ101,FJ110,FJ200,FJ211,FJ310,FJ301,FJ400
     #  ,SH ,CH
C     SRPIQ=SRPI*0.375
      DATA SRPIQ/0.66467019408975D0/
      DO 100 K=LDSTR,LDSTP
      ZET3=ZLP(K)+XIJ
      N=NLP(K)
      N1=N+1
      SRZ=DSQRT(ZET3)
      SRZI=1.0D0/SRZ
      AH=AHT*SRZI
      BH=BHT*SRZI
      Z=2.0D0*AH*BH
      AB2=AH*AH+BH*BH
      CK=CLP(K)*(SRZI**N1)*SRPIQ*DEXP(D+AB2)
      IF(N.EQ.2) GO TO 40
      GO TO (11,12,13,14,15,16), INTTYP
   11 CALL FJPVAL(1,AH,BH,Z)
      XCAB=XCAB+CK*FJ011*C011
      GO TO 100
   12 CALL FJPVAL(2,AH,BH,Z)
      XCAB=XCAB+CK*(C011*FJ011+C110*FJ110*SRZI)
      GO TO 100
   13 CALL FJPVAL(3,AH,BH,Z)
      XCAB=XCAB+CK*( C011*FJ011+SRZI*( C110*FJ110+ C101*FJ101+SRZI*
     #  C200*FJ200))
      GO TO 100
   14 CALL FJPVAL(4,AH,BH,Z)
      XCAB=XCAB+CK*( C011*FJ011+SRZI*( C110*FJ110+ C211*FJ211*SRZI))
      GO TO 100
   15 CALL FJPVAL(5,AH,BH,Z)
      XCAB=XCAB+CK*( C011*FJ011+SRZI*( C110*FJ110+ C101*FJ101+SRZI*
     #  (FJ200*C200+FJ211*C211+SRZI*FJ301*C301)))
      GO TO 100
   16 CALL FJPVAL(6,AH,BH,Z)
      X2H=AB2-0.5D0
      IF(Z.LT.0.3D0) GO TO 17
      FJ411=((Z-X2H/Z)*DSINH(Z)+DCOSH(Z)*X2H)/(0.5D0*Z)
      GO TO 18
   17 FJ411=DCOSH(Z)*(Z+(Z-X2H/Z        )*TANH3(Z))*2.0D0
   18 CONTINUE
      XCAB=XCAB+CK*( C011*FJ011+SRZI*( C110*FJ110+ C101*FJ101+SRZI*
     #(FJ200*C200+FJ211*C211+SRZI*(FJ301*C301+FJ310*C310
     # +SRZI*C411*FJ411))))
      GO TO 100
   40 IF(C011) 41,42,41
   41 CALL FJPVAL(0,AH,BH,Z)
      IF(INTTYP.NE.1) GO TO 43
      XCAB=XCAB+FJ211*C011*CK
      GO TO 100
   42 IF(INTTYP.EQ.1) GO TO 100
      CH=DCOSH(Z)
   43 CONTINUE
      AD=AH-0.5D0/AH
      C110Z=C110*SRZI
      IF(INTTYP.GT.2) GO TO 50
      IF(Z.LT.0.3D0) GO TO 45
      XCAB=XCAB+CK*(C011*FJ211+(C110Z*(AD*DSINH(Z)+BH*CH)/(Z*0.5D0)))
      GO TO 100
   45 XCAB=XCAB+CK*(C011*FJ211+CH*C110Z*(AH+AD*TANH3(Z))*2.0D0)
      GO TO 100
   50 BD=BH-0.5D0/BH
      SRZI2=SRZI*SRZI
      C200Z=C200*SRZI2
      C101Z=C101*SRZI
      IF(INTTYP.GT.3) GO TO 60
      IF(Z.LT.0.3D0) GO TO 55
      XCAB=XCAB+CK*(((C110Z*AD+C101Z*BD+C200Z*(AB2+0.5D0))*DSINH(Z)+
     # (C110Z*BH+C101Z*AH+C200Z*Z)*CH)/(Z*0.5D0)+C011*FJ211)
      GO TO 100
   55 XCAB=XCAB+CK*(((C110Z*AD+C101Z*BD+C200Z*(AB2+0.5D0))*TANH3(Z)+
     # (C110Z*AH+C101Z*BH+C200Z*(AB2+1.5D0)))*CH*2.0D0+C011*FJ211)
      GO TO 100
   60 X2H=AB2-0.5D0
      C211Z=C211*SRZI*SRZI
      IF(INTTYP.GT.4) GO TO 70
      IF(Z.LT.0.3D0) GO TO 65
      SH=DSINH(Z)
      XCAB=XCAB+CK*( ((C110Z*AD+C211Z*(Z-X2H/Z))*SH+(C110Z*BH+C211Z*X2H)
     #  *CH)/(Z*0.5D0)+C011*FJ211)
      GO TO 100
   65 XCAB=XCAB+CK*(C011*FJ211+CH*((C110Z*AH+C211Z*Z)+(C110Z*AD+C211Z*
     # (Z-X2H/Z))*TANH3(Z))*2.0D0)
      GO TO 100
   70 X2PH=AB2+0.5D0
      SRZI3=SRZI2*SRZI
      C301Z=C301*SRZI3
      IF(INTTYP.GT.5) GO TO 80
      IF(Z.LT.0.3D0) GO TO 75
      XCAB=XCAB+CK*( ((C110Z*AD+C211Z*(Z-X2H/Z)+C101Z*BD+C200Z*X2PH
     #  +C301Z*(BD*X2PH+Z*AH+BH))*DSINH(Z)
     # +(C110Z*BH+C211Z*X2H+C101Z*AH+C200Z*Z+C301Z*(AH*X2PH+Z*BH))*CH)
     #  /(Z*0.5D0)+C011*FJ211)
      GO TO 100
   75 XCAB=XCAB+CK*(C011*FJ211+CH*((C110Z*AH+C211Z*Z+C101Z*BH+C200Z*
     # (X2PH+1.0D0)+C301Z*((AB2+2.5D0)*BH+Z*AH))
     # +(C110Z*AD+C101Z*BD+C211Z*(Z-X2H/Z)+C200Z*X2PH+C301Z*(X2PH*BD+
     #  Z*AH+BH))*TANH3(Z))*2.0D0)
      GO TO 100
   80 C310Z=C310*SRZI3
      C411Z=C411*SRZI3*SRZI
      IF(Z.LT.0.3D0) GO TO 85
      XCAB=XCAB+CK*( ((C110Z*AD+C211Z*(Z-X2H/Z)+C101Z*BD+C200Z*X2PH
     #  +C301Z*(BD*X2PH+Z*AH+BH)+C310Z*(AD*X2PH+Z*BH+AH)+C411Z*(X2PH*
     # (2.0D0*Z*Z-X2H)+Z*Z-AB2)/Z)*DSINH(Z)
     # +(C110Z*BH+C211Z*X2H+C101Z*AH+C200Z*Z+C301Z*(AH*X2PH+Z*BH)+
     # C310Z*(BH*X2PH+Z*AH)+C411Z*(X2PH*X2PH+Z*Z-0.5D0))*CH)
     #  /(Z*0.5D0)+C011*FJ211)
      GO TO 100
   85 XCAB=XCAB+CK*(C011*FJ211+CH*((C110Z*AH+C211Z*Z+C101Z*BH+C200Z*
     # (X2PH+1.0D0)+C301Z*((AB2+2.5D0)*BH+Z*AH)+C310Z*((AB2+2.5D0)*AH+
     # Z*BH)+C411Z*(X2PH+1.0D0)
     # *2.0D0*Z)+(C310Z*(X2PH*AD+Z*BH+AH)+C411Z*(X2PH*(2.0D0*Z*Z-X2H)+
     # Z*Z-AB2)/Z
     # + C110Z*AD+C101Z*BD+C211Z*(Z-X2H/Z)+C200Z*X2PH+C301Z*(X2PH*BD+
     #  Z*AH+BH))*TANH3(Z))*2.0D0)
  100 CONTINUE
      RETURN
ccc   END
      end subroutine vbcap
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE FJPVAL(ITYPE,AH,BH,ZZ)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/FJCOM/FJ000,FJ011,FJ101,FJ110,FJ200,FJ211,FJ310,FJ301,FJ400
     #  ,D1D,CH
C     DATA SRPI/1.77245385090D0/   DELETED
      IF(BH.LT.0.1D0) GO TO 101
      IF(AH.LT.0.1D0) GO TO 201
      A=2.0D0*AH
      B=2.0D0*BH
      XP=AH+BH
      XM=BH-AH
      EXZP=DEXP(ZZ)
      EXZM=1.0D0/EXZP
      CALL DAWV(DAWSP,DAWS3P,XP)
      D0P=DAWSP*EXZP
      CALL DAWV(DAWSM,DAWS3M,XM)
      D0M=DAWSM*EXZM
      D0S=D0P+D0M
      D0D=D0P-D0M
      D1D=0.5D0*(EXZP-EXZM)
      IF(ZZ.LT.0.1D0) D1D=DSINH(ZZ)
      CH=0.5D0*(EXZP+EXZM)
      XPF=XP*EXZP
      XMF=XM*EXZM
      D2P=0.5D0*(XPF-      D0P)
      D2M=0.5D0*(XMF-      D0M)
      IF(XP.LT.0.3D0) D2P=-0.5D0*EXZP*XP*DAWS3P
      IF(DABS(XM).LT.0.3D0) D2M=-0.5D0*EXZM*XM*DAWS3M
      D2S=D2P+D2M
      D2D=D2P-D2M
      XPF=XPF*XP
      XMF=XMF*XM
      D3D=0.5D0*(XPF-XMF)-      D1D
      XPF=XPF*XP
      XMF=XMF*XM
      D4P=0.5D0*(XPF-3.0D0*D2P)
      D4M=0.5D0*(XMF-3.0D0*D2M)
      D4S=D4P+D4M
      D4D=D4P-D4M
      XPF=XPF*XP
      XMF=XMF*XM
      D5D=0.5D0*(XPF-XMF)-2.0D0*D3D
      XPF=XPF*XP
      XMF=XMF*XM
      D6P=0.5D0*(XPF-5.0D0*D4P)
      D6M=0.5D0*(XMF-5.0D0*D4M)
      XPF=XPF*XP
      XMF=XMF*XM
      D7D=0.5D0*(XPF-XMF)-3.0D0*D5D
      B2=B*B
      B3=B2*B
      A2=A*A
      A3=A2*A
      A2MB2=A2-B2
      IF(ITYPE.EQ.0) GO TO 5
      DC0S=D2S+0.5D0*D0S
      DC0D=D2D+0.5D0*D0D
      DC1D=D3D+0.5D0*D1D
      DC2S=D4S+0.5D0*D2S
      DC2D=D4D+0.5D0*D2D
      DC3D=D5D+0.5D0*D3D
      DC5D=D7D+0.5D0*D5D
      FJ011=(0.6666666666666D0*(B3*(A2-0.2D0*B2)*DC0D+A3*(B2-0.2D0*A2)*
     # DC0S) + A2MB2*A2MB2*DC1D
     # +2.6666666666666D0*(-B3*DC2D-A3*DC2S+(A2+B2)*DC3D-0.4D0*DC5D)
     # )/(A2*B2)
      IF(ITYPE.EQ.1) RETURN
      F1=A*DC0S+B*DC0D
      F2=-0.3333333333333D0*(B3*DC0D+A3*DC0S)+
     # 2.666666666666D0*DC3D
      F3=2.0D0*(A2MB2)*DC1D
      FJ110=(F1+(F2-F3-4.0D0*B*DC2D)/A2)/BH
      IF(ITYPE.EQ.2) RETURN
      FJ101=(F1+(F2+F3-4.0D0*A*DC2S)/B2)/AH
      FJ200=D1D/(AH*BH)
      IF(ITYPE.EQ.3) RETURN
    5 CONTINUE
      D6S=D6P+D6M
      D6D=D6P-D6M
      XPF=XPF*XP
      XMF=XMF*XM
C     D8P=0.5D0*(XPF-7.0D0*D6P)
C     D8M=0.5D0*(XMF-7.0D0*D6M)
C     D8S=D8P+D8M
C     D8D=D8P-D8M
      XPF=XPF*XP
      XMF=XMF*XM
      D9D=0.5D0*(XPF-XMF)-4.0D0*D7D
      DK0S=D4S+3.0D0*D2S+0.75D0*D0S
      DK0D=D4D+3.0D0*D2D+0.75D0*D0D
      DK1D=D5D+3.0D0*D3D+0.75D0*D1D
      DK2S=D6S+3.0D0*D4S+0.75D0*D2S
      DK2D=D6D+3.0D0*D4D+0.75D0*D2D
      DK3D=D7D+3.0D0*D5D+0.75D0*D3D
C     DK4S=D8S+3.0D0*D6S+0.75D0*D4S
C     DK4D=D8D+3.0D0*D6D+0.75D0*D4D
      DK5D=D9D+3.0D0*D7D+0.75D0*D5D
      FJ211=(0.6666666666666D0*(B3*(A2-0.2D0*B2)*DK0D+A3*(B2-0.2D0*A2)*
     # DK0S) + A2MB2*A2MB2*DK1D
     # +2.6666666666666D0*(-B3*DK2D-A3*DK2S+(A2+B2)*DK3D-0.4D0*DK5D)
     # )/(A2*B2)
      IF(ITYPE.EQ.0.OR.ITYPE.EQ.4) RETURN
      F1=A*DK0S+B*DK0D
      F2=-0.3333333333333D0*(B3*DK0D+A3*DK0S)+
     # 2.666666666666D0*DK3D
      F3=2.0D0*(A2MB2)*DK1D
      FJ301=(F1+(F2+F3-4.0D0*A*DK2S)/B2)/AH
      IF(ITYPE.EQ.5) RETURN
      FJ310=(F1+(F2-F3-4.0D0*B*DK2D)/A2 )/BH
      RETURN
  101 Z=2.0D0*BH*BH
      X2=AH*AH
      EXPB=DEXP(-BH*BH)
      CALL DAWV(DAWS,DAWS3,AH)
      VM0=2.0D0*DAWS/AH
      IF(AH.LT.0.3D0) GO TO 110
      V1=(1.0D0-0.5D0*VM0)/X2
      GO TO 111
  110 V1=-DAWS3/X2
  111 CONTINUE
      VM2=1.0D0
      V3=1.0D0
      VM4=X2+1.5D0
      V5=X2+2.5D0
      VM6=X2*V5+2.5D0*VM4
      V7 =(X2+2.0D0)*V5 +2.5D0*VM4
      V9 =(X2+3.0D0)*V7 +3.5D0*VM6
      C00=EXPB*2.0D0
      C01=C00*BH*0.66666666666666D0
      C11=C01*AH
      Z5=0.2D0*Z
      Z14=Z/14.0D0
      Z27=Z/27.0D0
      Z44=Z/44.0D0
      IF(ITYPE.EQ.0) GO TO 105
      FJ011=C11*(V1 +Z5 *(V3 +Z14*(V5  +Z27*(V7  +Z44*V9  ))))
      IF(ITYPE.EQ.1) RETURN
      Z3=Z*0.3333333333333D0
      Z10=0.1D0*Z
      Z21=Z/21.0D0
      Z36=Z/36.0D0
      C10=C00*AH
      FJ110=C10*(V1 +Z3 *(V3 +Z10*(V5  +Z21*(V7  +Z36*V9  ))))
      IF(ITYPE.EQ.2) RETURN
      VM8=X2*V7+3.5D0*VM6
      VM10=X2*V9+4.5D0*VM8
      FJ101=C01*(VM2+Z5 *(VM4+Z14*(VM6 +Z27*(VM8 +Z44*VM10))))
      FJ200=C00*(VM2+Z3 *(VM4+Z10*(VM6 +Z21*(VM8 +Z36*VM10))))
      IF(ITYPE.EQ.3) RETURN
      GO TO 106
  105 CONTINUE
      D1D=DSINH(ZZ)
      CH=DCOSH(ZZ)
      VM8=X2*V7+3.5D0*VM6
  106 CONTINUE
      V11=(X2+4.0D0)*V9 +4.5D0*VM8
      FJ211=C11*(V3 +Z5 *(V5 +Z14*(V7  +Z27*(V9  +Z44*V11 ))))
      IF(ITYPE.EQ.0.OR.ITYPE.EQ.4) RETURN
      VM12=X2*V11+5.5D0*VM10
      FJ301=C01*(VM4+Z5 *(VM6+Z14*(VM8 +Z27*(VM10+Z44*VM12))))
      IF(ITYPE.EQ.5) RETURN
      FJ310=C10*(V3 +Z3 *(V5 +Z10*(V7  +Z21*(V9  +Z36*V11 ))))
      RETURN
  201 Z=2.0D0*AH*AH
      X2=BH*BH
      EXPB=DEXP(-AH*AH)
      CALL DAWV(DAWS,DAWS3,BH)
      VM0=2.0D0*DAWS/BH
      IF(BH.LT.0.3D0) GO TO 210
      V1=(1.0D0-0.5D0*VM0)/X2
      GO TO 211
  210 V1=-DAWS3/X2
  211 CONTINUE
      VM2=1.0D0
      V3=1.0D0
      VM4=X2+1.5D0
      V5=X2+2.5D0
      VM6=X2*V5+2.5D0*VM4
      V7 =(X2+2.0D0)*V5 +2.5D0*VM4
      V9 =(X2+3.0D0)*V7 +3.5D0*VM6
      Z5=0.2D0*Z
      Z14=Z/14.0D0
      Z27=Z/27.0D0
      Z44=Z/44.0D0
      C00=EXPB*2.0D0
      C10=C00*AH*0.66666666666666D0
      C11=C10*BH
      IF(ITYPE.EQ.0) GO TO 205
      FJ011=C11*(V1 +Z5 *(V3 +Z14*(V5  +Z27*(V7  +Z44*V9  ))))
      IF(ITYPE.EQ.1) RETURN
      VM8=X2*V7+3.5D0*VM6
      VM10=X2*V9+4.5D0*VM8
      FJ110=C10*(VM2+Z5 *(VM4+Z14*(VM6 +Z27*(VM8 +Z44*VM10))))
      IF(ITYPE.EQ.2) RETURN
      Z3=Z*0.3333333333333D0
      Z10=0.1D0*Z
      Z21=Z/21.0D0
      Z36=Z/36.0D0
      C01=C00*BH
      FJ101=C01*(V1 +Z3 *(V3 +Z10*(V5  +Z21*(V7  +Z36*V9  ))))
      FJ200=C00*(VM2+Z3 *(VM4+Z10*(VM6 +Z21*(VM8 +Z36*VM10))))
      IF(ITYPE.EQ.3) RETURN
      GO TO 206
  205 CONTINUE
      D1D=DSINH(ZZ)
      CH=DCOSH(ZZ)
      VM8=X2*V7+3.5D0*VM6
  206 CONTINUE
      V11=(X2+4.0D0)*V9 +4.5D0*VM8
      FJ211=C11*(V3 +Z5 *(V5 +Z14*(V7  +Z27*(V9  +Z44*V11 ))))
      IF(ITYPE.EQ.0.OR.ITYPE.EQ.4) RETURN
      FJ301=C01*(V3 +Z3 *(V5 +Z10*(V7  +Z21*(V9  +Z36*V11 ))))
      IF(ITYPE.EQ.5) RETURN
      VM12=X2*V11+5.5D0*VM10
      FJ310=C10*(VM4+Z5 *(VM6+Z14*(VM8 +Z27*(VM10+Z44*VM12))))
      RETURN
ccc   END
      end subroutine fjpval
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE DAWV(DAWS,DAWS3,XX)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/DAWSON/DA(1000)
      COMMON/DAWSF/ A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13,A14,A15
     #  ,A16,A17
      IF(XX) 1,30,2
    1 X=-XX
      S=-1.0D0
      GO TO 3
    2 X=XX
      S=1.0D0
    3 IF(X.LT.0.3D0) GO TO 40
      IF(X-9.995D0) 10,20,20
C     X LESS THAN 9.995
   10 A=100.0D0*X
      J=A+0.5D0
      L=J+1
      B100=J
      B=.01D0*B100
      D=X-B
      D2=D*2.0D0
      C0=DA(L)
      C1=D*(1.0D0-2.0D0*B*C0)
      C2=-D2*(B*C1+D*C0)*0.5D0
      C3=-D2*(B*C2+D*C1)*0.33333333333333D0
      C4=-D2*(B*C3+D*C2)*0.25D0
      C5=-D2*(B*C4+D*C3)*0.2D0
      DAWS=(C0+C1+C2+C3+C4+C5)*S
      RETURN
C     X GREATER THAN 9.995
   20 XI=0.5D0/X
      XI2=XI*XI
      DAWS=XI*(1.0D0+XI2*(2.0D0+XI2*(12.0D0+XI2*(120.0D0+XI2*
     #  1680.0D0))))*S
      RETURN
   30 DAWS=0.0D0
      DAWS3=0.0D0
      RETURN
   40 Z=2.0D0*X*X
      DAWS3=                  -Z*A3*(1.0D0-Z*A5*(1.0D0-Z*A7*(1.0D0-Z*A9
     # *(1.0D0-Z*A11*(1.0D0-Z*A13*(1.0D0-Z*A15*(1.0D0-Z*A17)))))))
      DAWS=XX*(1.0D0+DAWS3)
      RETURN
ccc   END
      end subroutine dawv
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE FJSVAL(ITYPE,AH,BH,ZZ)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/FJCOM/FJ000,FJ011,FJ101,FJ110,FJ200,FJ211,FJ310,FJ301,FJ400
C     DATA SRPI/1.77245385090D0/   DELETED
      IF(BH.LT.0.1D0) GO TO 101
      IF(AH.LT.0.1D0) GO TO 201
      A=2.0D0*AH
      B=2.0D0*BH
      XP=AH+BH
      XM=BH-AH
      EXZP=DEXP(ZZ)
      EXZM=1.0D0/EXZP
      CALL DAWV(DAWSP,DAWS3P,XP)
      D0P=DAWSP*EXZP
      CALL DAWV(DAWSM,DAWS3M,XM)
      D0M=DAWSM*EXZM
      D0S=D0P+D0M
      D0D=D0P-D0M
      D1D=0.5D0*(EXZP-EXZM)
      IF(ZZ.LT.0.1D0) D1D=DSINH(ZZ)
      FJ000=(B*D0D+A*D0S-2.0D0*D1D)/(AH*BH)
      IF(ITYPE.EQ.0) RETURN
      XPF=XP*EXZP
      XMF=XM*EXZM
      D2P=0.5D0*(XPF-      D0P)
      D2M=0.5D0*(XMF-      D0M)
      IF(XP.LT.0.3D0) D2P=-0.5D0*EXZP*XP*DAWS3P
      IF(DABS(XM).LT.0.3D0) D2M=-0.5D0*EXZM*XM*DAWS3M
      D2S=D2P+D2M
      D2D=D2P-D2M
      XPF=XPF*XP
      XMF=XMF*XM
      D3D=0.5D0*(XPF-XMF)-      D1D
      XPF=XPF*XP
      XMF=XMF*XM
      D4P=0.5D0*(XPF-3.0D0*D2P)
      D4M=0.5D0*(XMF-3.0D0*D2M)
      D4S=D4P+D4M
      D4D=D4P-D4M
      XPF=XPF*XP
      XMF=XMF*XM
      D5D=0.5D0*(XPF-XMF)-2.0D0*D3D
      DC0S=D2S+0.5D0*D0S
      DC0D=D2D+0.5D0*D0D
      DC1D=D3D+0.5D0*D1D
      DC2S=D4S+0.5D0*D2S
      DC2D=D4D+0.5D0*D2D
      DC3D=D5D+0.5D0*D3D
      B2=B*B
      B3=B2*B
      A2=A*A
      A3=A2*A
      A2MB2=A2-B2
      F1=A*DC0S+B*DC0D
      F2=-0.3333333333333D0*(B3*DC0D+A3*DC0S)+
     # 2.666666666666D0*DC3D
      F3=2.0D0*(A2MB2)*DC1D
      FJ101=(F1+(F2+F3-4.0D0*A*DC2S)/B2)/AH
      IF(ITYPE.EQ.1) RETURN
      FJ200=D1D/(AH*BH)
      IF(ITYPE.EQ.2) RETURN
      FJ110=(F1+(F2-F3-4.0D0*B*DC2D)/A2)/BH
      XPF=XPF*XP
      XMF=XMF*XM
      D6P=0.5D0*(XPF-5.0D0*D4P)
      D6M=0.5D0*(XMF-5.0D0*D4M)
      D6S=D6P+D6M
      D6D=D6P-D6M
      XPF=XPF*XP
      XMF=XMF*XM
      D7D=0.5D0*(XPF-XMF)-3.0D0*D5D
      XPF=XPF*XP
      XMF=XMF*XM
C     D8P=0.5D0*(XPF-7.0D0*D6P)
C     D8M=0.5D0*(XMF-7.0D0*D6M)
C     D8S=D8P+D8M
C     D8D=D8P-D8M
      XPF=XPF*XP
      XMF=XMF*XM
      D9D=0.5D0*(XPF-XMF)-4.0D0*D7D
      DK0S=D4S+3.0D0*D2S+0.75D0*D0S
      DK0D=D4D+3.0D0*D2D+0.75D0*D0D
      DK1D=D5D+3.0D0*D3D+0.75D0*D1D
      DK2S=D6S+3.0D0*D4S+0.75D0*D2S
      DK2D=D6D+3.0D0*D4D+0.75D0*D2D
      DK3D=D7D+3.0D0*D5D+0.75D0*D3D
C     DK4S=D8S+3.0D0*D6S+0.75D0*D4S
C     DK4D=D8D+3.0D0*D6D+0.75D0*D4D
      DK5D=D9D+3.0D0*D7D+0.75D0*D5D
      FJ211=(0.6666666666666D0*(B3*(A2-0.2D0*B2)*DK0D+A3*(B2-0.2D0*A2)*
     # DK0S) + A2MB2*A2MB2*DK1D
     # +2.6666666666666D0*(-B3*DK2D-A3*DK2S+(A2+B2)*DK3D-0.4D0*DK5D)
     # )/(A2*B2)
      IF(ITYPE.EQ.3) RETURN
      F1=A*DK0S+B*DK0D
      F2=-0.3333333333333D0*(B3*DK0D+A3*DK0S)+
     # 2.666666666666D0*DK3D
      F3=2.0D0*(A2MB2)*DK1D
      FJ310=(F1+(F2-F3-4.0D0*B*DK2D)/A2 )/BH
      IF(ITYPE.EQ.4) RETURN
      FJ301=(F1+(F2+F3-4.0D0*A*DK2S)/B2)/AH
      FJ400=(F1-2.0D0*DK1D)/(AH*BH)
      RETURN
  101 Z=2.0D0*BH*BH
      X2=AH*AH
      EXPB=DEXP(-BH*BH)
      CALL DAWV(DAWS,DAWS3,AH)
      VM0=2.0D0*DAWS/AH
      IF(AH.LT.0.3D0) GO TO 110
      V1=(1.0D0-0.5D0*VM0)/X2
      GO TO 111
  110 V1=-DAWS3/X2
  111 CONTINUE
      VM2=1.0D0
      V3=1.0D0
      VM4=X2+1.5D0
      V5=X2+2.5D0
      VM6=X2*V5+2.5D0*VM4
      V7 =(X2+2.0D0)*V5 +2.5D0*VM4
      VM8=X2*V7+3.5D0*VM6
      Z3=Z*0.3333333333333D0
      Z10=0.1D0*Z
      Z21=Z/21.0D0
      Z36=Z/36.0D0
      C00=EXPB*2.0D0
      FJ000=C00*(VM0+Z3 *(VM2+Z10*(VM4 +Z21*(VM6 +Z36*VM8 ))))
      IF(ITYPE.EQ.0) RETURN
      V9 =(X2+3.0D0)*V7 +3.5D0*VM6
      VM10=X2*V9+4.5D0*VM8
      Z5=0.2D0*Z
      Z14=Z/14.0D0
      Z27=Z/27.0D0
      Z44=Z/44.0D0
      C01=C00*BH*0.66666666666666D0
      FJ101=C01*(VM2+Z5 *(VM4+Z14*(VM6 +Z27*(VM8 +Z44*VM10))))
      IF(ITYPE.EQ.1) RETURN
      FJ200=C00*(VM2+Z3 *(VM4+Z10*(VM6 +Z21*(VM8 +Z36*VM10))))
      IF(ITYPE.EQ.2) RETURN
      V11=(X2+4.0D0)*V9 +4.5D0*VM8
      C10=C00*AH
      FJ110=C10*(V1 +Z3 *(V3 +Z10*(V5  +Z21*(V7  +Z36*V9  ))))
      C11=C01*AH
      FJ211=C11*(V3 +Z5 *(V5 +Z14*(V7  +Z27*(V9  +Z44*V11 ))))
      IF(ITYPE.EQ.3) RETURN
      FJ310=C10*(V3 +Z3 *(V5 +Z10*(V7  +Z21*(V9  +Z36*V11 ))))
      IF(ITYPE.EQ.4) RETURN
      VM12=X2*V11+5.5D0*VM10
      FJ301=C01*(VM4+Z5 *(VM6+Z14*(VM8 +Z27*(VM10+Z44*VM12))))
      FJ400=C00*(VM4+Z3 *(VM6+Z10*(VM8 +Z21*(VM10+Z36*VM12))))
      RETURN
  201 Z=2.0D0*AH*AH
      X2=BH*BH
      EXPB=DEXP(-AH*AH)
      CALL DAWV(DAWS,DAWS3,BH)
      VM0=2.0D0*DAWS/BH
      IF(BH.LT.0.3D0) GO TO 210
      V1=(1.0D0-0.5D0*VM0)/X2
      GO TO 211
  210 V1=-DAWS3/X2
  211 CONTINUE
      VM2=1.0D0
      V3=1.0D0
      VM4=X2+1.5D0
      V5=X2+2.5D0
      VM6=X2*V5+2.5D0*VM4
      V7 =(X2+2.0D0)*V5 +2.5D0*VM4
      VM8=X2*V7+3.5D0*VM6
      Z3=Z*0.3333333333333D0
      Z10=0.1D0*Z
      Z21=Z/21.0D0
      Z36=Z/36.0D0
      C00=EXPB*2.0D0
      FJ000=C00*(VM0+Z3 *(VM2+Z10*(VM4 +Z21*(VM6 +Z36*VM8 ))))
      IF(ITYPE.EQ.0) RETURN
      V9 =(X2+3.0D0)*V7 +3.5D0*VM6
      Z5=0.2D0*Z
      Z14=Z/14.0D0
      Z27=Z/27.0D0
      Z44=Z/44.0D0
      C01=C00*BH
      FJ101=C01*(V1 +Z3 *(V3 +Z10*(V5  +Z21*(V7  +Z36*V9  ))))
      IF(ITYPE.EQ.1) RETURN
      VM10=X2*V9+4.5D0*VM8
      FJ200=C00*(VM2+Z3 *(VM4+Z10*(VM6 +Z21*(VM8 +Z36*VM10))))
      IF(ITYPE.EQ.2) RETURN
      V11=(X2+4.0D0)*V9 +4.5D0*VM8
      C10=C00*AH*0.66666666666666D0
      FJ110=C10*(VM2+Z5 *(VM4+Z14*(VM6 +Z27*(VM8 +Z44*VM10))))
      C11=C10*BH
      FJ211=C11*(V3 +Z5 *(V5 +Z14*(V7  +Z27*(V9  +Z44*V11 ))))
      IF(ITYPE.EQ.3) RETURN
      VM12=X2*V11+5.5D0*VM10
      FJ310=C10*(VM4+Z5 *(VM6+Z14*(VM8 +Z27*(VM10+Z44*VM12))))
      IF(ITYPE.EQ.4) RETURN
      FJ301=C01*(V3 +Z3 *(V5 +Z10*(V7  +Z21*(V9  +Z36*V11 ))))
      FJ400=C00*(VM4+Z3 *(VM6+Z10*(VM8 +Z21*(VM10+Z36*VM12))))
      RETURN
C     V13=(X2+5.0D0)*V11+5.5D0*VM10
C     VM14=X2*V13+6.5D0*VM12
ccc   END
      end subroutine fjsval
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE ERRV(ERRF,ERRF3,XX,EX2,Z)
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/ERRFUN/ERR(550)
      COMMON/DAWSF/ A1,A2,A3,A4,A5,A6,A7,A8,A9,A10,A11,A12,A13,A14,A15
     #  ,A16,A17
      IF(XX) 1,40,2
    1 X=-XX
      S=-1.0D0
      GO TO 3
    2 X=XX
      S=1.0D0
    3 IF(X.LT.0.3D0) GO TO 30
      IF(X.GT.5.495D0) GO TO 20
   10 A=100.0D0*X
      J=A+0.5D0
      L=J+1
      B100=J
      B=.01D0*B100
      D=X-B
      B2=B*2.0D0
      EXB=DEXP(-B*B)
      Y0=ERR(L)
      Y1=EXB
      Y2=-B2*Y1
      Y3=-B2*Y2-2.0D0*Y1
      Y4=-B2*Y3-4.0D0*Y2
      ERRF=(Y0+D*(Y1+A2*D*(Y2+A3*D*(Y3+A4*D*Y4))))*S
      RETURN
   20 ERRF=0.886226925453D0*S
      RETURN
   30 Z=2.0D0*X*X
      EX2=DEXP(-X*X)
      ERRF3=                   Z*A3*(1.0D0+Z*A5*(1.0D0+Z*A7*(1.0D0+Z*A9
     # *(1.0D0+Z*A11*(1.0D0+Z*A13*(1.0D0+Z*A15*(1.0D0+Z*A17)))))))
      ERRF=EX2*XX*(1.0D0+ERRF3)
      RETURN
   40 ERRF=0.0D0
      Z=0.0D0
      ERRF3=0.0D0
      EX2=0.0D0
      RETURN
ccc   END
      end subroutine errv
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VBAA(BAX,BAY,BAZ,BA,ZETA1,JTYP,ZETA2,ITYP)
C
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/BFCOM/XBAA,DUM(3),KC
      COMMON/INT2/NLP(200),CLP(200),ZLP(200),LSTR1(20),LSTR2(20),
     #  LSTR3(20),LSTP1(20),LSTP2(20),LSTP3(20)
     #,LDSR1(20),LDSR2(20),LDSP1(20),LDSP2(20)
     # , DUMD(60),LMAX(20)
C     DATA FOURPI/12.56637060D0/     DELETED
C
      XBAA=0.0D0
      XIJ=ZETA1+ZETA2
      B=BA*ZETA1
      A=B*2.0D0
      AI1=1.0D0/A
      D=B*BA
C
      VALUE=0.0D0
C
      GO TO (501,502,503,504,505,506,507,508,509,510),ITYP
      GO TO 1
  501 GO TO (10,20,40,80,151,153,156,152,154,155),JTYP
      GO TO 1
  502 GO TO (21,30,50,90,171,173,176,172,174,175),JTYP
      GO TO 1
  503 GO TO (41,50,70,110,181,183,186,182,184,185),JTYP
      GO TO 1
  504 GO TO (81,90,110,150,191,193,196,192,194,195),JTYP
      GO TO 1
C
C  SB---SA
   10 LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      DO 11 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(0,N,X,VM,V)
   11 VALUE=VALUE+CK*VM
      GO TO 290
C  XB---SA
   20 C00=-BAX
      C11=BAX/BA
   22 IF(C00.EQ.0.0D0) RETURN
      LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      DO 23 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
   23 VALUE=VALUE+CK*(C00*VM   +C11*SRZI*V)
      GO TO 290
C  SB---XA
   21 C11=BAX/BA
   24 IF(C11.EQ.0.0D0) RETURN
      LSTRT2=LSTR2(KC)
      LSTOP2=LSTP2(KC)
      DO 25 K=LSTRT2,LSTOP2
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
   25 VALUE=VALUE+CK*V    *SRZI
      VALUE=C11*VALUE
      GO TO 290
C  XB---XA
   30 BIJ=BAX*BAX
      C20=0.3333333333333D0
      C00=0.0D0
   31 IF(BIJ.EQ.0.0D0.AND.C20.EQ.0.0D0)  RETURN
      C11=-BIJ/BA
      C22=-C11/BA-C20
      C20=C20+C22
      C11=C11-3.0D0*C22/A
      C00S=0.0D0
      LSTRT2=LSTR2(KC)
      LSTOP2=LSTP2(KC)
   36 DO 32 K=LSTRT2,LSTOP2
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
   32 VALUE=VALUE+((C00+C20*N1*0.5D0/ZETA)*VM   +(C11+C20*X*SRZI)*
     #  SRZI*V    )*CK
      IF(C00S.EQ.0.0D0) GO TO 290
      IF(LMAX(KC).EQ.0) GO TO 290
      LSTRT=LDSR1(KC)
      LSTOP=LDSP1(KC)
      DO 12 K=LSTRT,LSTOP
      ZETA=XIJ+ZLP(K)
      N=NLP(K) +2
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*AI1*0.1666666666666D0
      X=B*SRZI
      CALL VVMVAL(0,N,X,VM,V)
   12 VALUE=VALUE+CK*VM
      GO TO 290
C  YB---SA
   40 C00=-BAY
      C11=BAY/BA
      GO TO 22
C  SB---YA
   41 C11=BAY/BA
      GO TO 24
C  YB---XA   OR   XB---YA
   50 BIJ=BAX*BAY
      C20=0.0D0
      C00=0.0D0
      GO TO 31
C  YB---YA
   70 BIJ=BAY*BAY
      C20=0.3333333333333D0
      C00=0.0D0
      GO TO 31
C  ZB---SA
   80 C00=-BAZ
      C11=BAZ/BA
      GO TO 22
C  SB---ZA
   81 C11=BAZ/BA
      GO TO 24
C  XB---ZA   OR   ZB---XA
   90 BIJ=BAX*BAZ
      C20=0.0D0
      C00=0.0D0
      GO TO 31
C  YB---ZA   OR   ZB---YA
  110 BIJ=BAY*BAZ
      C20=0.0D0
      C00=0.0D0
      GO TO 31
C  ZB---ZA
  150 BIJ=BAZ*BAZ
      C20=0.3333333333333D0
      C00=0.0D0
      GO TO 31
C  SA---XXB
  151 C00=BAX*BAX
      C20=0.3333333333333D0
      GO TO 34
C  SA---XYB
  152 C00=BAX*BAY
      C20=0.0D0
      GO TO 34
C  SA---YYB
  153 C00=BAY*BAY
      C20=0.3333333333333D0
      GO TO 34
C  SA---XZB
  154 C00=BAX*BAZ
      C20=0.0D0
      GO TO 34
C  SA---YZB
  155 C00=BAY*BAZ
      C20=0.0D0
      GO TO 34
C  SA---ZZB
  156 C00=BAZ*BAZ
      C20=0.3333333333333D0
C
   34 C11=-2.0D0*C00/BA
      IF(C00.EQ.0.0D0.AND.C20.EQ.0.0D0)  RETURN
      C22=C00/(BA*BA)-C20
      C20=C20+C22
      C11=C11-3.0D0*C22/A
      C00S=0.0D0
      LSTRT2=LSTR1(KC)
      LSTOP2=LSTP1(KC)
      GO TO 36
C
C  XXA---SB
  161 BIJ=BAX*BAX
      C20=0.3333333333333D0
      GO TO 35
C  XYA---SB
  162 BIJ=BAX*BAY
      C20=0.0D0
      GO TO 35
C  YYA---SB
  163 BIJ=BAY*BAY
      C20=0.3333333333333D0
      GO TO 35
C  XZA---SB
  164 BIJ=BAX*BAZ
      C20=0.0D0
      GO TO 35
C  YZA---SB
  165 BIJ=BAY*BAZ
      C20=0.0D0
      GO TO 35
C  ZZA---SB
  166 BIJ=BAZ*BAZ
      C20=0.3333333333333D0
C
   35 C00=0.0D0
      IF(BIJ.EQ.0.0D0.AND.C20.EQ.0.0D0)  RETURN
      C22=BIJ/(BA*BA)-C20
      C00S=3.0D0*C20
      C20=C20+C22
      C11=-3.0D0*C22/A
      LSTRT2=LSTR3(KC)
      LSTOP2=LSTP3(KC)
      GO TO 36
C
C  XA---XXB
  171 BIJK=BAX*BAX*BAX
      C31=0.6D0*BAX/BA
      C20=-0.6666666666666D0*BAX
      GO TO 131
C  XA---XYB
  172 BIJK=BAX*BAX*BAY
      C31=0.2D0*BAY/BA
      C20=-0.3333333333333D0*BAY
      GO TO 131
C  XA---YYB
  173 BIJK=BAX*BAY*BAY
      C31=0.2D0*BAX/BA
      C20=0.0D0
      GO TO 131
C  XA---XZB
  174 BIJK=BAX*BAX*BAZ
      C31=0.2D0*BAZ/BA
      C20=-0.3333333333333D0*BAZ
      GO TO 131
C  XA---YZB
  175 BIJK=BAX*BAY*BAZ
      C31=0.0D0
      C20=0.0D0
      GO TO 131
C  XA---ZZB
  176 BIJK=BAX*BAZ*BAZ
      C31=0.2D0*BAX/BA
      C20=0.0D0
      GO TO 131
C  YA---XXB
  181 BIJK=BAY*BAX*BAX
      C31=0.2D0*BAY/BA
      C20=0.0D0
      GO TO 131
C  YA---XYB
  182 BIJK=BAY*BAX*BAY
      C31=0.2D0*BAX/BA
      C20=-0.3333333333333D0*BAX
      GO TO 131
C  YA---YYB
  183 BIJK=BAY*BAY*BAY
      C31=0.6D0*BAY/BA
      C20=-0.6666666666666D0*BAY
      GO TO 131
C  YA---XZB
  184 BIJK=BAY*BAX*BAZ
      C31=0.0D0
      C20=0.0D0
      GO TO 131
C  YA---YZB
  185 BIJK=BAY*BAY*BAZ
      C31=0.2D0*BAZ/BA
      C20=-0.3333333333333D0*BAZ
      GO TO 131
C  YA---ZZB
  186 BIJK=BAY*BAZ*BAZ
      C31=0.2D0*BAY/BA
      C20=0.0D0
      GO TO 131
C  ZA---XXB
  191 BIJK=BAZ*BAX*BAX
      C31=0.2D0*BAZ/BA
      C20=0.0D0
      GO TO 131
C  ZA---XYB
  192 BIJK=BAZ*BAX*BAY
      C31=0.0D0
      C20=0.0D0
      GO TO 131
C  ZA---YYB
  193 BIJK=BAZ*BAY*BAY
      C31=0.2D0*BAZ/BA
      C20=0.0D0
      GO TO 131
C  ZA---XZB
  194 BIJK=BAZ*BAX*BAZ
      C31=0.2D0*BAX/BA
      C20=-0.3333333333333D0*BAX
      GO TO 131
C  ZA---YZB
  195 BIJK=BAZ*BAY*BAZ
      C31=0.2D0*BAY/BA
      C20=-0.3333333333333D0*BAY
      GO TO 131
C  ZA---ZZB
  196 BIJK=BAZ*BAZ*BAZ
      C31=0.6D0*BAZ/BA
      C20=-0.6666666666666D0*BAZ
      GO TO 131
C
C  XXA---XB
  201 BIJK=BAX*BAX*BAX
      C31=0.6D0*BAX/BA
      C20=-0.3333333333333D0*BAX
      GO TO 133
C  XXA---YB
  202 BIJK=BAX*BAX*BAY
      C31=0.2D0*BAY/BA
      C20=-0.3333333333333D0*BAY
      GO TO 133
C  XXA---ZB
  203 BIJK=BAX*BAX*BAZ
      C31=0.2D0*BAZ/BA
      C20=-0.3333333333333D0*BAZ
      GO TO 133
C  XYA---XB
  204 BIJK=BAX*BAY*BAX
      C31=0.2D0*BAY/BA
      C20=0.0D0
      GO TO 133
C  XYA---YB
  205 BIJK=BAX*BAY*BAY
      C31=0.2D0*BAX/BA
      C20=0.0D0
      GO TO 133
C  XYA---ZB
  206 BIJK=BAX*BAY*BAZ
      C31=0.0D0
      C20=0.0D0
      GO TO 133
C  YYA---XB
  207 BIJK=BAY*BAY*BAX
      C31=0.2D0*BAX/BA
      C20=-0.3333333333333D0*BAX
      GO TO 133
C  YYA---YB
  208 BIJK=BAY*BAY*BAY
      C31=0.6D0*BAY/BA
      C20=-0.3333333333333D0*BAY
      GO TO 133
C  YYA---ZB
  209 BIJK=BAY*BAY*BAZ
      C31=0.2D0*BAZ/BA
      C20=-0.3333333333333D0*BAZ
      GO TO 133
C  XZA---XB
  210 BIJK=BAX*BAZ*BAX
      C31=0.2D0*BAZ/BA
      C20=0.0D0
      GO TO 133
C  XZA---YB
  211 BIJK=BAX*BAZ*BAY
      C31=0.0D0
      C20=0.0D0
      GO TO 133
C  XZA---ZB
  212 BIJK=BAX*BAZ*BAZ
      C31=0.2D0*BAX/BA
      C20=0.0D0
      GO TO 133
C  YZA---XB
  213 BIJK=BAY*BAZ*BAX
      C31=0.0D0
      C20=0.0D0
      GO TO 133
C  YZA---YB
  214 BIJK=BAY*BAZ*BAY
      C31=0.2D0*BAZ/BA
      C20=0.0D0
      GO TO 133
C  YZA---ZB
  215 BIJK=BAY*BAZ*BAZ
      C31=0.2D0*BAY/BA
      C20=0.0D0
      GO TO 133
C  ZZA---XB
  216 BIJK=BAZ*BAZ*BAX
      C31=0.2D0*BAX/BA
      C20=-0.3333333333333D0*BAX
      GO TO 133
C  ZZA---YB
  217 BIJK=BAZ*BAZ*BAY
      C31=0.2D0*BAY/BA
      C20=-0.3333333333333D0*BAY
      GO TO 133
C  ZZA---ZB
  218 BIJK=BAZ*BAZ*BAZ
      C31=0.6D0*BAZ/BA
      C20=-0.3333333333333D0*BAZ
      GO TO 133
C
  131 LSTRT=LSTR2(KC)
      LSTOP=LSTP2(KC)
      C00=0.0D0
      C11=BIJK/BA
      C22T=C11/BA
      C22=-(2.0D0*C22T+C20)
      GO TO 134
  133 LSTRT=LSTR3(KC)
      LSTOP=LSTP3(KC)
      C00=C20
      C11=0.0D0
      C22T=BIJK/(BA*BA)
      C22=-(C22T+C20)
  134 C33=C22T/BA-C31
      C31=C31+C33
      C22=C22-5.0D0*C33*AI1
      C20=C20+C22
      C11=C11-3.0D0*C22*AI1
      DO 132 K=LSTRT ,LSTOP
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
      C31Z=C31/ZETA
      C20Z=C20*SRZI
      C11Z=(C11+C20Z*X+C31Z*(X*X+N*0.5D0))*SRZI
      C00Z=    (C20Z+C31Z*X)*N1*0.5D0*SRZI
  132 VALUE=VALUE+(C00Z*VM   +C11Z*V    )*CK
      IF(C00.EQ.0.0D0) GO TO 290
      IF(LMAX(KC).EQ.0) GO TO 290
      C11=-C00/BA
      LSTRT=LDSR1(KC)
      LSTOP=LDSP1(KC)
      DO 123 K=LSTRT,LSTOP
      ZETA=XIJ+ZLP(K)
      N=NLP(K) +2
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
  123 VALUE=VALUE+CK*(C00*VM   +C11*SRZI*V    )
      GO TO 290
  505 GO TO (161,201,202,203),JTYP
      AI=BAX
      AJ=BAX
      IA=1
      JA=1
      DELIJ=1.0D0
      GO TO 511
  506 GO TO (163,207,208,209),JTYP
      AI=BAY
      AJ=BAY
      IA=2
      JA=2
      DELIJ=1.0D0
      GO TO 511
  507 GO TO (166,216,217,218),JTYP
      AI=BAZ
      AJ=BAZ
      IA=3
      JA=3
      DELIJ=1.0D0
      GO TO 511
  508 GO TO (162,204,205,206),JTYP
      AI=BAX
      AJ=BAY
      IA=1
      JA=2
      DELIJ=0.0D0
      GO TO 511
  509 GO TO (164,210,211,212),JTYP
      AI=BAX
      AJ=BAZ
      IA=1
      JA=3
      DELIJ=0.0D0
      GO TO 511
  510 GO TO (165,213,214,215),JTYP
      AI=BAY
      AJ=BAZ
      IA=2
      JA=3
      DELIJ=0.0D0
      GO TO 511
  511 JJTYP=JTYP-4
      GO TO (512,513,514,515,516,517),JJTYP
  512 AK=BAX
      AL=BAX
      KA=1
      LA=1
      DELKL=1.0D0
      GO TO 231
  513 AK=BAY
      AL=BAY
      KA=2
      LA=2
      DELKL=1.0D0
      GO TO 231
  514 AK=BAZ
      AL=BAZ
      KA=3
      LA=3
      DELKL=1.0D0
      GO TO 231
  515 AK=BAX
      AL=BAY
      KA=1
      LA=2
      DELKL=0.0D0
      GO TO 231
  516 AK=BAX
      AL=BAZ
      KA=1
      LA=3
      DELKL=0.0D0
      GO TO 231
  517 AK=BAY
      AL=BAZ
      KA=2
      LA=3
      DELKL=0.0D0
      GO TO 231
  231 DELIK=0.0D0
      DELIL=0.0D0
      DELJK=0.0D0
      DELJL=0.0D0
      IF(IA.EQ.KA) DELIK=1.0D0
      IF(IA.EQ.LA) DELIL=1.0D0
      IF(JA.EQ.KA) DELJK=1.0D0
      IF(JA.EQ.LA) DELJL=1.0D0
      AIJ=AI*AJ
      AKL=AK*AL
      AIJDKL=AIJ*DELKL
      AKLDIJ=AKL*DELIJ
      AIJKL=AIJ*AKL
      BAI=1.0D0/BA
      BAI2=BAI*BAI
      AAD=AIJDKL+AKLDIJ+AI*(AK*DELJL+AL*DELJK)+AJ*(AK*DELIL+AL*DELIK)
      DELS=DELIJ*DELKL+DELIK*DELJL+DELIL*DELJK
      C20=AKLDIJ*0.3333333333333D0
      C22T=AIJKL*BAI2
      C22=C22T-C20
      C31=-(AAD-AIJDKL+AKLDIJ)*BAI*0.2D0
      C33=-(2.0D0*C22T*BAI+C31)
      C40=DELS/15.0D0
      C42T=AAD*BAI2/7.0D0
      C42=C42T-DELS/10.5D0
      C44=C22T*BAI2-C42T+DELS/35.0D0
      C42=C42+C44
      C33=C33-7.0D0*C44*AI1
      C40=C40+C42
      C31=C31+C33-3.0D0*C42*AI1
      C22=C22-5.0D0*C33*AI1
      C20=C20+C22
      C11=   -3.0D0*C22*AI1
      LSTRT3=LSTR3(KC)
      LSTOP3=LSTP3(KC)
      DO 232 K=LSTRT3,LSTOP3
      ZETA=XIJ+ZLP(K)
      N=NLP(K)
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
      C40Z=C40*SRZI
      C31Z=(C31+C40Z*X)/ZETA
      C20Z=(C20+C40Z*SRZI*(N1+2)*0.5D0)*SRZI
      C11Z=(C11+C20Z*X+C31Z*(X*X+N*0.5D0))*SRZI
      C00Z=    (C20Z+C31Z*X)*N1*0.5D0*SRZI
  232 VALUE=VALUE+(C00Z*VM   +C11Z*V    )*CK
      IF(DELIJ.EQ.0.0D0) GO TO 290
      IF(LMAX(KC).EQ.0) GO TO 290
      C00=AKL    *0.3333333333333D0
      C11=-C00*BAI*2.0D0
      C20=DELKL*0.1111111111111D0
      C22=C00*BAI2-C20
      C20=C20+C22
      C11=C11-3.0D0*C22*AI1
      LSTRT=LDSR1(KC)
      LSTOP=LDSP1(KC)
      DO 124 K=LSTRT ,LSTOP
      ZETA=XIJ+ZLP(K)
      N=NLP(K)+2
      N1=N+1
      EXA=DEXP(-D*(1.0D0-ZETA1/ZETA))
      SRZI=1.0D0/DSQRT(ZETA)
      CK=CLP(K)*EXA*(SRZI**N )*0.5D0*AI1
      X=B*SRZI
      CALL VVMVAL(1,N,X,VM,V)
  124 VALUE=VALUE+((C00+C20*N1*0.5D0/ZETA)*VM   +(C11+C20*X*SRZI)*
     #  SRZI*V    )*CK
  290 XBAA=VALUE
  291 RETURN
    1 WRITE(6,2)
    2 FORMAT(1H1,///,20X,18HFATAL PURITY ERROR)
      STOP
ccc    END
      end subroutine vbaa
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE VAAA
C
      IMPLICIT REAL*8(A-H,O-Z)
      COMMON/BFCOM/XAAA,ITYP,JTYP,ZI,ZJ,KC
      COMMON/INT2/NLP(200),CLP(200),ZLP(200),LSTR1(20),LSTR2(20),
     #  LSTR3(20),LSTP1(20),LSTP2(20),LSTP3(20)
      COMMON/AAACOM/ZETA
C     DATA FOURPI/12.56637060D0/   DELETED
C
      XAAA=0.0D0
      XIJ=ZI+ZJ
      IF(JTYP.GT.4) GO TO 101
      IF(ITYP.NE.JTYP) RETURN
      GO TO (1,2,2,2),JTYP
  101 IF(JTYP.GT.7) GO TO 3
      IF(ITYP.EQ.1) GO TO 4
      IF(ITYP.LE.4) RETURN
      IF(ITYP.NE.JTYP) GO TO 5
      GO TO 6
    1 LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      DO 10 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
   10 XAAA=XAAA + FA(NLP(K))*CLP(K)
      RETURN
    2 LSTRT2=LSTR2(KC)
      LSTOP2=LSTP2(KC)
      DO 20 K=LSTRT2,LSTOP2
      ZETA=XIJ+ZLP(K)
   20 XAAA=XAAA + FA(NLP(K)+2)*CLP(K)
      XAAA=XAAA*0.3333333333333D0
      RETURN
    3 IF(ITYP.NE.JTYP) RETURN
      LSTRT3=LSTR3(KC)
      LSTOP3=LSTP3(KC)
      DO 30 K=LSTRT3,LSTOP3
      ZETA=XIJ+ZLP(K)
   30 XAAA=XAAA + FA(NLP(K)+4)*CLP(K)
      XAAA=XAAA/15.0D0
      RETURN
    4 LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      DO 40 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
   40 XAAA=XAAA + FA(NLP(K)+2)*CLP(K)
      XAAA=XAAA*0.3333333333333D0
      RETURN
    5 LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      LSTRT3=LSTR3(KC)
      LSTOP3=LSTP3(KC)
      DO 50 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
   50 XAAA=XAAA + FA(NLP(K)+4)*CLP(K)
      XDDD=0.0D0
      DO 55 K=LSTRT3,LSTOP3
      ZETA=XIJ+ZLP(K)
   55 XDDD=XDDD + FA(NLP(K)+4)*CLP(K)
      XAAA=(XAAA-0.4D0*XDDD)*0.1111111111111D0
      RETURN
    6 LSTRT1=LSTR1(KC)
      LSTOP1=LSTP1(KC)
      LSTRT3=LSTR3(KC)
      LSTOP3=LSTP3(KC)
      DO 60 K=LSTRT1,LSTOP1
      ZETA=XIJ+ZLP(K)
   60 XAAA=XAAA + FA(NLP(K)+4)*CLP(K)
      XDDD=0.0D0
      DO 65 K=LSTRT3,LSTOP3
      ZETA=XIJ+ZLP(K)
   65 XDDD=XDDD + FA(NLP(K)+4)*CLP(K)
      XAAA=(XAAA+0.8D0*XDDD)*0.1111111111111D0
      RETURN
ccc    END
      end subroutine vaaa
c----------------------------------------------------------------

c----------------------------------------------------------------
      DOUBLE PRECISION FUNCTION FA(N)
C
      IMPLICIT REAL*8(A-H,O-Z)
C     N.LE.11
      DIMENSION GAMMO(6),GAMME(6)
      COMMON/AAACOM/ZETA
      DATA GAMMO/0.5D0,0.5D0,1.D0,3.D0,12.D0,60.D0/,GAMME/0.5D0,0.25D0,
     X0.375D0,0.9375D0,3.28125D0,14.765625D0/,SQRPI/1.77245385090/
C
      IF (MOD(N,2).EQ.0) GO TO 10
C
      K=(N-1)/2
      FA=GAMMO(K+1)/ZETA**(K+1)
      RETURN
   10 K=N/2
      FA=GAMME(K+1)*SQRPI/(ZETA**K*DSQRT(ZETA))
      RETURN
ccc    END
      end function fa
c----------------------------------------------------------------

c----------------------------------------------------------------
      DOUBLE PRECISION FUNCTION TANH3(X)
      IMPLICIT REAL*8(A-H,O-Z)
C     TANH(X)=X*(1.0+TANH3(X))
      Z=X*X
      TANH3=-Z*0.3333333333333333D0*(1.0D0-Z*0.4D0*(1.0D0-
     # Z*0.4047619047619048D0*(1.0D0-Z*0.4052287581699345D0*(1.0D0-
     # Z*0.4052785923753667D0*(1.0D0-Z*0.4052840550669783D0*(1.0D0-
     # Z*0.4052846591850437D0*(1.0D0-Z*0.4052847261979033D0*(1.0D0-
     # Z*0.4052847336393726D0*(1.0D0-Z*0.4052847344660274D0*(1.0D0-
     # Z*0.4052847345578709D0))))))))))
      RETURN
ccc   END
      end function tanh3
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE  SAVRGE (NGAUS,ETA,S,NGMX,NSAVMX)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION  ETA(NGMX,5), S(NSAVMX), AB(3)
      INDX= 0
      DO  750  II=1,NGAUS
        A= ETA(II,4)
        DO  750  JJ=1,II
          INDX= INDX + 1
          B= ETA(JJ,4)
          T1= 1.0D0/(A + B)
          AB(1)= ETA(II,1) - ETA(JJ,1)
          AB(2)= ETA(II,2) - ETA(JJ,2)
          AB(3)= ETA(II,3) - ETA(JJ,3)
          DAB= AB(1)*AB(1) + AB(2)*AB(2) + AB(3)*AB(3)
          S(INDX)= PITERN*(T1**1.5D0)*DEXP(-A*B*DAB*T1)*ETA(II,5)*ETA(JJ
     X,5)
 750      CONTINUE
      RETURN
ccc   END
      end subroutine savrge
c----------------------------------------------------------------

c----------------------------------------------------------------
      SUBROUTINE GENERF (MAXTYP,MAXRNG)
c***
      use param, only: X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c     COMMON/INC/X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c***
!     IMPLICIT REAL*8(A-H,O-Z)
      implicit none

      integer, intent(in) :: maxtyp
      integer, intent(out) :: maxrng

      real*8 :: t, u, y
      integer :: i
cccc  COMMON/STORE/STR0(280),STR1(280),STR2(280),STR3(280),STR4(280),
cccc 1STR5(280),STR6(280),STR7(280),STR8(280),STR9(280),STR10(280),
cccc 2STR11(280),STR12(280)
      MAXRNG=240
      IF (MAXTYP-4) 762,762,761
  761 MAXRNG=280
  762 CONTINUE
      T=0.D0
      DO 779 I=1,MAXRNG
      Y=DEXP(-T)
      U=2.D0*T
      IF (MAXTYP-4) 764,764,765
  765 STR12(I)=FMCH(12,T,Y)
      STR11(I)=(U*STR12(I)+Y)*X23
      STR10(I)=(U*STR11(I)+Y)*X21
      STR9(I)=(U*STR10(I)+Y)*X19
      STR8(I)=(U*STR9(I)+Y)*X17
      GO TO 766
  764 STR8(I)=FMCH(8,T,Y)
  766 STR7(I)=(U*STR8(I)+Y)*X15
      STR6(I)=(U*STR7(I)+Y)*X13
      STR5(I)=(U*STR6(I)+Y)*X11
      STR4(I)=(U*STR5(I)+Y)*X9
      STR3(I)=(U*STR4(I)+Y)*X7
      STR2(I)=(U*STR3(I)+Y)*X5
      STR1(I)=(U*STR2(I)+Y)*X3
      STR0(I)=(U*STR1(I)+Y)
  779 T=T+0.1D0
      RETURN
c     END
      end subroutine generf
c----------------------------------------------------------------

c----------------------------------------------------------------
cccc  SUBROUTINE SPONES (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX)
      subroutine spones (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX,
     .       ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,LS,
     .       IF,JF,KF,LF,M,I,J,K,L)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION ETA(NGMX,5),S(NSAVMX),VALINT(NINMAX),NR(NTMX,3)
cccc  COMMON /SPECS/ ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
cmod
c     print*,'spones: m = ', m
cmod
      FCTRAB=1.D0
      FCTRCD=1.D0
      DO 245 II=IS,IF
      A=ETA(II,4)
      IF (I-J) 680,681,680
  681 JF=II
      FCTRAB=2.D0
  680 DO 244 JJ=JS,JF
      B=ETA(JJ,4)
      T1=A+B
      IF(II-JJ) 431,432,431
  432 FCTRAB=1.D0
  431 DO 243 KK=KS,KF
      C=ETA(KK,4)
      IF (K-L) 683,682,683
  682 LF=KK
      FCTRCD=2.0D0
  683 DO 242 LL=LS,LF
      D=ETA(LL,4)
      IF (KK-LL) 436,435,436
  435 FCTRCD=1.D0
  436 RAWINT=0.D0
      T2=C+D
      T4=T1+T2
      T1T2=T1*T2
      W=34.9868365D0/DSQRT(T4)
      IF (ITYP-1) 405,406,405
  405 IF (KTYP-1) 860,831,860
  831 IF (ITYP-JTYP) 242,862,242
  860 IF (JTYP-1) 870,871,870
  871 IF (LTYP-1) 870,872,870
  872 IF (ITYP-KTYP) 242,873,242
  870 IF (ITYP-JTYP) 880,881,880
  881 IF (KTYP-LTYP) 242,883,242
  883 IF (ITYP-KTYP) 884,885,884
  880 IF (ITYP-KTYP) 242,886,242
  886 IF (JTYP-LTYP) 242,887,242
  406 RAWINT=W/T1T2
      GO TO 999
  862 T1T4=T1T2/T4
      T1T4=0.5D0/T1*(1.D0-T1T4/(3.D0*T1))
      RAWINT=W/ T1T2*T1T4
      GO TO 999
  873 T1T4=0.5D0/(3.D0*T4)
      RAWINT=W*T1T4/T1T2
      GO TO 999
  885 T1T4=T1T2/T4
      RAWINT=(1.D0-(1.D0/3.D0)+3.D0*(T1T4**2)/(5.D0*T1T2))*W/(4.D0*(T1T2
     X)**2)
      GO TO 999
  884 T1T4=T1T2/T4
      RAWINT=(1.D0-(1.D0/3.D0)+   (T1T4**2)/(5.D0*T1T2))*W/(4.D0*(T1T2)*
     X*2)
      GO TO 999
  887 T1T4=T1T2/T4
      RAWINT=T1T4**2/(5.D0*T1T2)*W/(4.D0*T1T2**2)
  999 RAWINT=RAWINT*ETA(II,5)*ETA(JJ,5)*ETA(KK,5)*ETA(LL,5)*FCTRAB*FCTRC
     XD
cmod
c     if( m .ne. 1 )
c    .print*,'spones: m=',m
cmod
  242 VALINT(M)=VALINT(M)+RAWINT
  243 CONTINUE
  244 CONTINUE
  245 CONTINUE
      RETURN
ccc   END
      end subroutine spones
c----------------------------------------------------------------

c----------------------------------------------------------------
cccc  SUBROUTINE SPDONE (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX)
      subroutine spdone (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX,
     .       ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,LS,
     .       IF,JF,KF,LF,M,I,J,K,L)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION  F(13),C(13,3),MHI(3),ZZ(13)
      DIMENSION ETA(NGMX,5),S(NSAVMX),VALINT(NINMAX),NR(NTMX,3)
cccc  COMMON/SPECS/ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
      DATA F(1)/1.D0/,F(2)/.33333333D0/,F(3)/.2D0/,F(4)/.14285714D0/,F(5
     X)/.11111111D0/,F(6)/.090909091D0/,F(7)/.076923077D0/,F(8)/.0666666
     X67D0/,F(9)/.058823529D0/,F(10)/.052631579D0/,F(11)/.047619047D0/,F
     X(12)/.043478261D0/,F(13)/.04D0/
cmod
c     print*,'spdone: m = ', m
cmod
      FAB=1.D0
      FCD=1.D0
      DO 353 II=IS,IF
      A=ETA(II,4)
      IF (I-J) 680,681,680
  681 JF=II
      FAB=2.D0
  680 DO 352 JJ=JS,JF
      B=ETA(JJ,4)
      T1=A+B
      TAB=0.25D0/T1
      INDEX =  MAX0(II,JJ)*(MAX0(II,JJ) - 1)/2 + MIN0(II,JJ)
      SABOO=S(INDEX)
      IF(II-JJ) 431,432,431
  432 FAB=1.D0
  431 DO 351 KK=KS,KF
      CX=ETA(KK,4)
      IF (K-L) 683,682,683
  682 LF=KK
      FCD=2.D0
 683  DO355LL=LS,LF
      IF (KK-LL) 436,435,436
  435 FCD=1.D0
  436 CONTINUE
      D=ETA(LL,4)
      T2=CX+D
      TCD=0.25D0/T2
      PRTINT=0.D0
      WX=1.D0
      DO346N=1,3
      KT=N
      GAB=TAB
      GCD=TCD
      NIJ=NR(ITYP,KT)+NR(JTYP,KT)+1
      NKL=NR(KTYP,KT)+NR(LTYP,KT)+1
      GO TO (200,201,202,203,204,205,206),NIJ
  200 GO TO (239,499,241,499,242,499,529),NKL
  201 GO TO (499,243,499,244,499,530,499),NKL
  202 GO TO (245,499,246,499,247,499,531),NKL
  203 GO TO (499,249,499,250,499,532,499),NKL
  204 GO TO (251,499,252,499,254,499,533),NKL
  205 GO TO (499,534,499,535,499,536,499),NKL
  206 GO TO (537,499,538,499,539,499,540),NKL
C......(0)(0)
  239 C(1,KT)=1.D0
      MSUM=1
      GO TO 399
C......(0)(2)
  241 C(1,KT)=2.D0*GCD
      C(2,KT)=-2.D0*GCD*GCD
      MSUM=2
      GO TO 399
C......(0)(4)
  242 GG=GCD*GCD
      C(1,KT)=12.D0*GG
      C(2,KT)=-24.D0*GCD*GG
      C(3,KT)=12.D0*GG*GG
      MSUM=3
      GO TO 399
C......(0)(6)
  529 GCD2=GCD*GCD
      GCD4=GCD2*GCD2
      C(1,KT)=120.D0*GCD*GCD2
      C(2,KT)=-360.D0*GCD4
      C(3,KT)=360.D0*GCD*GCD4
      C(4,KT)=-120.D0*GCD2*GCD4
      MSUM=4
      GO TO 399
C......(1)(1)
  243 C(1,KT)=0.D0
      C(2,KT)=2.D0*GAB*GCD
      MSUM=2
      GO TO 399
C......(1)(3)
  244 GG=GCD*GCD
      C(1,KT)=0.D0
      C(2,KT)=12.D0*GG*GAB
      C(3,KT)=-12.D0*GAB*GCD*GG
      MSUM=3
      GO TO 399
C......(1)(5)
  530 GCD2=GCD*GCD
      GCD4=GCD2*GCD2
      GABCD=GAB*GCD
      C(1,KT)=0.D0
      C(2,KT)=120.D0*GABCD*GCD2
      C(3,KT)=-240.D0*GAB*GCD4
      C(4,KT)=120.D0*GABCD*GCD4
      MSUM=4
      GO TO 399
C......(2)(0)
  245 C(1,KT)=2.D0*GAB
      C(2,KT)=-2.D0*GAB*GAB
      MSUM=2
      GO TO 399
C......(2)(2)
  246 GG=GAB*GCD
      C(1,KT)=4.D0*GG
      C(2,KT)=-4.D0*GG*(GAB+GCD)
      C(3,KT)=12.D0*GG*GG
      MSUM=3
      GO TO 399
C......(2)(4)
  247 GGAB=GAB*GAB
      GGCD=GCD*GCD
      GG=GGAB*GGCD
      C(1,KT)=24.D0*GGCD*GAB
      C(2,KT)=-24.D0*GGCD*(GGAB+2.D0*GAB*GCD)
      C(3,KT)=24.D0*(6.D0*GCD*GG+GGCD*GGCD*GAB)
      C(4,KT)=-120.D0*GG*GGCD
      MSUM=4
      GO TO 399
C......(2)(6)
  531 GCD2=GCD*GCD
      GCD4=GCD2*GCD2
      GABCD=GAB*GCD
      GABCD4=GAB*GCD4
      C(1,KT)=240.D0*GABCD*GCD2
      C(2,KT)=-240.D0*GAB*GCD2*(3.D0*GCD2+GABCD)
      C(3,KT)=720.D0*GABCD4*(3.D0*GAB+GCD)
      C(4,KT)=-240.D0*GABCD4*(15.D0*GABCD+GCD2)
      C(5,KT)=1680.D0*GAB*GAB*GCD2*GCD4
      MSUM=5
      GO TO 399
C......(3)(1)
  249 GG=GAB*GAB
      C(1,KT)=0.D0
      C(2,KT)=12.D0*GG*GCD
      C(3,KT)=-12.D0*GAB*GCD*GG
      MSUM=3
      GO TO 399
C......(3)(3)
  250 GGAB=GAB*GAB
      GGCD=GCD*GCD
      GG=GGAB*GGCD
      C(1,KT)=0.D0
      C(2,KT)=72.D0*GG
      C(3,KT)=-72.D0*GG*(GAB+GCD)
      C(4,KT)=120.D0*GG*GAB*GCD
      MSUM=4
      GO TO 399
C......(3)(5)
  532 GAB2=GAB*GAB
      GCD2=GCD*GCD
      GG=GAB2*GCD2*GCD2
      C(1,KT)=0.D0
      C(2,KT)=720.D0*GAB2*GCD*GCD2
      C(3,KT)=-720.D0*GAB2*GCD2*(2.D0*GCD2+GAB*GCD)
      C(4,KT)=240.D0*GG*(10.D0*GAB+3.D0*GCD)
      C(5,KT)=-1680.D0*GAB*GCD*GG
      MSUM=5
      GO TO 399
C......(4)(0)
  251 GG=GAB*GAB
      C(1,KT)=12.D0*GG
      C(2,KT)=-24.D0*GAB*GG
      C(3,KT)=12.D0*GG*GG
      MSUM=3
      GO TO 399
C......(4)(2)
  252 GGAB=GAB*GAB
      GGCD=GCD*GCD
      GG=GGAB*GGCD
      C(1,KT)=24.D0*GGAB*GCD
      C(2,KT)=-24.D0*GGAB*(GGCD+2.D0*GAB*GCD)
      C(3,KT)=24.D0*(6.D0*GAB*GG+GGAB*GGAB*GCD)
      C(4,KT)=-120.D0*GG*GGAB
      MSUM=4
      GO TO 399
C......(4)(4)
  254 GGAB=GAB*GAB
      GGCD=GCD*GCD
      GG=GGAB*GGCD
      C(1,KT)=144.D0*GG
      C(2,KT)=-288.D0*GG*(GCD+GAB)
      C(3,KT)=144.D0*GG*(GGCD+12.D0*GAB*GCD+GGAB)
      C(4,KT)=-1440.D0*GG*(GAB*GGCD+GCD*GGAB)
      C(5,KT)=1680.D0*GG*GG
      MSUM=5
      GO TO 399
C......(4)(6)
  533 GAB2=GAB*GAB
      GCD2=GCD*GCD
      GG=GAB2*GCD2
      C(1,KT)=1440.D0*GG*GCD
      C(2,KT)=-1440.D0*GG*(3.D0*GCD2+2.D0*GAB*GCD)
      C(3,KT)=1440.D0*GG*(3.D0*GCD2*(GCD+6.D0*GAB)+GAB2*GCD)
      C(4,KT)=-1440.D0*GG*(GCD2*GCD2+30.D0*GAB*GCD*GCD2+15.D0*GG)
      C(5,KT)=10080.D0*GG*GCD2*(2.D0*GAB*GCD2+5.D0*GCD*GAB2)
      C(6,KT)=-30240.D0*GG*GG*GCD2
      MSUM=6
      GO TO 399
C......(5)(1)
  534 GAB=TCD
      GCD=TAB
      GO TO 530
C......(5)(3)
  535 GAB=TCD
      GCD=TAB
      GO TO 532
C......(5)(5)
  536 GAB2=GAB*GAB
      GCD2=GCD*GCD
      GABCD=GAB*GCD
      GABCD2=GAB2*GCD2
      C(1,KT)=0.D0
      C(2,KT)=7200.D0*GABCD2*GABCD
      C(3,KT)=-14400.D0*GABCD2*(GAB*GCD2+GCD*GAB2)
      C(4,KT)=2400.D0*GABCD2*(3.D0*GABCD*(GAB2+GCD2)+20.D0*GABCD2)
      C(5,KT)=-33600.D0*GABCD2*GABCD2*(GAB+GCD)
      C(6,KT)=30240.D0*GABCD2*GABCD2*GABCD
      MSUM=6
      GO TO 399
C......(6)(0)
  537 GAB=TCD
      GCD=TAB
      GO TO 529
C......(6)(2)
  538 GAB=TCD
      GCD=TAB
      GO TO 531
C......(6)(4)
  539 GAB=TCD
      GCD=TAB
      GO TO 533
C......(6)(6)
  540 GAB2=GAB*GAB
      GCD2=GCD*GCD
      GABCD=GAB*GCD
      GABCD2=GAB2*GCD2
      C(1,KT)=14400.D0*GABCD2*GABCD
      C(2,KT)=-43200.D0*GABCD2*(GAB*GCD2+GCD*GAB2)
      C(3,KT)=43200.D0*GABCD2*(GABCD*(GAB2+GCD2)+9.D0*GABCD2)
      C(4,KT)=-14400.D0*GABCD2*(GAB*GCD2*GCD2+45.D0*GABCD2*(GAB+GCD)+
     X    GCD*GAB2*GAB2)
      C(5,KT)=302400.D0*GABCD2*GABCD2*(GAB2+5.D0*GABCD+GCD2)
      C(6,KT)=-907200.D0*GABCD2*GABCD2*(GAB*GCD2+GCD*GAB2)
      C(7,KT)=665280.D0*GABCD2*GABCD2*GABCD2
      MSUM=7
  399 CONTINUE
      MHI(KT)=MSUM
 346  CONTINUE
      MX=MHI(1)
      MY=MHI(2)
      MZ=MHI(3)
      MXYZ=MX+MY+MZ-2
      Z=GAB+GCD
      Z=1.D0/Z
      ZZ(1)=1.D0
      ZZ(2)=Z
      IF (MXYZ-2) 380,380,382
  382 DO 381 LIFE=3,MXYZ
      NICE=LIFE-1
 381  ZZ(LIFE)=Z*ZZ(NICE)
  380 CONTINUE
      RAWINT=0.D0
      DO390NX=1,MX
      DO389NY=1,MY
      DO388NZ=1,MZ
      N=NX+NY+NZ-2
 388  RAWINT=RAWINT+C(NX,1)*C(NY,2)*C(NZ,3)*ZZ(N)*F(N)
 389  CONTINUE
 390  CONTINUE
      INDEX =  MAX0(KK,LL)*(MAX0(KK,LL) - 1)/2 + MIN0(KK,LL)
      SCDOO=S(INDEX)
      W=0.25D0*Z
      WX=PITERM*DSQRT(W)*SABOO*SCDOO*FAB*FCD
      PRTINT=RAWINT
cmod
c     if( m .ne. 1 )
c    .print*,'spdone: m=',m
cmod
 355  VALINT(M)=VALINT(M)+WX*PRTINT
 351  CONTINUE
 352  CONTINUE
 353  CONTINUE
  499 CONTINUE
      RETURN
ccc    END
      end subroutine spdone
c----------------------------------------------------------------

c----------------------------------------------------------------
cccc  SUBROUTINE SPINTS (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX)
      subroutine spints (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX,
     .       ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,LS,
     .       IF,JF,KF,LF,M,I,J,K,L)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE

      use param, only: X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c     COMMON/INC/X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION ETA(NGMX,5),S(NSAVMX),VALINT(NINMAX),NR(NTMX,3)

c***
c  In the original fortran77 code, there were references to CD(0) and
c  R(0), arising from ITYP=1 and/or JTYP=1 and/or KTYP=1 and/or LTYP=1.
c  In view of the correspondence CD(0)=SB(4) and R(0)=Q(3), verified in
c  a number of test runs, these arrays are now declared as CD(0:3) and 
c  R(0:3), with explicit equivalence to AB(4) and Q(3).
c
c     DIMENSION P(3),Q(3),R(3),AB(4),CD(3)
      DIMENSION P(3),Q(3),R(0:3),AB(4),CD(0:3)
c***

cccc  COMMON/STORE/STR0(280),STR1(280),STR2(280),STR3(280),STR4(280),
cccc 1STR5(280),STR6(280),STR7(280),STR8(280),STR9(280),STR10(280),
cccc 2STR11(280),STR12(280)
cccc  COMMON /SPECS/ ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
      DATA AB(1)/0.0D00/
      FCTRAB=1.D0
      FCTRCD=1.D0
      ADDIJ=0.D0
      ADDKL=0.D0
      SMIJOO=0.D0
      SMIOKO=0.D0
      SMIOOL=0.D0
      SMOJKO=0.D0
      SMOOKL=0.D0
      SMOJOL=0.D0
      SMIJKO=0.D0
      SMIJOL=0.D0
      SMIOKL=0.D0
      SMOJKL=0.D0
      MSUM=ITYP+JTYP+KTYP+LTYP-4
      DO 350 II=IS,IF
      A=ETA(II,4)
      IF (I-J) 680,681,680
  681 JF=II
      FCTRAB=2.D0
  680 DO 351 JJ=JS,JF
      B=ETA(JJ,4)
      T1=A+B
      AB(2)=ETA(II,1)-ETA(JJ,1)
      AB(3)=ETA(II,2)-ETA(JJ,2)
      AB(4)=ETA(II,3)-ETA(JJ,3)
cmod
c***
      cd(0) = ab(4)
c***
cmod
      ABI=AB(ITYP)
      ABJ=AB(JTYP)
      INDEX =  MAX0(II,JJ)*(MAX0(II,JJ) - 1)/2 + MIN0(II,JJ)
      SABOO=S(INDEX)
      IF (ICNT-JCNT) 704,708,704
  704 CONTINUE
      P(1)=(A*ETA(II,1)+B*ETA(JJ,1))/T1
      P(2)=(A*ETA(II,2)+B*ETA(JJ,2))/T1
      P(3)=(A*ETA(II,3)+B*ETA(JJ,3))/T1
      GO TO 709
  708 P(1)=ETA(II,1)
      P(2)=ETA(II,2)
      P(3)=ETA(II,3)
  709 CONTINUE
      IF (II-JJ) 431,432,431
  432 FCTRAB=1.D0
  431 DO 352 KK=KS,KF
      C=ETA(KK,4)
      IF (K-L) 683,682,683
  682 LF=KK
      FCTRCD=2.D0
  683 DO 353 LL=LS,LF
      IF (KK-LL) 436,435,436
  435 FCTRCD=1.D0
  436 CONTINUE
      D=ETA(LL,4)
      T2=C+D
      CD(1)=ETA(KK,1)-ETA(LL,1)
      CD(2)=ETA(KK,2)-ETA(LL,2)
      CD(3)=ETA(KK,3)-ETA(LL,3)
cmod
c     if(ktyp .eq. 1) then
c       cdk=ab(4)
c     else
c       CDK=CD(KTYP-1)
c     end if
c     if(ltyp .eq. 1) then
c       cdl=ab(4)
c     else
c       CDK=CD(KTYP-1)
c     end if
      CDK=CD(KTYP-1)
      CDL=CD(LTYP-1)
cmod
      INDEX =  MAX0(KK,LL)*(MAX0(KK,LL) - 1)/2 + MIN0(KK,LL)
      SCDOO=S(INDEX)
      T4=T1+T2
      T1T4=T1/T4
      W=T2*T1T4
      WX=PITERM*DSQRT(W)*SABOO*SCDOO*FCTRAB*FCTRCD
      TEST=2.D0*WX
      IF(DABS(TEST)-ACRCY)540,750,750
  750 CONTINUE
      T2T4=T2/T4
      IF (KCNT-LCNT) 705,706,705
  705 CONTINUE
      Q(1)=(C*ETA(KK,1)+D*ETA(LL,1))/T2
      Q(2)=(C*ETA(KK,2)+D*ETA(LL,2))/T2
      Q(3)=(C*ETA(KK,3)+D*ETA(LL,3))/T2
cmod
c***
      r(0) = q(3)
c***
cmod
      GO TO 707
  706 Q(1)=ETA(KK,1)
      Q(2)=ETA(KK,2)
      Q(3)=ETA(KK,3)
cmod
c***
      r(0) = q(3)
c***
cmod
  707 CONTINUE
      R(1)=P(1)-Q(1)
      R(2)=P(2)-Q(2)
      R(3)=P(3)-Q(3)
      PQSQ=R(1)*R(1)+R(2)*R(2)+R(3)*R(3)
cmod
c     if(ityp .eq. 1) then
c       ri = q(3)
c     else
c       RI=R(ITYP-1)
c     end if
c     if(jtyp .eq. 1) then
c       rj = q(3)
c     else
c       RJ=R(JTYP-1)
c     end if
c     if(ktyp .eq. 1) then
c       rk = q(3)
c     else
c       RK=R(KTYP-1)
c     end if
c     if(ltyp .eq. 1) then
c       rl = q(3)
c     else
c       RL=R(LTYP-1)
c     end if
      RI=R(ITYP-1)
      RJ=R(JTYP-1)
      RK=R(KTYP-1)
      RL=R(LTYP-1)
cmod
      RAWINT=0.D0
      IF (PQSQ) 461,461,462
  461 F4=X9
      F3=X7
      F2=X5
      F1=X3
      F0=1.D0
      GO TO 463
  462 T=W*PQSQ
      IF (T-23.9D0) 4620,4621,4621
 4620 CONTINUE
      X=10.D0*(T+0.05D0)
      IT= X
      TI=IT
      IT=IT+1
      DELT=T-0.1D0*TI
      DELT2=0.5D0*DELT
      DELT3= -DELT*X3
C     CORRECTION HERE 8/70-WYH-THD GOT INFO FROM BASCH
C     DELT4=0.25D0*DELT
      DELT4=-0.25D0*DELT
      TF0=STR0(IT)
      TF1=STR1(IT)
      TF2=STR2(IT)
      TF3= STR3(IT)
      TF4=STR4(IT)
      IF (MSUM) 1462,1462,1463
 1463 CONTINUE
      TF5=STR5(IT)
      TF6=STR6(IT)
      TF7=STR7(IT)
      TF8=STR8(IT)
      F4=TF4+DELT*(-TF5+DELT2*(TF6+DELT3*(TF7+DELT4* TF8)))
      F3=TF3+DELT*(-TF4+DELT2*(TF5+DELT3*(TF6+DELT4* TF7)))
      F2=TF2+DELT*(-TF3+DELT2*(TF4+DELT3*(TF5+DELT4* TF6)))
      F1=TF1+DELT*(-TF2+DELT2*(TF3+DELT3*(TF4+DELT4* TF5)))
 1462 CONTINUE
      F0=TF0+DELT*(-TF1+DELT2*(TF2+DELT3*(TF3+DELT4* TF4)))
      GO TO 463
 4621 CONTINUE
      XD=1.D0/T
      F0=.88622692D0*DSQRT(XD)
      IF (MSUM) 463,463,1467
 1467 CONTINUE
      F1=0.5D0*XD*F0
      F2=1.5D0*XD*F1
      F3=2.5D0*XD*F2
      F4=3.5D0*XD*F3
  463 CONTINUE
      GO TO (205,202,203,204),ITYP
  201 WRITE (6,200) ITYP,JTYP,KTYP,LTYP
      STOP
  202 GO TO (206,207,201,201),JTYP
  203 GO TO (210,211,212,201),JTYP
  204 GO TO (214,215,216,217),JTYP
  206 GO TO (218,422,201,201),KTYP
  207 GO TO (222,223,201,201),KTYP
  210 GO TO (218,227,420,201),KTYP
  211 GO TO (230,231,232,201),KTYP
  212 GO TO (222,235,236,201),KTYP
  214 GO TO (218,227,472,419),KTYP
  215 GO TO (230,231,244,769),KTYP
  216 GO TO (230,247,248,249),KTYP
  217 GO TO (222,251,252,253),KTYP
  419 GO TO (219,470,470,421),LTYP
  420 GO TO (219,470,421,201),LTYP
  422 GO TO (219,421,201,201),LTYP
  472 GO TO (286,387,287,201),LTYP
  223 GO TO (254,255,201,201),LTYP
  227 GO TO (286,287,201,201),LTYP
  231 GO TO (260,261,201,201),LTYP
  232 GO TO (262,263,987,201),LTYP
  235 GO TO (264,265,201,201),LTYP
  236 GO TO (254,283,255,201),LTYP
  244 GO TO (354,270,271,201),LTYP
  769 GO TO (262,263,277,987),LTYP
  247 GO TO (354,271,201,201),LTYP
  248 GO TO (260,275,261,201),LTYP
  249 GO TO (262,277,263,987),LTYP
  251 GO TO (264,265,201,201),LTYP
  252 GO TO (264,281,265,201),LTYP
  253 GO TO (254,283,283,255),LTYP
C     SSSS
  205 RAWINT=F0
      GO TO 999
C     XSSS,YSSS,ZSSS
  218 IF (ABI) 710,711,710
  711 RAWINT=-T2T4*RI*F1
      GO TO 999
  710 RAWINT=-B*ABI*F0/T1-T2T4*RI*F1
      GO TO 999
C     XSXS,YSYS,ZSZS
  219 PRTINT=0.5D0*F1/T4
  319 SIOOO=-T2T4*RI
      SOOKO= T1T4*RK
      IF (ABI) 740,741,740
  741 IF (CDK) 746,742,746
  746 SKO=-D*CDK/T2
      RAWINT=SIOOO*(SKO*F1+SOOKO*F2)+PRTINT
      GO TO 999
  742 RAWINT=SOOKO*SIOOO*F2+PRTINT
      GO TO 999
  740 SIO=-B*ABI/T1
      IF (CDK) 743,744,743
  744 RAWINT=SOOKO*(SIO*F1+SIOOO*F2)+PRTINT
      GO TO 999
  743 SKO=-D*CDK/T2
      RAWINT=SKO*(SIO*F0+SIOOO*F1)+SOOKO*(SIO*F1+SIOOO*F2)+PRTINT
      GO TO 999
C     XXSS,YYSS,ZZSS
  222 SIOOO=-T2T4*RI
      IF (ABI) 716,717,716
  717 RAWINT=(F0-T2T4*F1)*0.5D0/T1+F2*SIOOO**2
      GO TO 999
  716 CONTINUE
      RAWINT=(F1*(SIOOO*ABI*(A-B)-0.5D0*T2T4)+F0*(0.5D0-A*ABI*B*ABJ/T1))
     X/T1         + F2*SIOOO**2
      GO TO 999
C     YSXS,ZSXS,ZSYS
  286 PRTINT=0.D0
      GO TO 319
C     YXSS,ZXSS,ZYSS
  230 SIOOO=-T2T4*RI
      SOJOO=-T2T4*RJ
      IF (ICNT-JCNT) 718,719,718
  719 RAWINT=F2*SIOOO*SOJOO
      GO TO 999
  718 CONTINUE
      RAWINT=(F1*(SIOOO*A*ABJ-SOJOO*B*ABI)-A*B*ABI*ABJ*F0/T1)/T1+F2*
     X       SIOOO*SOJOO
      GO TO 999
C     XSXX,YSYY,ZSZZ
  421 ADDKL=0.5D0/T2
      SMIOKO=0.5D0*F1/T4
      SMIOOL=SMIOKO
      SMOOKL=-T1T4*F1*ADDKL
      SMIOKL=1.5D0*T1T4*RI*F2/T4
  387 SIO=-B*ABI/T1
      SIOOO=-T2T4*RI
      SOOKO=T1T4*RK
      SOOOL=T1T4*RL
      SOOKL=SOOKO*SOOOL*F2+SMOOKL
      SIOKO=SIOOO*SOOKO*F2+SMIOKO
      SIOOL=SIOOO*SOOOL
      SIOKL=SIOOL*SOOKO*F3+SMIOKL
      SIOOL=SIOOL*F2+SMIOOL
      IF (KCNT-LCNT) 720,721,720
  721 IF (ADDKL) 760,761,760
  761 RAWINT=SIO*SOOKL+SIOKL
      GO TO 999
 760  CONTINUE
      SKL=ADDKL
      RAWINT=SKL*(SIO*F0+SIOOO*F1)+SIO*SOOKL+SIOKL
      GO TO 999
  720 CONTINUE
      SKO=-D*CDK/T2
      SOL=C*CDL/T2
      SKL=SKO*SOL+ADDKL
      RAWINT=SKL*(SIO*F0+SIOOO*F1)+SKO*(SIO*SOOOL*F1+SIOOL)+SOL*(SIO*SOO
     X       KO*F1+SIOKO)+SIO*SOOKL+SIOKL
      GO TO 999
C     YSXX,ZSXX,ZSYY
  287 ADDKL=0.5D0/T2
      SMIOKL=0.5D0*T1T4*RI*F2/T4
      SMOOKL=-T1T4*F1*ADDKL
      GO TO 387
C     YSYX,ZSZX,ZSZY
  470 SMIOKO=0.5D0*F1/T4
      SMIOKL=0.5D0*T1T4*RL*F2/T4
      GO TO 387
C     XXXS,YYYS,ZZZS
  254 ADDIJ=0.5D0/T1
      SMOJKO=0.5D0*F1/T4
      SMIOKO=SMOJKO
      SMIJOO=-T2T4*F1*ADDIJ
      SMIJKO=-T2T4*1.5D0*RI*F2/T4
  354 CONTINUE
      SKO=-D*CDK/T2
      SIOOO=-T2T4*RI
      SOJOO=-T2T4*RJ
      SOOKO=T1T4*RK
      SIJOO=SIOOO*SOJOO*F2+SMIJOO
      SIOKO=SIOOO*SOOKO*F2+SMIOKO
      SOJKO=SOJOO*SOOKO
      SIJKO= SOJKO*SIOOO*F3 + SMIJKO
      SOJKO=SOJKO*F2+SMOJKO
      IF (ICNT-JCNT) 722,723,722
  723 IF (ADDIJ) 765,766,765
  766 RAWINT=SKO*SIJOO+SIJKO
      GO TO  999
  765 CONTINUE
      SIJ=ADDIJ
      RAWINT=SIJ*(SKO*F0+SOOKO*F1)+SKO*SIJOO+SIJKO
      GO TO 999
  722 CONTINUE
      SIO=-B*ABI/T1
      SOJ=A*ABJ/T1
      SIJ=SIO*SOJ+ADDIJ
      RAWINT=SIJ*(SKO*F0+SOOKO*F1)+SIO*(SKO*SOJOO*F1+SOJKO)+SOJ*(SKO*SI
     X       OOO*F1+SIOKO)+SKO*SIJOO+SIJKO
      GO TO 999
C     YXXS,ZXXS,ZYYS
  260 SMOJKO=0.5D0*F1/T4
      SMIJKO=-T2T4*0.5D0*RI*F2/T4
      GO TO 354
C     YXYS,ZXZS,ZYZS
  262 SMIOKO=0.5D0*F1/T4
      SMIJKO=-T2T4*0.5D0*RJ*F2/T4
      GO TO 354
C     YYXS,ZZXS,ZZYS
  264 ADDIJ=0.5D0/T1
      SMIJOO=-T2T4*F1*ADDIJ
      SMIJKO=-T2T4*0.5D0*RK*F2/T4
      GO TO 354
C     XXXX,YYYY,ZZZZ
  255 ADDIJ=0.5D0/T1
      ADDKL=0.5D0/T2
      SMOJKO=0.5D0*F1/T4
      SMIOKO= SMOJKO
      SMOJOL=SMOJKO
      SMIOOL=SMOJKO
      SMIJOO=-T2T4*F1*ADDIJ
      SMOOKL=-T1T4*F1*ADDKL
      PRTINT= 1.5D0*F2*RI/T4
      SMIJKO=-T2T4*PRTINT
      SMIJOL=SMIJKO
      SMOJKL=T1T4*PRTINT
      SMIOKL=SMOJKL
      SMIJKL=-(3.D0*T1T4*T2T4*RI*RJ*F3-0.75D0*F2/T4)/T4
  355 CONTINUE
      IF (PQSQ) 777,778,777
  778 SIO=-B*ABI/T1
      SOJ= A*ABJ/T1
      SIJ= SIO*SOJ + ADDIJ
      SKO=-D*CDK/T2
      SOL= C*CDL/T2
      SKL=SKO*SOL+ADDKL
      RAWINT=SIJ*(SKL*F0+SMOOKL)+SIO*(SKO*SMOJOL+SOL*SMOJKO+SMOJKL)+
     XSOJ*(SKO*SMIOOL+SOL*SMIOKO+SMIOKL)+SKL*SMIJOO+SKO*SMIJOL+
     XSOL*SMIJKO+SMIJKL
      GO TO 999
  777 CONTINUE
      SIOOO=-T2T4*RI
      SOJOO=-T2T4*RJ
      SOOKO=T1T4*RK
      SOOOL=T1T4*RL
      SIJOO=SIOOO*SOJOO
      SOOKL=SOOOL*SOOKO
      SIJKL=SIJOO*SOOKL*F4+SMIJKL
      SIJKO=SIJOO*SOOKO*F3+SMIJKO
      SIJOL=SIJOO*SOOOL*F3+SMIJOL
      SOJKL=SOJOO*SOOKL*F3+SMOJKL
      SIOKL=SIOOO*SOOKL*F3+SMIOKL
      SIJOO=SIJOO*F2+SMIJOO
      SOOKL=SOOKL*F2+SMOOKL
      SIOKO=SIOOO*SOOKO*F2+SMIOKO
      SIOOL=SIOOO*SOOOL*F2+SMIOOL
      SOJKO=SOJOO*SOOKO*F2+SMOJKO
      SOJOL=SOJOO*SOOOL*F2+SMOJOL
      IF (ICNT-JCNT) 730,731,730
  731 IF (KCNT-LCNT) 732,733,732
  730 SIO=-B*ABI/T1
      SOJ= A*ABJ/T1
      SIJ=SIO*SOJ+ADDIJ
      IF (KCNT-LCNT) 734,735,734
  732 CONTINUE
      SIJ=ADDIJ
      SKO=-D*CDK/T2
      SOL= C*CDL/T2
      SKL=SKO*SOL+ADDKL
      IF (SIJ) 770,771,770
  771 RAWINT=SKL*SIJOO+SKO*SIJOL+SOL*SIJKO+SIJKL
      GO TO 999
  770 CONTINUE
      RAWINT=SIJ*(SKL*F0+SKO*SOOOL*F1+SOL*SOOKO*F1+SOOKL)+SKL*SIJOO+
     XSKO*SIJOL+SOL*SIJKO+SIJKL
      GO TO 999
  735 IF (ADDKL) 772,773,772
  773 RAWINT=SIJ*SOOKL+SIO*SOJKL+SOJ*SIOKL+SIJKL
      GO TO 999
  772 CONTINUE
      SKL=ADDKL
      RAWINT=SIJ*(SKL*F0+SOOKL)+SIO*(SKL*SOJOO*F1+SOJKL)+SOJ*(SKL*SIOOO*
     XF1+SIOKL)+SKL*SIJOO+SIJKL
      GO TO 999
  733 SIJ=ADDIJ
      SKL=ADDKL
      RAWINT=SIJ*(SKL*F0+SOOKL)+SKL*SIJOO+SIJKL
      GO TO 999
  734 CONTINUE
      SKO=-D*CDK/T2
      SOL= C*CDL/T2
      SKL=SKO*SOL+ADDKL
      RAWINT=SIJ*(SKL*F0+SKO*SOOOL*F1+SOL*SOOKO*F1+SOOKL)+SIO*(SKL*SOJOO
     X       *F1+SKO*SOJOL+SOL*SOJKO+SOJKL)+SOJ*(SKL*SIOOO*F1+SKO*SIOO
     X       L+SOL*SIOKO+SIOKL)+SKL*SIJOO+SKO*SIJOL+SOL*SIJKO+SIJKL
      GO TO 999
C     YXXX,ZXXX,ZYYY
  261 ADDKL=0.5D0/T2
      SMOJKO=0.5D0*F1/T4
      SMOOKL=-T1T4*F1*ADDKL
      SMOJOL=SMOJKO
      PRTINT=0.5D0*F2*RI/T4
      SMIOKL=T1T4*PRTINT
      SMIJKO=-T2T4*PRTINT
      SMIJOL=SMIJKO
      PRTINT=1.5D0*T1T4*RL/T4
      SMOJKL=PRTINT*F2
      SMIJKL=-PRTINT*F3*RI*T2T4
      GO TO 355
C     YXYY,ZXZZ,ZYZZ
  987 ADDKL=0.5D0/T2
      SMIOKO=0.5D0*F1/T4
      SMOOKL=-T1T4*F1*ADDKL
      SMIOOL=SMIOKO
      PRTINT=0.5D0*F2*RJ/T4
      SMIJKO=-T2T4*PRTINT
      SMIJOL=SMIJKO
      SMOJKL=T1T4*PRTINT
      PRTINT=1.5D0*T1T4*RI/T4
      SMIOKL= PRTINT*F2
      SMIJKL=-PRTINT*F3*RJ*T2T4
      GO TO 355
C     YYYX,ZZZX,ZZZY
  283 ADDIJ=0.5D0/T1
      SMOJKO=0.5D0*F1/T4
      SMIOKO=SMOJKO
      SMIJOO=-T2T4*F1*ADDIJ
      PRTINT=0.5D0*F2*RL/T4
      SMIJOL=-T2T4*PRTINT
      SMOJKL=T1T4*PRTINT
      SMIOKL=SMOJKL
      PRTINT=1.5D0*T2T4*RI/T4
      SMIJKO=-PRTINT*F2
      SMIJKL=-PRTINT*F3*RL*T1T4
      GO TO 355
C     YYXX,ZZXX,ZZYY
  265 ADDIJ=0.5D0/T1
      ADDKL=0.5D0/T2
      SMIJOO=-T2T4*F1*ADDIJ
      SMOOKL=-T1T4*F1*ADDKL
      PRTINT=0.5D0*F2/T4
      SMIJKO=-T2T4*PRTINT*RK
      SMIJOL=SMIJKO
      SMOJKL=T1T4*PRTINT*RJ
      SMIOKL=SMOJKL
      SMIJKL=-0.5D0*(T1T4*T2T4*F3*(RI*RJ+RK*RL)-    PRTINT)/T4
      GO TO 355
C     YXYX,ZXZX,ZYZY
  263 SMIOKO=0.5D0*F1/T4
      SMOJOL=SMIOKO
      PRTINT=0.5D0*F2/T4
      SMIJKO=-T2T4*PRTINT*RJ
      SMIJOL=-T2T4*PRTINT*RI
      SMOJKL=T1T4*PRTINT*RK
      SMIOKL=T1T4*PRTINT*RL
      SMIJKL=-0.5D0*(T1T4*T2T4*F3*(RI*RK+RJ*RL)-    PRTINT)/T4
      GO TO 355
C     ZZYX
  281 ADDIJ=0.5D0/T1
      SMIJOO=-T2T4*F1*ADDIJ
      PRTINT=0.5D0*F2/T4*T2T4
      SMIJKO=-PRTINT*RK
      SMIJOL=-PRTINT*RL
      SMIJKL=-0.5D0*T1T4*T2T4*F3*RK*RL/T4
      GO TO 355
C     ZXYX
  270 SMOJOL=0.5D0*F1/T4
      PRTINT=0.5D0*F2/T4
      SMIJOL=-T2T4*PRTINT*RI
      SMOJKL=T1T4*PRTINT*RK
      SMIJKL=-0.5D0*T1T4*T2T4*F3*RI*RK/T4
      GO TO 355
C     ZXYY,ZYXX
  271 ADDKL=0.5D0/T2
      SMOOKL=-T1T4*F1*ADDKL
      PRTINT=0.5D0*F2/T4*T1T4
      SMOJKL=PRTINT*RJ
      SMIOKL=PRTINT*RI
      SMIJKL=-0.5D0*T1T4*T2T4*F3*RI*RJ/T4
      GO TO 355
C     ZYYX
  275 SMOJKO=0.5D0*F1/T4
      PRTINT=0.5D0*F2/T4
      SMIJKO=-T2T4*RI*PRTINT
      SMOJKL=T1T4*RL*PRTINT
      SMIJKL=-0.5D0*T1T4*T2T4*F3*RI*RL/T4
      GO TO 355
C     ZXZY,  ZYZX
  277 SMIOKO=0.5D0*F1/T4
      PRTINT=0.5D0*F2/T4
      SMIJKO=-T2T4*RJ*PRTINT
      SMIOKL=T1T4*PRTINT*RL
      SMIJKL= -0.5D0*T1T4*T2T4*F3*RJ*RL/T4
      GO TO 355
  999 CONTINUE
      RAWINT=WX*RAWINT
      VALINT(M)=VALINT(M)+RAWINT
  540 CONTINUE
  353 CONTINUE
  352 CONTINUE
  351 CONTINUE
  350 CONTINUE
      RETURN
  200 FORMAT ( 6H0ERROR,4I4)
ccc   END
      end subroutine spints
c----------------------------------------------------------------

c----------------------------------------------------------------
cccc  SUBROUTINE SPDINT (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX)
      subroutine spdint (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX,
     .       ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,LS,
     .       IF,JF,KF,LF,M,I,J,K,L)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE

      use param, only: X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c     COMMON/INC/  X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION ETA(NGMX,5),VALINT(NINMAX),S(NSAVMX),NR(NTMX,3)
      DIMENSION P(3),Q(3),R(3),PA(3),PB(3),QC(3),QD(3),F(13),C(13,3),
     1MHI(3),ZZ(13),E(7,3),NDEX(3)
cccc  COMMON/SPECS/ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
cccc  COMMON /GAMMA/ F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12
cccc  COMMON/STORE/STR0(280),STR1(280),STR2(280),STR3(280),STR4(280),
cccc $  STR5(280),STR6(280),STR7(280),STR8(280),STR9(280),STR10(280),
cccc 2STR11(280),STR12(280)
c     EQUIVALENCE (F(1),F0)
      FAB=1.D0
      FCD=1.D0
      ABXYZ=ICNT-JCNT
      CDXYZ=KCNT-LCNT
      ABXYZ=DABS(ABXYZ)
      CDXYZ=DABS(CDXYZ)
      DO 353 II=IS,IF
      A=ETA(II,4)
      IF (I-J) 680,681,680
  681 JF=II
      FAB=2.D0
  680 DO 352 JJ=JS,JF
      B=ETA(JJ,4)
      T1=1.D0/(A+B)
      GAB=0.25D0*T1
      INDEX =  MAX0(II,JJ)*(MAX0(II,JJ) - 1)/2 + MIN0(II,JJ)
      SABOO=S(INDEX)
      IF (ABXYZ) 704,708,704
  704 CONTINUE
      P(1)=(A*ETA(II,1)+B*ETA(JJ,1))*T1
      P(2)=(A*ETA(II,2)+B*ETA(JJ,2))*T1
      P(3)=(A*ETA(II,3)+B*ETA(JJ,3))*T1
      GO TO 709
  708 P(1)=ETA(II,1)
      P(2)=ETA(II,2)
      P(3)=ETA(II,3)
  709 CONTINUE
      PA(1)=P(1)-ETA(II,1)
      PA(2)=P(2)-ETA(II,2)
      PA(3)=P(3)-ETA(II,3)
      PB(1)=P(1)-ETA(JJ,1)
      PB(2)=P(2)-ETA(JJ,2)
      PB(3)=P(3)-ETA(JJ,3)
      DO 295 KT=1,3
      NI=NR(ITYP,KT)
      NJ=NR(JTYP,KT)
      PAKT=PA(KT)
      PBKT=PB(KT)
      IF (NI-1) 100,101,102
  100 IF (NJ-1) 103,104,105
  101 IF (NJ-1) 106,107,108
  102 IF (NJ-1) 109,110,111
C.....00
  103 INDEX=1
      HL0=1.D0
      GO TO 199
C.....10
  106 HL0=PAKT
      HL1=GAB
      INDEX=2
      GO TO 199
C.....11
 107  INDEX=7
      HL2=GAB*GAB
      IF(ABXYZ)150,151,150
 151  HL0=2.D0*GAB
      HL1=0.D0
      GOTO199
  150 HL0=PAKT*PBKT+2.D0*GAB
      HL1=GAB*(PAKT+PBKT)
      GO TO 199
C.....20
 109  INDEX=5
      HL2=GAB*GAB
      IF(ABXYZ)152,153,152
 153  HL0=2.D0*GAB
      HL1=0.D0
      GOTO199
  152 HL0=PAKT*PAKT+2.D0*GAB
      HL1=2.D0*GAB*PAKT
      GO TO 199
C.....21
  110 GG=GAB*GAB
      INDEX=14
      HL3=GAB*GG
      IF  (ABXYZ)  154,156,154
  156 HL1=6.D0*GG
      HL0=0.D0
      HL2=0.D0
      GOTO199
  154 HL0=PAKT*PAKT*PBKT+2.D0*GAB*(2.D0*PAKT+PBKT)
      HL1=GAB*PAKT*(2.D0*PBKT+PAKT)+6.D0*GG
      HL2=GG*(2.D0*PAKT+PBKT)
      GO TO 199
C.....22
  111 GG=GAB*GAB
      INDEX=22
      HL4=GG*GG
      IF (ABXYZ) 157,159,157
  159 HL2=12.D0*GAB*GG
      HL0=12.D0*GG
      HL1=0.D0
      HL3=0.D0
      GOTO199
 157  AB=PAKT*PBKT
      APB=(PAKT+PBKT)*(PAKT+PBKT) + 2.D0*AB
      HL0=AB*AB+2.D0*GAB*APB+12.D0*GG
      HL1=(PAKT+PBKT)*(2.D0*GAB*AB+12.D0*GG)
      HL2=GG*(APB+12.D0*GAB)
      HL3=2.D0*GG*GAB*(PAKT+PBKT)
      GO TO 199
C.....01
  104 HL0=PBKT
      HL1=GAB
      INDEX=2
      GO TO 199
C.....02
 105  INDEX=5
      HL2=GAB*GAB
      IF (ABXYZ) 160,153,160
  160 HL0=PBKT*PBKT+2.D0*GAB
      HL1=PBKT*2.D0*GAB
      GO TO 199
C.....12
  108 GG=GAB*GAB
      INDEX=14
      HL3=GAB*GG
      IF (ABXYZ) 162,156,162
  162 HL0=PBKT*PBKT*PAKT+2.D0*GAB*(2.D0*PBKT+PAKT)
      HL1=GAB*PBKT*(2.D0*PAKT+PBKT)+6.D0*GG
      HL2=GG*(2.D0*PBKT+PAKT)
  199 CONTINUE
      E(1,KT)=HL0
      E(2,KT)=HL1
      E(3,KT)=HL2
      E(4,KT)=HL3
      E(5,KT)=HL4
      NDEX(KT)=INDEX
  295 CONTINUE
      IF(II-JJ) 431,432,431
  432 FAB=1.D0
  431 DO 351 KK=KS,KF
      CX=ETA(KK,4)
      IF (K-L) 683,682,683
  682 LF=KK
      FCD=2.D0
 683  DO355LL=LS,LF
      IF (KK-LL) 436,435,436
  435 FCD=1.D0
  436 CONTINUE
      D=ETA(LL,4)
      T2=1.D0/(CX+D)
      GCD=0.25D0*T2
      Z= GAB + GCD
      Z=1.D0/Z
      INDEX =  MAX0(KK,LL)*(MAX0(KK,LL) - 1)/2 + MIN0(KK,LL)
      SCDOO=S(INDEX)
      W=0.25D0*Z
      WX=PITERM*DSQRT(W)*SABOO*SCDOO*FAB*FCD
      TEST=2.D0*WX
      PRTINT=0.D0
      IF (DABS(TEST)-ACRCY) 540,750,750
  750 IF (CDXYZ) 705,706,705
  705 CONTINUE
      Q(1)=(CX*ETA(KK,1)+D*ETA(LL,1))*T2
      Q(2)=(CX*ETA(KK,2)+D*ETA(LL,2))*T2
      Q(3)=(CX*ETA(KK,3)+D*ETA(LL,3))*T2
      GO TO 707
  706 Q(1)=ETA(KK,1)
      Q(2)=ETA(KK,2)
      Q(3)=ETA(KK,3)
  707 R(1)=P(1)-Q(1)
      R(2)=P(2)-Q(2)
      R(3)=P(3)-Q(3)
      PQSQ=R(1)*R(1)+R(2)*R(2)+R(3)*R(3)
      QC(1)=Q(1)-ETA(KK,1)
      QC(2)=Q(2)-ETA(KK,2)
      QC(3)=Q(3)-ETA(KK,3)
      QD(1)=Q(1)-ETA(LL,1)
      QD(2)=Q(2)-ETA(LL,2)
      QD(3)=Q(3)-ETA(LL,3)
      RAWINT=0.D0
      DO 346 KT=1,3
      NI=NR(ITYP,KT)
      NJ=NR(JTYP,KT)
      NK=NR(KTYP,KT)
      NL=NR(LTYP,KT)
      MSUM=NI+NJ+NK+NL+1
      IF (MSUM-1) 2,2,610
  610 CONTINUE
      QCKT=QC(KT)
      QDKT=QD(KT)
      RKT=-R(KT)
      HL0=E(1,KT)
      HL1=E(2,KT)
      HL2=E(3,KT)
      HL3=E(4,KT)
      HL4=E(5,KT)
      INDEX=NDEX(KT)
      IF(NK-1)200,201,202
  200 IF(NL-1)203,204,205
  201 IF (NL-1) 206,207,208
  202 IF(NL-1)209,210,211
C.....00
  203 INDEX=INDEX+1
      HM0=1.D0
      GOTO299
C.....10
  206 HM0=QCKT
      HM1=-GCD
      INDEX=INDEX+2
      GOTO299
C.....11
 207  INDEX=INDEX+7
      HM2=GCD*GCD
      IF(CDXYZ)250,251,250
 251  HM0=2.D0*GCD
      HM1=0.D0
      GOTO299
  250 HM0=QCKT*QDKT+2.D0*GCD
      HM1=-GCD*(QCKT+QDKT)
      GOTO299
C.....20
 209  INDEX=INDEX+5
      HM2=GCD*GCD
      IF(CDXYZ)252,253,252
 253  HM0=2.D0*GCD
      HM1=0.D0
      GOTO299
  252 HM0=QCKT*QCKT+2.D0*GCD
      HM1=-2.D0*GCD*QCKT
      GOTO299
C.....21
  210 GG=GCD*GCD
      INDEX=INDEX+14
      HM3=-GCD*GG
      IF(CDXYZ)254,256,254
  256 HM1=-6.D0*GG
      HM0=0.D0
      HM2=0.D0
      GOTO299
  254 HM0=QCKT*QCKT*QDKT+2.D0*GCD*(2.D0*QCKT+QDKT)
      HM1=-(GCD*QCKT*(2.D0*QDKT+QCKT)+6.D0*GG)
      HM2=GG*(2.D0*QCKT+QDKT)
      GOTO299
C.....22
  211 GG=GCD*GCD
      INDEX=INDEX+22
      HM4=GG*GG
      IF(CDXYZ)257,259,257
  259 HM2=12.D0*GCD*GG
      HM0=12.D0*GG
      HM1=0.D0
      HM3=0.D0
      GOTO299
  257 CD=QCKT*QDKT
      CPD=(QCKT+QDKT)*(QCKT+QDKT)+2.D0*CD
      HM0=CD*CD+2.D0*GCD*CPD+12.D0*GG
      HM1=-(QCKT+QDKT)*(2.D0*GCD*CD+12.D0*GG)
      HM2=GG*(CPD+12.D0*GCD)
      HM3=-2.D0*GG*GCD*(QCKT+QDKT)
      GOTO299
C.....01
  204 HM0=QDKT
      HM1=-GCD
      INDEX=INDEX+2
      GOTO299
C.....02
 205  INDEX=INDEX+5
      HM2=GCD*GCD
      IF (CDXYZ) 260,253,260
  260 HM0=QDKT*QDKT+2.D0*GCD
      HM1=-2.D0*GCD*QDKT
      GOTO299
C.....12
  208 GG=GCD*GCD
      INDEX=INDEX+14
      HM3=-GCD*GG
      IF (CDXYZ) 262,256,262
  262 HM0=QDKT*QDKT*QCKT+2.D0*GCD*(2.D0*QDKT+QCKT)
      HM1=-(GCD*QDKT*(2.D0*QCKT+QDKT)+6.D0*GG)
      HM2=GG*(2.D0*QDKT+QCKT)
  299 CONTINUE
      GOTO(1,2,3,4,1,6,7,6,7,10,1,10,1,10,15,16,1,1,19,1,19,1,23,24,1,1,
     127,28,27,1,1,1,1,1,1,36,1,1,1,1,1,1,1,44),INDEX
 1    WRITE(6,298)INDEX,I,J,K,L,II,JJ,KK,LL,NI,NJ,NK,NL,KT
 298  FORMAT(6H0INDEXI5,13I5)
      STOP
C.....0000
 2    C(1,KT)=1.D0
      GO TO 399
C.....1000 0100 0010 0001
 3    IF(NI+NJ)1,310,311
 311  C(1,KT)=HL0
      C(2,KT)=RKT*HL1
      GO TO 399
 310  C(1,KT)=HM0
      C(2,KT)=RKT*HM1
      GO TO 399
CC....1010 1001 0110 0101
 4    HLM1=HL1*HM0+HL0*HM1
      HLM2=HL1*HM1
 312  C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT*RKT*HLM2
      GO TO 399
C.....2000 0200 0020 0002 1100 0011
 6    IF(NI+NJ)1,313,309
 313  HLM1=HM1
      HLM2=HM2
      GOTO312
 309  HLM1=HL1
      HLM2=HL2
      GOTO312
C.....2010 2001 0210 0201 1020 1002 0120 0102 1110 1101 1011 0111
 7    IF(NI+NJ-NK-NL)314,1,315
 314  HLM2=HL1*HM1+HL0*HM2
      HLM3=HL1*HM2
      GOTO3080
 315  HLM2=HL1*HM1+HL2*HM0
      HLM3=HL2*HM1
 3080 HLM1=HL1*HM0+HL0*HM1
 308  RKT2=RKT*RKT
      RKT3=RKT*RKT2
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*HLM3*RKT
      C(4,KT)=RKT3*HLM3
      GO TO  399
C.....2020 2002 0220 0202 2011 0211 1120 1102 1111
 10   HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL2*HM1+HL1*HM2
      HLM4=HL2*HM2
  307 IF (RKT) 372,371,372
  372 IF (ABXYZ+CDXYZ) 376,376,377
 376  RKT2=RKT*RKT
      RKT4=RKT2*RKT2
      C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=RKT2*HLM2+12.D0*HLM4
      C(4,KT)=-12.D0*RKT2*HLM4
      C(5,KT)=RKT4*HLM4
      GOTO399
 377  CONTINUE
      RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT4=RKT*RKT3
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*RKT*HLM3+12.D0*HLM4
      C(4,KT)=RKT3*HLM3-12.D0*RKT2*HLM4
      C(5,KT)=RKT4*HLM4
      GO TO 399
C.....2100 1200 0021 0012
 15   IF(NI)1,316,317
 316  HLM1=HM1
      HLM2=HM2
      HLM3=HM3
      GOTO308
 317  HLM1=HL1
      HLM2=HL2
      HLM3=HL3
      GOTO308
C.....2110 2101 1210 1201 1021 1012 0121 0112
 16   IF(NI+NJ-NK-NL)318,1,319
 318  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1
      HLM3=HL1*HM2+HL0*HM3
      HLM4=HL1*HM3
      GOTO307
 319  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL2*HM0+HL1*HM1
      HLM3=HL2*HM1+HL3*HM0
      HLM4=HL3*HM1
      GO TO 307
C.....2120 2102 1220 1202 2021 2012 0221 0212 2111 1211 1121 1112
 19   IF(NI+NJ-NK-NL)320,1,321
 320  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL1*HM2+HL0*HM3+HL2*HM1
      HLM4=HL2*HM2+HL1*HM3
      HLM5=HL2*HM3
      GOTO322
 321  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL2*HM1+HL3*HM0+HL1*HM2
      HLM4=HL2*HM2+HL3*HM1
      HLM5=HL3*HM2
  322 IF (RKT) 370,371,370
 371  C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=12.D0*HLM4
      MSUM=3
      GOTO399
  370 IF (ABXYZ+CDXYZ) 1372,1372,373
 1372 RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT5=RKT2*RKT3
      C(1,KT)=0.D0
      C(2,KT)=RKT*HLM1
      C(3,KT)=-6.D0*RKT*HLM3
      C(4,KT)=RKT3*HLM3+60.D0*RKT*HLM5
      C(5,KT)=-20.D0*RKT3*HLM5
      C(6,KT)=RKT5*HLM5
      GOTO399
 373  CONTINUE
      RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT4=RKT*RKT3
      RKT5=RKT*RKT4
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*RKT*HLM3+12.D0*HLM4
      C(4,KT)=RKT3*HLM3-12.D0*RKT2*HLM4+60.D0*RKT*HLM5
      C(5,KT)=RKT4*HLM4-20.D0*RKT3*HLM5
      C(6,KT)=RKT5*HLM5
      GO TO 399
C.....2200 0022
 23   IF(NI)1,323,324
 323  HLM1=HM1
      HLM2=HM2
      HLM3=HM3
      HLM4=HM4
      GOTO307
 324  HLM1=HL1
      HLM2=HL2
      HLM3=HL3
      HLM4=HL4
      GOTO307
C.....2210 2201 1022 0122
 24   IF(NI-NJ)325,326,325
 325  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL1*HM1+HL0*HM2
      HLM3=HL1*HM2+HL0*HM3
      HLM4=HL1*HM3+HL0*HM4
      HLM5=HL1*HM4
      GOTO322
 326  HLM1=HL0*HM1+HL1*HM0
      HLM2=HL1*HM1+HL2*HM0
      HLM3=HL2*HM1+HL3*HM0
      HLM4=HL3*HM1+HL4*HM0
      HLM5=HL4*HM1
      GOTO322
C.....2220 2202 2022 0222 2211 1122
 27   HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      IF (NI+NJ-NK-NL) 328,1,329
 328  HLM3=HM1*HL2+HM2*HL1+HM3*HL0
      HLM4=  HM2*HL2 + HM3*HL1 + HM4*HL0
      HLM5=HM3*HL2+HM4*HL1
      HLM6=HM4*HL2
      GOTO330
 329  HLM3=HL1*HM2+HL2*HM1+HL3*HM0
      HLM4=HL2*HM2+HL3*HM1+HL4*HM0
      HLM5=HL3*HM2+HL4*HM1
      HLM6=HL4*HM2
  330 IF (RKT) 360,1350,360
  360 IF (ABXYZ+CDXYZ) 1352,1352,1353
 1352 RKT2=RKT*RKT
      RKT4=RKT2*RKT2
      RKT6=RKT2*RKT4
      C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=RKT2*HLM2+12.D0*HLM4
      C(4,KT)=-12.D0*RKT2*HLM4-120.D0*HLM6
      C(5,KT)=RKT4*HLM4+180.D0*RKT2*HLM6
      C(6,KT)=-30.D0*RKT4*HLM6
      C(7,KT)=RKT6*HLM6
      GOTO399
 1353 CONTINUE
      RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT4=RKT*RKT3
      RKT5=RKT*RKT4
      RKT6=RKT*RKT5
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*RKT*HLM3+12.D0*HLM4
      C(4,KT)=RKT3*HLM3-12.D0*RKT2*HLM4+60.D0*RKT*HLM5-120.D0*HLM6
      C(5,KT)=RKT4*HLM4-20.D0*RKT3*HLM5+180.D0*RKT2*HLM6
      C(6,KT)=RKT5*HLM5-30.D0*RKT4*HLM6
      C(7,KT)=RKT6*HLM6
      GO TO 399
C.....2121 2112 1221 1212
 28   HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL0*HM3+HL1*HM2+HL2*HM1+HL3*HM0
      HLM4=HL1*HM3+HL2*HM2+HL3*HM1
      HLM5=HL2*HM3+HL3*HM2
      HLM6=HL3*HM3
      GOTO330
C.....2221 2212 2122 1222
 36   HLM1=HL1*HM0+HL0*HM1
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL0*HM3+HL1*HM2+HL2*HM1+HL3*HM0
      IF(NI-NJ)331,332,331
 331  HLM4=HM1*HL3+HM2*HL2+HM3*HL1+HM4*HL0
      HLM5=HM2*HL3+HM3*HL2+HM4*HL1
      HLM6=HM3*HL3+HM4*HL2
      HLM7=HM4*HL3
      GOTO333
 332  HLM4=HL1*HM3+HL2*HM2+HL3*HM1+HL4*HM0
      HLM5=HL2*HM3+HL3*HM2+HL4*HM1
      HLM6=HL3*HM3+HL4*HM2
      HLM7=HL4*HM3
  333 IF (RKT) 1351,1350,1351
 1350 C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=12.D0*HLM4
      C(4,KT)=-120.D0*HLM6
      MSUM=4
      GO TO  399
 1351 IF (ABXYZ+CDXYZ) 366,366,367
 366  RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT5=RKT2*RKT3
      RKT7=RKT2*RKT5
      C(1,KT)=0.D0
      C(2,KT)=RKT*HLM1
      C(3,KT)=-6.D0*RKT*HLM3
      C(4,KT)=RKT3*HLM3+60.D0*RKT*HLM5
      C(5,KT)=-20.D0*RKT3*HLM5-840.D0*RKT*HLM7
      C(6,KT)=RKT5*HLM5+420.D0*RKT3*HLM7
      C(7,KT)=-42.D0*RKT5*HLM7
      C(8,KT)=RKT7*HLM7
      GOTO399
 367  CONTINUE
      RKT2=RKT*RKT
      RKT3=RKT*RKT2
      RKT4=RKT*RKT3
      RKT5=RKT*RKT4
      RKT6=RKT*RKT5
      RKT7=RKT*RKT6
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*RKT*HLM3+12.D0*HLM4
      C(4,KT)=RKT3*HLM3-12.D0*RKT2*HLM4+60.D0*RKT*HLM5-120.D0*HLM6
      C(5,KT)=RKT4*HLM4-20.D0*RKT3*HLM5+180.D0*RKT2*HLM6-840.D0*RKT*HLM7
      C(6,KT)=RKT5*HLM5-30.D0*RKT4*HLM6+420.D0*RKT3*HLM7
      C(7,KT)=RKT6*HLM6-42.D0*RKT5*HLM7
      C(8,KT)=RKT7*HLM7
      GOTO399
C.....2222
 44   HLM1=HL0*HM1+HL1*HM0
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      HLM3=HL0*HM3+HL1*HM2+HL2*HM1+HL3*HM0
      HLM4=HL0*HM4+HL1*HM3+HL2*HM2+HL3*HM1+HL4*HM0
      HLM5=HL1*HM4+HL2*HM3+HL3*HM2+HL4*HM1
      HLM6=HL2*HM4+HL3*HM3+HL4*HM2
      HLM7=HL3*HM4+HL4*HM3
      HLM8=HL4*HM4
      IF (RKT) 363,362,363
 362  C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=12.D0*HLM4
      C(5,KT)=1680.D0*HLM8
      MSUM=5
      C(4,KT)=-120.D0*HLM6
      GOTO399
 363  IF(ABXYZ+CDXYZ)364,364,365
 364  RKT2=RKT*RKT
      RKT4=RKT2*RKT2
      RKT6=RKT2*RKT4
      RKT8=RKT4*RKT4
      C(1,KT)=HL0*HM0
      C(2,KT)=-2.D0*HLM2
      C(3,KT)=RKT2*HLM2+12.D0*HLM4
      C(4,KT)=-12.D0*RKT2*HLM4-120.D0*HLM6
      C(5,KT)=RKT4*HLM4+180.D0*RKT2*HLM6+1680.D0*HLM8
      C(6,KT)= -30.D0*RKT4*HLM6 - 3360.D0*RKT2*HLM8
      C(7,KT)=RKT6*HLM6+840.D0*RKT4*HLM8
      C(8,KT)=-56.D0*RKT6*HLM8
      C(9,KT)=RKT8*HLM8
      GOTO399
 365  RKT2= RKT*RKT
      RKT3=RKT*RKT2
      RKT4=RKT*RKT3
      RKT5=RKT*RKT4
      RKT6=RKT*RKT5
      RKT7=RKT*RKT6
      RKT8=RKT*RKT7
      C(1,KT)=HL0*HM0
      C(2,KT)=RKT*HLM1-2.D0*HLM2
      C(3,KT)=RKT2*HLM2-6.D0*RKT*HLM3+12.D0*HLM4
      C(4,KT)=RKT3*HLM3-12.D0*RKT2*HLM4+60.D0*RKT*HLM5-120.D0*HLM6
      C(5,KT)=RKT4*HLM4-20.D0*RKT3*HLM5+180.D0*RKT2*HLM6-840.D0*RKT*HLM7
     X+1680.D0*HLM8
      C(6,KT)=RKT5*HLM5-30.D0*RKT4*HLM6+420.D0*RKT3*HLM7-3360.D0*RKT2*HL
     XM8
      C(7,KT)=RKT6*HLM6-42.D0*RKT5*HLM7+840.D0*RKT4*HLM8
      C(8,KT)=RKT7*HLM7-56.D0*RKT6*HLM8
      C(9,KT)=RKT8*HLM8
 399  CONTINUE
      MHI(KT)=MSUM
 346  CONTINUE
      MX=MHI(1)
      MY=MHI(2)
      MZ=MHI(3)
      MXYZ=MX+MY+MZ-2
      IF (PQSQ) 461,461,462
cmod
c461  F8=X17
c     F7=X15
c     F6=X13
c     F5=X11
c     F4=X9
c     F3=X7
c     F2=X5
c     F1=X3
c     F0=1.D0
c
 461  f_gam(9)=X17
      f_gam(8)=X15
      f_gam(7)=X13
      f_gam(6)=X11
      f_gam(5)=X9
      f_gam(4)=X7
      f_gam(3)=X5
      f_gam(2)=X3
      f_gam(1)=1.D0
cmod
      GO TO 463
  462 T=W*PQSQ
      IF (T-27.9D0) 4620,4621,4621
 4620 X=10.D0*(T+0.05D0)
      IT=X
      TI=IT
      IT=IT+1
      DELT=T-0.1D0*TI
      DELT2=0.5D0*DELT
      DELT3=-.33333333D0*DELT
C     CORRECTION HERE 8/70-WYH-THD GOT INFO FROM BASCH
C     DELT4=.25D0*DELT
      DELT4=-0.25D0*DELT
      TF0=STR0(IT)
      TF1=STR1(IT)
      TF2=STR2(IT)
      TF3=STR3(IT)
      TF4=STR4(IT)
      TF5=STR5(IT)
      TF6=STR6(IT)
      TF7=STR7(IT)
      TF8=STR8(IT)
      TF9=STR9(IT)
      TF10=STR10(IT)
      TF11=STR11(IT)
      TF12=STR12(IT)
      GO TO  (800,801,802,803,804,805,806,807,808),  MXYZ
cmod
c 808 F8=TF8+DELT*(-TF9+DELT2*(TF10+DELT3*(TF11+DELT4* TF12)))
c 807 F7=TF7+DELT*(-TF8+DELT2*(TF9+DELT3*(TF10+DELT4* TF11)))
c 806 F6=TF6+DELT*(-TF7+DELT2*(TF8+DELT3*(TF9+DELT4* TF10)))
c 805 F5=TF5+DELT*(-TF6+DELT2*(TF7+DELT3*(TF8+DELT4* TF9)))
c 804 F4=TF4+DELT*(-TF5+DELT2*(TF6+DELT3*(TF7+DELT4* TF8)))
c 803 F3=TF3+DELT*(-TF4+DELT2*(TF5+DELT3*(TF6+DELT4* TF7)))
c 802 F2=TF2+DELT*(-TF3+DELT2*(TF4+DELT3*(TF5+DELT4* TF6)))
c 801 F1=TF1+DELT*(-TF2+DELT2*(TF3+DELT3*(TF4+DELT4* TF5)))
c 800 F0=TF0+DELT*(-TF1+DELT2*(TF2+DELT3*(TF3+DELT4* TF4)))
c
  808 f_gam(9)=TF8+DELT*(-TF9+DELT2*(TF10+DELT3*(TF11+DELT4* TF12)))
  807 f_gam(8)=TF7+DELT*(-TF8+DELT2*(TF9+DELT3*(TF10+DELT4* TF11)))
  806 f_gam(7)=TF6+DELT*(-TF7+DELT2*(TF8+DELT3*(TF9+DELT4* TF10)))
  805 f_gam(6)=TF5+DELT*(-TF6+DELT2*(TF7+DELT3*(TF8+DELT4* TF9)))
  804 f_gam(5)=TF4+DELT*(-TF5+DELT2*(TF6+DELT3*(TF7+DELT4* TF8)))
  803 f_gam(4)=TF3+DELT*(-TF4+DELT2*(TF5+DELT3*(TF6+DELT4* TF7)))
  802 f_gam(3)=TF2+DELT*(-TF3+DELT2*(TF4+DELT3*(TF5+DELT4* TF6)))
  801 f_gam(2)=TF1+DELT*(-TF2+DELT2*(TF3+DELT3*(TF4+DELT4* TF5)))
  800 f_gam(1)=TF0+DELT*(-TF1+DELT2*(TF2+DELT3*(TF3+DELT4* TF4)))
cmod
      GO TO 463
 4621 XD=1.D0/T
cmod
c     F0=.88622692D0*DSQRT(XD)
c     F1=0.5D0*XD*F0
c     F2=1.5D0*XD*F1
c     F3=2.5D0*XD*F2
c     F4=3.5D0*XD*F3
c     IF (MXYZ.LT.6) GO TO 463
c     F5=4.5D0*XD*F4
c     F6=5.5D0*XD*F5
c     F7=6.5D0*XD*F6
c     F8=7.5D0*XD*F7
c
      f_gam(1)=.88622692D0*DSQRT(XD)
      f_gam(2)=0.5D0*XD*f_gam(1)
      f_gam(3)=1.5D0*XD*f_gam(2)
      f_gam(4)=2.5D0*XD*f_gam(3)
      f_gam(5)=3.5D0*XD*f_gam(4)
      IF (MXYZ.LT.6) GO TO 463
      f_gam(6)=4.5D0*XD*f_gam(5)
      f_gam(7)=5.5D0*XD*f_gam(6)
      f_gam(8)=6.5D0*XD*f_gam(7)
      f_gam(9)=7.5D0*XD*f_gam(8)
cmod
  463 CONTINUE
      ZZ(1)=1.D0
      ZZ(2)=Z
      IF (MXYZ-2) 380,380,382
  382 DO 381 LIFE=3,MXYZ
      NICE=LIFE-1
 381  ZZ(LIFE)=Z*ZZ(NICE)
  380 CONTINUE
      DO390NX=1,MX
      DO389NY=1,MY
      DO388NZ=1,MZ
      N=NX+NY+NZ-2
cmod
c388  RAWINT= RAWINT + C(NX,1)*C(NY,2)*C(NZ,3)*ZZ(N)*F(N)
 388  RAWINT= RAWINT + C(NX,1)*C(NY,2)*C(NZ,3)*ZZ(N)*f_gam(N)
cmod
 389  CONTINUE
 390  CONTINUE
      PRTINT=RAWINT
 540  CONTINUE
 355  VALINT(M)=VALINT(M)+WX*PRTINT
 351  CONTINUE
 352  CONTINUE
 353  CONTINUE
      RETURN
ccc   END
      end subroutine spdint
c----------------------------------------------------------------

c----------------------------------------------------------------
cccc  SUBROUTINE SPDFNT (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX)
      subroutine spdfnt (ETA,VALINT,S,NR,NTMX,NGMX,NINMAX,NSAVMX,
     .       ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,LS,
     .       IF,JF,KF,LF,M,I,J,K,L)
c***
      use param, only: PI, PITERM, PITERN, ACRCY, SCALE
c     COMMON /NMBRS /  PI, PITERM, PITERN, ACRCY, SCALE

      use param, only: X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c     COMMON/INC/X3,X5,X7,X9,X11,X13,X15,X17,X19,X21,X23,X25
c***
      IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION P(3),Q(3),R(3),PA(3),PB(3),QC(3),QD(3),F(13),C(13,3),
     1MHI(3),ZZ(13),E(7,3)
      DIMENSION ETA(NGMX,5),S(NSAVMX),VALINT(NINMAX),NR(NTMX,3)
cccc  COMMON/SPECS/ICNT,JCNT,KCNT,LCNT,ITYP,JTYP,KTYP,LTYP,IS,JS,KS,
cccc 1LS,IF,JF,KF,LF,M,I,J,K,L
cccc  COMMON/GAMMA/F0,F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12
c     EQUIVALENCE (F(1),F0)
      FAB=1.D0
      FCD=1.D0
      ABXYZ=ICNT-JCNT
      CDXYZ=KCNT-LCNT
      ABXYZ=DABS(ABXYZ)
      CDXYZ=DABS(CDXYZ)
      DO 353 II=IS,IF
      A=ETA(II,4)
      IF (I-J) 680,681,680
  681 JF=II
      FAB=2.D0
  680 DO 352 JJ=JS,JF
      B=ETA(JJ,4)
      T1=1.D0/(A+B)
      GAB=0.25D0*T1
      INDEX =  MAX0(II,JJ)*(MAX0(II,JJ) - 1)/2 + MIN0(II,JJ)
      SABOO=S(INDEX)
      IF (ABXYZ) 704,708,704
  704 CONTINUE
      P(1)=(A*ETA(II,1)+B*ETA(JJ,1))*T1
      P(2)=(A*ETA(II,2)+B*ETA(JJ,2))*T1
      P(3)=(A*ETA(II,3)+B*ETA(JJ,3))*T1
      GO TO 709
  708 P(1)=ETA(II,1)
      P(2)=ETA(II,2)
      P(3)=ETA(II,3)
  709 CONTINUE
      PA(1)=P(1)-ETA(II,1)
      PA(2)=P(2)-ETA(II,2)
      PA(3)=P(3)-ETA(II,3)
      PB(1)=P(1)-ETA(JJ,1)
      PB(2)=P(2)-ETA(JJ,2)
      PB(3)=P(3)-ETA(JJ,3)
      DO 295 KT=1,3
      NI=NR(ITYP,KT)+1
      NJ=NR(JTYP,KT)+1
      PAKT=PA(KT)
      PBKT=PB(KT)
C     CORRECTION HERE 8/70-WYH-THD GOT INFO FROM BASCH
      HL0=0.D0
      HL1=0.D0
      HL2=0.D0
      HL3=0.D0
      HL4=0.D0
      HL5=0.D0
      HL6=0.D0
      GO TO (100,101,102,113),NI
  100 GO TO (103,104,105,116), NJ
  101 GO TO (106,107,108,119),NJ
  102 GO TO (109,110,111,122),NJ
  113 GO TO (123,124,125,126),NJ
C.....00
  103 HL0=1.D0
      GO TO 199
C.....10
  106 HL0=PAKT
      HL1=GAB
      GO TO 199
C.....11
  107 HL2=GAB*GAB
      IF(ABXYZ)150,151,150
 151  HL0=2.D0*GAB
      HL1=0.D0
      GOTO199
  150 HL0=PAKT*PBKT+2.D0*GAB
      HL1=GAB*(PAKT+PBKT)
      GO TO 199
C.....20
  109 HL2=GAB*GAB
      IF(ABXYZ)152,153,152
 153  HL0=2.D0*GAB
      GOTO199
  152 HL0=PAKT*PAKT+2.D0*GAB
      HL1=2.D0*GAB*PAKT
      GO TO 199
C.....21
  110 GG=GAB*GAB
      HL3=GAB*GG
      IF (ABXYZ) 154,156,154
  156 HL1=6.D0*GG
      GOTO199
  154 HL0=PAKT*PAKT*PBKT+2.D0*GAB*(2.D0*PAKT+PBKT)
      HL1=GAB*PAKT*(2.D0*PBKT+PAKT)+6.D0*GG
      HL2=GG*(2.D0*PAKT+PBKT)
      GO TO 199
C.....22
  111 GG=GAB*GAB
      HL4=GG*GG
      IF (ABXYZ) 157,159,157
  159 HL2=12.D0*GAB*GG
      HL0=12.D0*GG
      GOTO199
 157  AB=PAKT*PBKT
      APB=(PAKT+PBKT)*(PAKT+PBKT) + 2.D0*AB
      HL0=AB*AB+2.D0*GAB*APB+12.D0*GG
      HL1=(PAKT+PBKT)*(2.D0*GAB*AB+12.D0*GG)
      HL2=GG*(APB+12.D0*GAB)
      HL3=2.D0*GG*GAB*(PAKT+PBKT)
      GO TO 199
C.....30
  123 GG=GAB*GAB
      HL3=GAB*GG
      IF (ABXYZ) 840,156,840
  840 PAKT2=PAKT*PAKT
      HL2=3.D0*GG*PAKT
      HL1=3.D0*GAB*(PAKT2+2.D0*GAB)
      HL0=PAKT*(PAKT2+6.D0*GAB)
      GO TO 199
C.....31
  124 GG=GAB*GAB
      HL4=  GG*GG
      IF (ABXYZ) 842,159,842
  842 PAKT2=PAKT*PAKT
      PAB=PAKT*PBKT
      HL3=GAB*GG*(3.D0*PAKT+PBKT)
      HL2=3.D0*GG*(4.D0*GAB+PAKT*(PAKT+PBKT))
      HL1=GAB*(PAKT2*(PAKT+3.D0*PBKT)+6.D0*GAB*(3.D0*PAKT+PBKT))
      HL0=PAB*PAKT2+6.D0*GAB*(PAKT2+PAB)+12.D0*GG
      GO TO 199
C.....32
  125 GG=GAB*GAB
      GG2=GG*GG
      HL5=GAB*GG2
      IF (ABXYZ) 843,844,843
  844 HL3=20.D0*GG2
      HL1=60.D0*GAB*GG
      GO TO 199
  843 PAKT2=PAKT*PAKT
      PBKT2=PBKT*PBKT
      PABKT=PAKT*PBKT
      HL4=GG2*(3.D0*PAKT+2.D0*PBKT)
      HL3=GAB*GG*(3.D0*PAKT2+6.D0*PABKT+PBKT2)+20.D0*GG2
      HL2=GG*(PAKT*(PAKT2+6.D0*PABKT+3.D0*PBKT2)+GAB*( 36.D0*PAKT+24.D0*
     XPBKT))
      HL1=GAB*(PABKT*(2.D0*PAKT2+3.D0*PABKT)+GAB*((18.D0*PAKT2+36.D0*PAB
     XKT+     6.D0*PBKT2)+60.D0*GAB))
      HL0=PAKT*(PABKT*PABKT+GAB*(2.D0*PAKT2+12.D0*PABKT+6.D0*PBKT2))+
     X      GG*( 36.D0*PAKT+24.D0*PBKT)
      GO TO 199
C.....33
  126 GG=GAB*GAB
      GG2=GG*GG
      HL6=GG*GG2
      IF (ABXYZ) 845,846,845
  846 HL4=30.D0*GAB*GG2
      HL2=180.D0*GG2
      HL0=120.D0*GAB*GG
      GO TO 199
  845 PAKT2=PAKT*PAKT
      PBKT2=PBKT*PBKT
      PABKT=PAKT*PBKT
      PAB=3.D0*(PAKT+PBKT)
      PKT=PAKT2+3.D0*PABKT+PBKT2
      BIG=PAKT2*(PAKT+9.D0*PBKT)+PBKT2*(PBKT+9.D0*PAKT)
      HL5=GAB*GG2*PAB
      HL4=GG2*(3.D0*PKT+30.D0*GAB)
      HL3=GAB*GG*(BIG+GAB*20.D0*PAB)
      HL2=GG*(3.D0*PABKT*PKT+GAB*(36.D0*PKT+GAB*180.D0))
      HL1=GAB*(PAB*PABKT*PABKT+GAB*(6.D0*BIG+60.D0*GAB*PAB))
      HL0=PABKT*PABKT*PABKT+GAB*(6.D0*PABKT*PKT+GAB*(36.D0*PKT+120.D0*GA
     XB))
      GO TO 199
C.....01
  104 HL0=PBKT
      HL1=GAB
      GO TO 199
C.....02
  105 HL2=GAB*GAB
      IF (ABXYZ) 160,153,160
  160 HL0=PBKT*PBKT+2.D0*GAB
      HL1=PBKT*2.D0*GAB
      GO TO 199
C......03
  116 TEMP=PAKT
      PAKT=PBKT
      PBKT=TEMP
      GO TO 123
C.....12
  108 GG=GAB*GAB
      HL3=GAB*GG
      IF (ABXYZ) 162,156,162
  162 HL0=PBKT*PBKT*PAKT+2.D0*GAB*(2.D0*PBKT+PAKT)
      HL1=GAB*PBKT*(2.D0*PAKT+PBKT)+6.D0*GG
      HL2=GG*(2.D0*PBKT+PAKT)
      GO TO 199
C......13
  119 TEMP=PAKT
      PAKT=PBKT
      PBKT=TEMP
      GO TO 124
C......23
  122 TEMP=PAKT
      PAKT=PBKT
      PBKT=TEMP
      GO TO 125
  199 CONTINUE
      E(1,KT)=HL0
      E(2,KT)=HL1
      E(3,KT)=HL2
      E(4,KT)=HL3
      E(5,KT)=HL4
      E(6,KT)=HL5
      E(7,KT)=HL6
  295 CONTINUE
      IF(II-JJ) 431,432,431
  432 FAB=1.D0
  431 DO 351 KK=KS,KF
      CX=ETA(KK,4)
      IF (K-L) 683,682,683
  682 LF=KK
      FCD=2.D0
 683  DO355LL=LS,LF
      IF (KK-LL) 436,435,436
  435 FCD=1.D0
  436 CONTINUE
      D=ETA(LL,4)
      T2=1.D0/(CX+D)
      GCD=0.25D0*T2
      Z=1.D0/(GAB+GCD)
      INDEX =  MAX0(KK,LL)*(MAX0(KK,LL) - 1)/2 + MIN0(KK,LL)
      SCDOO=S(INDEX)
      W=0.25D0*Z
      WX=PITERM*DSQRT(W)*SABOO*SCDOO*FAB*FCD
      TEST=2.D0*WX
      PRTINT=0.D0
      IF (DABS(TEST)-ACRCY) 540,750,750
  750 IF (CDXYZ) 705,706,705
  705 CONTINUE
      Q(1)=(CX*ETA(KK,1)+D*ETA(LL,1))*T2
      Q(2)=(CX*ETA(KK,2)+D*ETA(LL,2))*T2
      Q(3)=(CX*ETA(KK,3)+D*ETA(LL,3))*T2
      GO TO 707
  706 Q(1)=ETA(KK,1)
      Q(2)=ETA(KK,2)
      Q(3)=ETA(KK,3)
  707 R(1)=P(1)-Q(1)
      R(2)=P(2)-Q(2)
      R(3)=P(3)-Q(3)
      PQSQ=R(1)*R(1)+R(2)*R(2)+R(3)*R(3)
      QC(1)=Q(1)-ETA(KK,1)
      QC(2)=Q(2)-ETA(KK,2)
      QC(3)=Q(3)-ETA(KK,3)
      QD(1)=Q(1)-ETA(LL,1)
      QD(2)=Q(2)-ETA(LL,2)
      QD(3)=Q(3)-ETA(LL,3)
      IF (PQSQ-1.0D-16) 461,461,462
  461 CONTINUE
cmod
c     F12=X25
c     F11=X23
c     F10=X21
c     F9=X19
c     F8=X17
c     F7=X15
c     F6=X13
c     F5=X11
c     F4=X9
c     F3=X7
c     F2=X5
c     F1=X3
c     F0=1.D0
c
      f_gam(13)=X25
      f_gam(12)=X23
      f_gam(11)=X21
      f_gam(10)=X19
      f_gam(9)=X17
      f_gam(8)=X15
      f_gam(7)=X13
      f_gam(6)=X11
      f_gam(5)=X9
      f_gam(4)=X7
      f_gam(3)=X5
      f_gam(2)=X3
      f_gam(1)=1.D0
cmod
      GO TO 463
  462 T=W*PQSQ
      Y=DEXP(-T)
cmod
c     F12=FMCH(12,T,Y)
c     T=2.D0*T
c     F11=(T*F12+Y)*X23
c     F10=(T*F11+Y)*X21
c     F9=(T*F10+Y)*X19
c     F8=(T*F9+Y)*X17
c     F7=(T*F8+Y)*X15
c     F6=(T*F7+Y)*X13
c     F5=(T*F6+Y)*X11
c     F4=(T*F5+Y)*X9
c     F3=(T*F4+Y)*X7
c     F2=(T*F3+Y)*X5
c     F1=(T*F2+Y)*X3
c     F0=(T*F1+Y)
c
      f12_gam=FMCH(12,T,Y)
      T=2.D0*T
      f_gam(12)=(T*f_gam(13)+Y)*X23
      f_gam(11)=(T*f_gam(12)+Y)*X21
      f_gam(10)=(T*f_gam(11)+Y)*X19
      f_gam(9)=(T*f_gam(10)+Y)*X17
      f_gam(8)=(T*f_gam(9)+Y)*X15
      f_gam(7)=(T*f_gam(8)+Y)*X13
      f_gam(6)=(T*f_gam(7)+Y)*X11
      f_gam(5)=(T*f_gam(6)+Y)*X9
      f_gam(4)=(T*f_gam(5)+Y)*X7
      f_gam(3)=(T*f_gam(4)+Y)*X5
      f_gam(2)=(T*f_gam(3)+Y)*X3
      f_gam(1)=(T*f_gam(2)+Y)
cmod
  463 CONTINUE
      RAWINT=0.D0
      DO 346 KT=1,3
      NI=NR(ITYP,KT)
      NJ=NR(JTYP,KT)
      NK=NR(KTYP,KT)
      NL=NR(LTYP,KT)
      MSUM=NI+NJ+NK+NL+1
      IF (MSUM-1) 2,2,610
    2 C(1,KT)=1.D0
      GO TO 999
  610 QCKT=QC(KT)
      QDKT=QD(KT)
      RKT=-R(KT)
      HL0=E(1,KT)
      HL1=E(2,KT)
      HL2=E(3,KT)
      HL3=E(4,KT)
      HL4=E(5,KT)
      HL5=E(6,KT)
      HL6=E(7,KT)
      NK=NK+1
      NL=NL+1
C     CORRECTION HERE 8/70-WYH-THD GOT INFO FROM BASCH
      HM0=0.D0
      HM1=0.D0
      HM2=0.D0
      HM3=0.D0
      HM4=0.D0
      HM5=0.D0
      HM6=0.D0
      GO TO (200,201,202,213),NK
  200 GO TO (203,204,205,216),NL
  201 GO TO (206,207,208,219),NL
  202 GO TO (209,210,211,222),NL
  213 GO TO (223,224,225,226),NL
C.....00
  203 HM0=1.D0
      GOTO299
C.....10
  206 HM0=QCKT
      HM1=-GCD
      GOTO299
C.....11
  207 HM2=GCD*GCD
      IF(CDXYZ)250,251,250
 251  HM0=2.D0*GCD
      GOTO299
  250 HM0=QCKT*QDKT+2.D0*GCD
      HM1=-GCD*(QCKT+QDKT)
      GOTO299
C.....20
  209 HM2=GCD*GCD
      IF(CDXYZ)252,253,252
 253  HM0=2.D0*GCD
      GOTO299
  252 HM0=QCKT*QCKT+2.D0*GCD
      HM1=-2.D0*GCD*QCKT
      GOTO299
C.....21
  210 GG=GCD*GCD
      HM3=-GCD*GG
      IF(CDXYZ)254,256,254
  256 HM1=-6.D0*GG
      GOTO299
  254 HM0=QCKT*QCKT*QDKT+2.D0*GCD*(2.D0*QCKT+QDKT)
      HM1=-(GCD*QCKT*(2.D0*QDKT+QCKT)+6.D0*GG)
      HM2=GG*(2.D0*QCKT+QDKT)
      GOTO299
C.....22
  211 GG=GCD*GCD
      HM4=GG*GG
      IF(CDXYZ)257,259,257
  259 HM2=12.D0*GCD*GG
      HM0=12.D0*GG
      GOTO299
  257 CD=QCKT*QDKT
      CPD=(QCKT+QDKT)*(QCKT+QDKT)+2.D0*CD
      HM0=CD*CD+2.D0*GCD*CPD+12.D0*GG
      HM1=-(QCKT+QDKT)*(2.D0*GCD*CD+12.D0*GG)
      HM2=GG*(CPD+12.D0*GCD)
      HM3=-2.D0*GG*GCD*(QCKT+QDKT)
      GOTO299
C......30
  223 GG=GCD*GCD
      HM3=-GCD*GG
      IF (CDXYZ) 280,256,280
  280 QCKT2=QCKT*QCKT
      HM2=3.D0*GG*QCKT
      HM1=-3.D0*GCD*(QCKT2+2.D0*GCD)
      HM0=QCKT*(QCKT2+6.D0*GCD)
      GO TO 299
C......31
  224 GG=GCD*GCD
      HM4=GG*GG
      IF (CDXYZ) 282,259,282
  282 QCKT2=QCKT*QCKT
      QCD=QCKT*QDKT
      HM3=-GCD*GG*(3.D0*QCKT+QDKT)
      HM2=3.D0*GG*(4.D0*GCD+QCKT*(QCKT+QDKT))
      HM1=-(GCD*(QCKT2*(QCKT+3.D0*QDKT)+6.D0*GCD*(3.D0*QCKT+QDKT)))
      HM0=QCD* QCKT2+6.D0*GCD*(QCKT2+QCD)+12.D0*GG
      GO TO 299
C......32
  225 GG=GCD*GCD
      GG2=GG*GG
      HM5=-GCD*GG2
      IF (CDXYZ) 283,284,283
  284 HM3=-20.D0*GG2
      HM1=-60.D0*GCD*GG
      GO TO 299
  283 QCKT2=QCKT*QCKT
      QDKT2=QDKT*QDKT
      QCDKT=QCKT*QDKT
      HM4=GG2*(3.D0*QCKT+2.D0*QDKT)
      HM3=-(GCD*GG*(3.D0*QCKT2+6.D0*QCDKT+QDKT2)+20.D0*GG2)
      HM2=GG*(QCKT*(QCKT2+6.D0*QCDKT+3.D0*QDKT2)+GCD*( 36.D0*QCKT+24.D0*
     XQDKT))
      HM1=-(GCD*(QCDKT*(2.D0*QCKT2+3.D0*QCDKT)+GCD*((18.D0*QCKT2+36.D0*Q
     XCDKT    +6.D0*QDKT2)+60.D0*GCD)))
      HM0=QCKT*(QCDKT*QCDKT+GCD*(2.D0*QCKT2+12.D0*QCDKT+6.D0*QDKT2))
     X      +GG*( 36.D0*QCKT+24.D0*QDKT)
      GO TO 299
C......33
  226 GG=GCD*GCD
      GG2=GG*GG
      HM6=GG*GG2
      IF (CDXYZ) 285,286,285
  286 HM4=30.D0*GCD*GG2
      HM2=180.D0*GG2
      HM0=120.D0*GCD*GG
      GO TO 299
  285 QCKT2=QCKT*QCKT
      QDKT2=QDKT*QDKT
      QCDKT=QCKT*QDKT
      CDQ=3.D0*(QCKT+QDKT)
      QKT=QCKT2+3.D0*QCDKT+QDKT2
      BIG=QCKT2*(QCKT+9.D0*QDKT)+QDKT2*(QDKT+9.D0*QCKT)
      HM5=-GCD*GG2*CDQ
      HM4=GG2*(3.D0*QKT+30.D0*GCD)
      HM3=-(GCD*GG*(BIG+GCD*20.D0*CDQ))
      HM2=GG*(3.D0*QCDKT*QKT+GCD*(36.D0*QKT+GCD*180.D0))
      HM1=-(GCD*(CDQ*QCDKT*QCDKT+GCD*(6.D0*BIG+60.D0*GCD*CDQ)))
      HM0=QCDKT*QCDKT*QCDKT+GCD*(6.D0*QCDKT*QKT+GCD*(36.D0*QKT+120.D0*GC
     XD))
      GO TO 299
C.....01
  204 HM0=QDKT
      HM1=-GCD
      GOTO299
C.....02
  205 HM2=GCD*GCD
      IF (CDXYZ) 260,253,260
  260 HM0=QDKT*QDKT+2.D0*GCD
      HM1=-2.D0*GCD*QDKT
      GOTO299
C......03
  216 TEMP=QCKT
      QCKT=QDKT
      QDKT=TEMP
      GO TO 223
C.....12
  208 GG=GCD*GCD
      HM3=-GCD*GG
      IF (CDXYZ) 262,256,262
  262 HM0=QDKT*QDKT*QCKT+2.D0*GCD*(2.D0*QDKT+QCKT)
      HM1=-(GCD*QDKT*(2.D0*QCKT+QDKT)+6.D0*GG)
      HM2=GG*(2.D0*QDKT+QCKT)
      GO TO 299
C......13
  219 TEMP=QCKT
      QCKT=QDKT
      QDKT=TEMP
      GO TO 224
C......23
  222 TEMP=QCKT
      QCKT=QDKT
      QDKT=TEMP
      GO TO 225
  299 CONTINUE
      HLM0=HL0*HM0
      C(1,KT)=HLM0
      HLM1=HL0*HM1+HL1*HM0
      C(2,KT)=RKT*HLM1
      IF (MSUM-2) 999,999,802
  802 CONTINUE
      HLM2=HL0*HM2+HL1*HM1+HL2*HM0
      C(2,KT)=C(2,KT)-2.D0*HLM2
      RKT2=RKT*RKT
      C(3,KT)=RKT2*HLM2
      IF (MSUM-3) 999,999,803
  803 CONTINUE
      HLM3=HL0*HM3+HL1*HM2+HL2*HM1+HL3*HM0
      C(3,KT)=C(3,KT)-6.D0*RKT*HLM3
      RKT3=RKT*RKT2
      C(4,KT)=RKT3*HLM3
      IF (MSUM-4) 999,999,804
  804 CONTINUE
      HLM4=HL0*HM4+HL1*HM3+HL2*HM2+HL3*HM1+HL4*HM0
      C(3,KT)=C(3,KT)+12.D0*HLM4
      C(4,KT)=C(4,KT)-12.D0*RKT2*HLM4
      RKT4=RKT*RKT3
      C(5,KT)=RKT4*HLM4
      IF (MSUM-5) 999,999,805
  805 CONTINUE
      HLM5=HL5*HM0+HL4*HM1+HL3*HM2+HL2*HM3+HL1*HM4+HL0*HM5
      C(4,KT)=C(4,KT)+60.D0*RKT*HLM5
      C(5,KT)=C(5,KT)-20.D0*RKT3*HLM5
      RKT5=RKT*RKT4
      C(6,KT)=RKT5*HLM5
      IF (MSUM-6) 999,999,806
  806 CONTINUE
      HLM6=HL6*HM0+HL5*HM1+HL4*HM2+HL3*HM3+HL2*HM4+HL1*HM5+HL0*HM6
      C(4,KT)=C(4,KT)-120.D0*HLM6
      C(5,KT)=C(5,KT)+180.D0*RKT2*HLM6
      C(6,KT)=C(6,KT)-30.D0*RKT4*HLM6
      RKT6=RKT*RKT5
      C(7,KT)=RKT6*HLM6
      IF (MSUM-7) 999,999,807
  807 CONTINUE
      HLM7=HL1*HM6+HL2*HM5+HL3*HM4+HL4*HM3+HL5*HM2+HL6*HM1
      C(5,KT)=C(5,KT)-840.D0*RKT*HLM7
      C(6,KT)=C(6,KT)+420.D0*RKT3*HLM7
      C(7,KT)=C(7,KT)-42.D0*RKT5*HLM7
      RKT7=RKT*RKT6
      C(8,KT)=RKT7*HLM7
      IF (MSUM-8) 999,999,808
  808 CONTINUE
      HLM8=HL2*HM6+HL3*HM5+HL4*HM4+HL5*HM3+HL6*HM2
      C(5,KT)=C(5,KT)+1680.D0*HLM8
      C(6,KT)=C(6,KT)-3360.D0*RKT2*HLM8
      C(7,KT)=C(7,KT)+840.D0*RKT4*HLM8
      C(8,KT)=C(8,KT)-56.D0*RKT6*HLM8
      RKT8=RKT*RKT7
      C(9,KT)=RKT8*HLM8
      IF (MSUM-9) 999,999,809
  809 CONTINUE
      HLM9=HL3*HM6+HL4*HM5+HL5*HM4+HL6*HM3
      C(6,KT)=C(6,KT)+15120.D0*RKT*HLM9
      C(7,KT)=C(7,KT)-10080.D0*RKT3*HLM9
      C(8,KT)=C(8,KT)+1512.D0*RKT5*HLM9
      C(9,KT)=C(9,KT)-72.D0*RKT7*HLM9
      RKT9=RKT*RKT8
      C(10,KT)=RKT9*HLM9
      IF (MSUM-10) 999,999,810
  810 CONTINUE
      HLM10=HL4*HM6+HL5*HM5+HL6*HM4
      C(6,KT)=C(6,KT)-30240.D0*HLM10
      C(7,KT)=C(7,KT)+75600.D0*RKT2*HLM10
      C(8,KT)=C(8,KT)-25200.D0*RKT4*HLM10
      C(9,KT)=C(9,KT)+2520.D0*RKT6*HLM10
      C(10,KT)=C(10,KT)-90.D0*RKT8*HLM10
      RKT10=RKT*RKT9
      C(11,KT)=RKT10*HLM10
      IF (MSUM-11) 999,999,811
  811 CONTINUE
      HLM11=HL5*HM6+HL6*HM5
      C(7,KT)=C(7,KT)-332640.D0*RKT*HLM11
      C(8,KT)=C(8,KT)+277200.D0*RKT3*HLM11
      C(9,KT)=C(9,KT)-55440.D0*RKT5*HLM11
      C(10,KT)=C(10,KT)+3960.D0*RKT7*HLM11
      C(11,KT)=C(11,KT)-110.D0*RKT9*HLM11
      RKT11=RKT*RKT10
      C(12,KT)=RKT11*HLM11
      IF (MSUM-12) 999,999,812
  812 CONTINUE
      HLM12=HL6*HM6
      C(7,KT)=C(7,KT)+665280.D0*HLM12
      C(8,KT)=C(8,KT)-1995840.D0*RKT2*HLM12
      C(9,KT)=C(9,KT)+831600.D0*RKT4*HLM12
      C(10,KT)=C(10,KT)-110880.D0*RKT6*HLM12
      C(11,KT)=C(11,KT)+5940.D0*RKT8*HLM12
      C(12,KT)=C(12,KT)-132.D0*RKT10*HLM12
      RKT12=RKT*RKT11
      C(13,KT)=RKT12*HLM12
  999 CONTINUE
      MHI(KT)=MSUM
 346  CONTINUE
      MX=MHI(1)
      MY=MHI(2)
      MZ=MHI(3)
      MXYZ=MX+MY+MZ-2
      ZZ(1)=1.D0
      ZZ(2)=Z
      IF (MXYZ-2) 380,380,382
  382 DO 381 LIFE=3,MXYZ
      NICE=LIFE-1
 381  ZZ(LIFE)=Z*ZZ(NICE)
  380 CONTINUE
      DO390NX=1,MX
      DO389NY=1,MY
      DO388NZ=1,MZ
      N=NX+NY+NZ-2
cmod
c388  RAWINT=RAWINT+C(NX,1)*C(NY,2)*C(NZ,3)*ZZ(N)*F(N)
 388  RAWINT=RAWINT+C(NX,1)*C(NY,2)*C(NZ,3)*ZZ(N)*f_gam(N)
cmod
 389  CONTINUE
 390  CONTINUE
      PRTINT=RAWINT
 540  CONTINUE
 355  VALINT(M)=VALINT(M)+WX*PRTINT
 351  CONTINUE
 352  CONTINUE
 353  CONTINUE
      RETURN
ccc   END
      end subroutine spdfnt
c----------------------------------------------------------------

      end module ampoly
